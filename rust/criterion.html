<!DOCTYPE HTML>
<html lang="zh" class="rust sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Criterion - Jason Notes</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "rust";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>â†</kbd> or <kbd>â†’</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Jason Notes</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/shihyu/jason_note" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="å¦‚ä½•æ¨™æº–rustç¨‹å¼ç¢¼èˆ‡criterion"><a class="header" href="#å¦‚ä½•æ¨™æº–rustç¨‹å¼ç¢¼èˆ‡criterion">å¦‚ä½•æ¨™æº–Rustç¨‹å¼ç¢¼èˆ‡Criterion</a></h1>
<h2 id="ä»€éº¼æ˜¯åŸºæº–æ¸¬è©¦"><a class="header" href="#ä»€éº¼æ˜¯åŸºæº–æ¸¬è©¦">ä»€éº¼æ˜¯åŸºæº–æ¸¬è©¦ï¼Ÿ</a></h2>
<p>åŸºæº–æ¸¬è©¦æ˜¯æ¸¬è©¦æ‚¨çš„ç¨‹å¼ç¢¼æ€§èƒ½çš„åšæ³•ï¼Œä»¥æŸ¥çœ‹å®ƒèƒ½åšå¤šå¿«ï¼ˆå»¶é²ï¼‰æˆ–å¤šå°‘ï¼ˆååé‡ï¼‰å·¥ä½œã€‚ é€™åœ¨è»Ÿé«”é–‹ç™¼ä¸­å¸¸è¢«å¿½è¦–çš„æ­¥é©Ÿæ˜¯å»ºç«‹å’Œç¶­è­·å¿«é€Ÿå’Œé«˜æ€§èƒ½ç¨‹å¼ç¢¼çš„é—œéµã€‚ åŸºæº–æ¸¬è©¦ç‚ºé–‹ç™¼äººå“¡æä¾›äº†å¿…è¦çš„æŒ‡æ¨™ï¼Œç”¨æ–¼ç†è§£ä»–å€‘çš„ç¨‹å¼ç¢¼åœ¨å„ç¨®å·¥ä½œè² è¼‰å’Œæ¢ä»¶ä¸‹çš„è¡¨ç¾å¦‚ä½•ã€‚ å‡ºæ–¼é˜²æ­¢åŠŸèƒ½å›æ­¸çš„åŒæ¨£åŸå› ï¼Œä½ æ‡‰è©²ç·¨å¯«æ¸¬è©¦ä»¥é˜²æ­¢æ€§èƒ½å›æ­¸ã€‚ æ€§èƒ½å•é¡Œä¹Ÿæ˜¯å•é¡Œï¼</p>
<h2 id="ç”¨-rust-ç·¨å¯«-fizzbuzz"><a class="header" href="#ç”¨-rust-ç·¨å¯«-fizzbuzz">ç”¨ Rust ç·¨å¯« FizzBuzz</a></h2>
<p>ç‚ºäº†ç·¨å¯«åŸºæº–æ¸¬è©¦ï¼Œæˆ‘å€‘éœ€è¦ä¸€äº›åŸå§‹ç¢¼ä¾†é€²è¡ŒåŸºæº–æ¸¬è©¦ã€‚ é¦–å…ˆï¼Œæˆ‘å€‘å°‡ç·¨å¯«ä¸€å€‹éå¸¸ç°¡å–®çš„ç¨‹åºï¼Œ <a href="https://en.wikipedia.org/wiki/Fizz_buzz#Programming">FizzBuzz</a>ã€‚</p>
<p>FizzBuzzçš„è¦å‰‡å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>å¯«ä¸€å€‹ç¨‹åºï¼Œåˆ—å°å¾ <code>1</code> åˆ° <code>100</code> çš„æ•´æ•¸ï¼ˆåŒ…å«ï¼‰ï¼š</p>
<ul>
<li>å°æ–¼ä¸‰çš„å€æ•¸ï¼Œåˆ—å° <code>Fizz</code></li>
<li>å°æ–¼äº”çš„å€æ•¸ï¼Œåˆ—å° <code>Buzz</code></li>
<li>å°æ–¼æ—¢æ˜¯ä¸‰çš„å€æ•¸åˆæ˜¯äº”çš„å€æ•¸çš„æ•¸ï¼Œåˆ—å° <code>FizzBuzz</code></li>
<li>å°æ–¼æ‰€æœ‰å…¶ä»–æ•¸ï¼Œåˆ—å°é€™å€‹æ•¸å­—</li>
</ul>
</blockquote>
<p>æœ‰<a href="https://rosettacode.org/wiki/FizzBuzz">è¨±å¤šç¨®ç·¨å¯«FizzBuzzçš„æ–¹æ³•</a>ã€‚ æ‰€ä»¥æˆ‘å€‘æœƒé¸æ“‡æˆ‘æœ€å–œæ­¡çš„ä¸€ç¨®ï¼š</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    for i in 1..=100 {
        match (i % 3, i % 5) {
            (0, 0) =&gt; println!("FizzBuzz"),
            (0, _) =&gt; println!("Fizz"),
            (_, 0) =&gt; println!("Buzz"),
            (_, _) =&gt; println!("{i}"),
        }
    }
}</code></pre></pre>
<ul>
<li>å»ºç«‹ä¸€å€‹ <code>main</code> å‡½æ•¸</li>
<li>å¾ <code>1</code> è¿­ä»£åˆ° <code>100</code>ï¼ˆå«ï¼‰ã€‚</li>
<li>å°æ–¼æ¯å€‹æ•¸å­—ï¼Œåˆ†åˆ¥è¨ˆç®— <code>3</code> å’Œ <code>5</code> çš„å–é¤˜ï¼ˆé™¤å¾Œé¤˜æ•¸ï¼‰ã€‚</li>
<li>å°å…©å€‹é¤˜æ•¸é€²è¡Œæ¨¡å¼åŒ¹é…ã€‚ å¦‚æœé¤˜æ•¸ç‚º <code>0</code>ï¼Œé‚£éº¼é€™å€‹æ•¸å°±æ˜¯çµ¦å®šå› ç´ çš„å€æ•¸ã€‚</li>
<li>å¦‚æœ <code>3</code> å’Œ <code>5</code> çš„é¤˜æ•¸éƒ½ç‚º <code>0</code>ï¼Œå‰‡åˆ—å° <code>FizzBuzz</code>ã€‚</li>
<li>å¦‚æœåªæœ‰ <code>3</code> çš„é¤˜æ•¸ç‚º <code>0</code>ï¼Œå‰‡åˆ—å° <code>Fizz</code>ã€‚</li>
<li>å¦‚æœåªæœ‰ <code>5</code> çš„é¤˜æ•¸ç‚º <code>0</code>ï¼Œå‰‡åˆ—å° <code>Buzz</code>ã€‚</li>
<li>å¦å‰‡ï¼Œå°±åˆ—å°é€™å€‹æ•¸å­—ã€‚</li>
</ul>
<h3 id="æŒ‰æ­¥é©Ÿæ“ä½œ"><a class="header" href="#æŒ‰æ­¥é©Ÿæ“ä½œ">æŒ‰æ­¥é©Ÿæ“ä½œ</a></h3>
<p>ç‚ºäº†èˆ‡æœ¬æ•™å­¸é€²è¡ŒåŒæ­¥å­¸ç¿’ï¼Œæ‚¨éœ€è¦ <a href="https://rustup.rs/">å®‰è£ Rust</a>ã€‚</p>
<blockquote>
<p>ğŸ° é€™ç¯‡æ–‡ç« çš„åŸå§‹ç¢¼åœ¨ <a href="https://github.com/bencherdev/bencher/tree/main/examples/rust/bench">GitHub ä¸Šå¯ä»¥æ‰¾åˆ°</a></p>
</blockquote>
<p>å®‰è£å¥½ Rust å¾Œï¼Œæ‚¨å¯ä»¥æ‰“é–‹ä¸€å€‹çµ‚ç«¯çª—å£ï¼Œç„¶å¾Œè¼¸å…¥ï¼š<code>cargo init game</code></p>
<p>ç„¶å¾Œå°èˆªè‡³æ–°å»ºç«‹çš„ <code>game</code> ç›®éŒ„ã€‚</p>
<pre><code>game
â”œâ”€â”€ Cargo.toml
â””â”€â”€ src
    â””â”€â”€ main.rs
</code></pre>
<p>ä½ æ‡‰è©²èƒ½çœ‹åˆ°ä¸€å€‹åç‚º <code>src</code> çš„ç›®éŒ„ï¼Œå…¶ä¸­æœ‰ä¸€å€‹åç‚º <code>main.rs</code> çš„æª”æ¡ˆï¼š</p>
<pre><code>fn main() {
    println!("Hello, world!");
}
</code></pre>
<p>å°‡å…¶å…§å®¹å–ä»£ç‚ºä¸Šè¿°çš„ FizzBuzz å¯¦ç¾ã€‚ç„¶å¾Œé‹è¡Œ <code>cargo run</code>ã€‚ è¼¸å‡ºçµæœæ‡‰è©²åƒé€™æ¨£ï¼š</p>
<pre><code>$ cargo run   Compiling playground v0.0.1 (/home/bencher)    Finished dev [unoptimized + debuginfo] target(s) in 0.44s     Running `target/debug/game`
12Fizz4BuzzFizz78FizzBuzz11Fizz1314FizzBuzz...9798FizzBuzz
</code></pre>
<blockquote>
<p>ğŸ° ç °ï¼ä½ æ­£åœ¨ç ´è§£ç¨‹å¼è¨­è¨ˆé¢è©¦ï¼</p>
</blockquote>
<p>æ‡‰è©²ç”Ÿæˆäº†ä¸€å€‹æ–°çš„ <code>Cargo.lock</code> æª”æ¡ˆï¼š</p>
<pre><code>game
â”œâ”€â”€ Cargo.lock
â”œâ”€â”€ Cargo.toml
â””â”€â”€ src
    â””â”€â”€ main.rs
</code></pre>
<p>åœ¨é€²ä¸€æ­¥æ¢è¨ä¹‹å‰ï¼Œæœ‰å¿…è¦è¨è«–å¾®åŸºæº–æ¸¬è©¦å’Œå®ç¢æº–æ¸¬è©¦ä¹‹é–“çš„å€åˆ¥ã€‚</p>
<h2 id="å¾®åŸºæº–æ¸¬è©¦-vs-å®ç¢æº–æ¸¬è©¦"><a class="header" href="#å¾®åŸºæº–æ¸¬è©¦-vs-å®ç¢æº–æ¸¬è©¦">å¾®åŸºæº–æ¸¬è©¦ vs å®ç¢æº–æ¸¬è©¦</a></h2>
<p>æœ‰å…©å¤§é¡è»Ÿé«”åŸºæº–æ¸¬è©¦ï¼šå¾®åŸºæº–æ¸¬è©¦å’Œå®ç¢æº–æ¸¬è©¦ã€‚ å¾®åŸºæº–æ¸¬è©¦çš„æ“ä½œå±¤æ¬¡å’Œå–®å…ƒæ¸¬è©¦é¡ä¼¼ã€‚ ä¾‹å¦‚ï¼Œç‚ºä¸€å€‹ç¢ºå®šå–®å€‹æ•¸å­—æ˜¯ <code>Fizz</code>ã€ <code>Buzz</code>ï¼Œé‚„æ˜¯ <code>FizzBuzz</code> çš„å‡½æ•¸è¨­ç«‹çš„åŸºæº–æ¸¬è©¦ï¼Œå°±æ˜¯ä¸€å€‹å¾®åŸºæº–æ¸¬è©¦ã€‚ å®ç¢æº–æ¸¬è©¦çš„æ“ä½œå±¤æ¬¡å’Œæ•´åˆæ¸¬è©¦é¡ä¼¼ã€‚ ä¾‹å¦‚ï¼Œç‚ºä¸€å‡½æ•¸è¨­ç«‹çš„åŸºæº–æ¸¬è©¦ï¼Œè©²å‡½æ•¸å¯ä»¥ç©å®Œæ•´å€‹ FizzBuzz éŠæˆ²ï¼Œå¾ <code>1</code> åˆ° <code>100</code>ï¼Œé€™å°±æ˜¯ä¸€å€‹å®ç¢æº–æ¸¬è©¦ã€‚</p>
<p>é€šå¸¸ï¼Œå„˜å¯èƒ½åœ¨æœ€ä½çš„æŠ½è±¡ç­‰ç´šé€²è¡Œæ¸¬è©¦æ˜¯æœ€å¥½çš„ã€‚ åœ¨åŸºæº–æ¸¬è©¦çš„æƒ…æ³ä¸‹ï¼Œé€™ä½¿å¾—å®ƒå€‘æ›´æ˜“æ–¼ç¶­è­·ï¼Œ ä¸¦æœ‰åŠ©æ–¼æ¸›å°‘æ¸¬é‡ä¸­çš„å™ªè²ã€‚ ç„¶è€Œï¼Œå°±åƒæœ‰ä¸€äº›ç«¯åˆ°ç«¯æ¸¬è©¦å°æ–¼å¥å…¨æ€§æª¢æŸ¥æ•´å€‹ç³»çµ±æ ¹æ“šé æœŸçµ„åˆåœ¨ä¸€èµ·éå¸¸æœ‰ç”¨ä¸€æ¨£ï¼Œ æ“æœ‰å®ç¢æº–æ¸¬è©¦å°æ–¼ç¢ºä¿æ‚¨çš„è»Ÿé«”ä¸­çš„é—œéµè·¯å¾‘ä¿æŒé«˜æ€§èƒ½ä¹Ÿéå¸¸æœ‰ç”¨ã€‚</p>
<h2 id="åœ¨-rust-ä¸­é€²è¡ŒåŸºæº–æ¸¬è©¦"><a class="header" href="#åœ¨-rust-ä¸­é€²è¡ŒåŸºæº–æ¸¬è©¦">åœ¨ Rust ä¸­é€²è¡ŒåŸºæº–æ¸¬è©¦</a></h2>
<p>åœ¨ Rust ä¸­å¸¸ç”¨çš„åŸºæº–æ¸¬è©¦å·¥å…·æœ‰ä¸‰ç¨®ï¼š <a href="https://bencher.dev/learn/benchmarking/rust/libtest-bench/">libtest bench</a>ï¼Œ <a href="https://bencher.dev/learn/benchmarking/rust/criterion/">Criterion</a>ï¼Œ ä»¥åŠ <a href="https://bencher.dev/learn/benchmarking/rust/iai/">Iai</a>ã€‚</p>
<p>libtest æ˜¯ Rust çš„å…§å»ºå–®å…ƒæ¸¬è©¦å’ŒåŸºæº–æ¸¬è©¦æ¡†æ¶ã€‚ å„˜ç®¡ libtest bench æ˜¯ Rust æ¨™æº–åº«çš„ä¸€éƒ¨åˆ†ï¼Œä½†å®ƒä»è¢«èªç‚ºæ˜¯ä¸ç©©å®šçš„ï¼Œ æ‰€ä»¥å®ƒåªåœ¨ <code>nightly</code> ç·¨è­¯å™¨ç‰ˆæœ¬ä¸­å¯ç”¨ã€‚ è¦åœ¨ç©©å®šçš„ Rust ç·¨è­¯å™¨ä¸Šå·¥ä½œï¼Œ éœ€è¦ä½¿ç”¨ <a href="https://github.com/bluss/bencher">å–®ç¨çš„åŸºæº–æ¸¬è©¦æ¡†æ¶</a>ã€‚ ç„¶è€Œï¼Œé€™å…©è€…éƒ½ä¸åœ¨ç©æ¥µé–‹ç™¼ä¸­ã€‚</p>
<p>åœ¨ Rust ç”Ÿæ…‹ç³»çµ±ä¸­ï¼Œç¶­è­·æœ€ç©æ¥µçš„åŸºæº–æ¸¬è©¦æ¡†æ¶æ˜¯ Criterionã€‚ å®ƒæ—¢å¯ä»¥åœ¨ç©©å®šçš„ Rust ç·¨è­¯å™¨ç‰ˆæœ¬ä¸Šé‹è¡Œï¼Œä¹Ÿå¯ä»¥åœ¨ <code>nightly</code>ç‰ˆæœ¬ä¸Šé‹è¡Œï¼Œ å®ƒå·²ç¶“æˆç‚ºäº† Rust ç¤¾å€çš„äº‹å¯¦æ¨™æº–ã€‚ èˆ‡ libtest bench ç›¸æ¯”ï¼ŒCriterion é‚„æä¾›äº†æ›´å¤šçš„åŠŸèƒ½ã€‚</p>
<p>Criterion çš„å¯¦é©—æ€§æ›¿ä»£å“æ˜¯ Iaiï¼Œå®ƒå’Œ Criterion çš„å‰µä½œè€…æ˜¯åŒä¸€å€‹äººã€‚ ç„¶è€Œï¼Œå®ƒä½¿ç”¨æŒ‡ä»¤æ•¸é‡è€Œä¸æ˜¯ç‰†é˜æ™‚é–“ï¼š CPU æŒ‡ä»¤ï¼ŒL1 è¨ªå•ï¼ŒL2 è¨ªå•ä»¥åŠ RAM è¨ªå•ã€‚ é€™ä½¿å¾—å®ƒå¯ä»¥é€²è¡Œå–®æ¬¡åŸºæº–æ¸¬è©¦ï¼Œå› ç‚ºé€™äº›æŒ‡æ¨™åœ¨é‹è¡Œé–“æ‡‰è©²ä¿æŒå¹¾ä¹ä¸€è‡´ã€‚</p>
<p>ä¸‰è€…éƒ½æ˜¯<a href="https://bencher.dev/zh/docs/explanation/adapters/">ç”±Bencheræ”¯æ´çš„</a>ã€‚é‚£éº¼ç‚ºä»€éº¼è¦é¸æ“‡Criterionå‘¢ï¼Ÿ Criterionæ˜¯Rustç¤¾å€çš„äº‹å¯¦æ¨™æº–åŸºæº–æ¸¬è©¦å·¥å…·ã€‚ æˆ‘æ¨è–¦ä½¿ç”¨Criterionä¾†æ¸¬è©¦ä½ çš„ç¨‹å¼ç¢¼çš„å»¶é²ã€‚ ä¹Ÿå°±æ˜¯èªªï¼ŒCriterionéå¸¸é©åˆæ¸¬é‡æ™‚é˜æ™‚é–“ã€‚</p>
<h3 id="é‡æ§‹-fizzbuzz"><a class="header" href="#é‡æ§‹-fizzbuzz">é‡æ§‹ FizzBuzz</a></h3>
<p>ç‚ºäº†æ¸¬è©¦æˆ‘å€‘çš„ FizzBuzz æ‡‰ç”¨ï¼Œæˆ‘å€‘éœ€è¦å°‡é‚è¼¯å¾ç¨‹åºçš„ <code>main</code> å‡½æ•¸ä¸­è§£è€¦å‡ºä¾†ã€‚ åŸºæº–æ¸¬è©¦å·¥å…·ç„¡æ³•å° <code>main</code> å‡½æ•¸é€²è¡ŒåŸºæº–æ¸¬è©¦ã€‚ç‚ºäº†åšåˆ°é€™ä¸€é»ï¼Œæˆ‘å€‘éœ€è¦åšä¸€äº›æ”¹å‹•ã€‚</p>
<p>åœ¨ <code>src</code> ä¸‹ï¼Œå»ºç«‹ä¸€å€‹æ–°çš„åç‚º <code>lib.rs</code> çš„æª”æ¡ˆï¼š</p>
<pre><code>game
â”œâ”€â”€ Cargo.lock
â”œâ”€â”€ Cargo.toml
â””â”€â”€ src
    â””â”€â”€ lib.rs
    â””â”€â”€ main.rs
</code></pre>
<p>å°‡ä»¥ä¸‹ç¨‹å¼ç¢¼æ–°å¢åˆ° <code>lib.rs</code>ï¼š</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub fn play_game(n: u32, print: bool) {
    let result = fizz_buzz(n);
    if print {
        println!("{result}");
    }
}
pub fn fizz_buzz(n: u32) -&gt; String {
    match (n % 3, n % 5) {
        (0, 0) =&gt; "FizzBuzz".to_string(),
        (0, _) =&gt; "Fizz".to_string(),
        (_, 0) =&gt; "Buzz".to_string(),
        (_, _) =&gt; n.to_string(),
    }
}

<span class="boring">}</span></code></pre></pre>
<ul>
<li><code>play_game</code>ï¼šæ¥å—ä¸€å€‹ç„¡ç¬¦è™Ÿæ•´æ•¸ <code>n</code>ï¼Œç”¨è©²æ•¸å­—å‘¼å« <code>fizz_buzz</code>ï¼Œå¦‚æœ <code>print</code> ç‚º <code>true</code>ï¼Œå‰‡åˆ—å°çµæœã€‚</li>
<li><code>fizz_buzz</code>ï¼šæ¥å—ä¸€å€‹ç„¡ç¬¦è™Ÿæ•´æ•¸ <code>n</code>ï¼ŒåŸ·è¡Œå¯¦éš›çš„ <code>Fizz</code>ã€<code>Buzz</code>ã€<code>FizzBuzz</code> æˆ–æ•¸å­—é‚è¼¯ï¼Œç„¶å¾Œå°‡çµæœä½œç‚ºå­—ä¸²è¿”å›ã€‚</li>
</ul>
<p>ç„¶å¾Œæ›´æ–° <code>main.rs</code>ï¼Œä½¿å…¶çœ‹èµ·ä¾†åƒé€™æ¨£ï¼š</p>
<pre><pre class="playground"><code class="language-rust">use game::play_game;
fn main() {
    for i in 1..=100 {
        play_game(i, true);
    }
}</code></pre></pre>
<ul>
<li><code>game::play_game</code>ï¼šå¾æˆ‘å€‘å‰›å‰›ç”¨ <code>lib.rs</code> å»ºç«‹çš„ <code>game</code> åŒ…ä¸­åŒ¯å…¥ <code>play_game</code>ã€‚</li>
<li><code>main</code>ï¼šæˆ‘å€‘ç¨‹åºçš„ä¸»å…¥å£é»ï¼Œéæ­·å¾ <code>1</code> åˆ° <code>100</code> çš„æ•¸å­—ï¼Œå°æ¯å€‹æ•¸å­—å‘¼å« <code>play_game</code>ï¼Œä¸¦å°‡ <code>print</code> è¨­ç‚º <code>true</code>ã€‚</li>
</ul>
<h2 id="å°fizzbuzzçš„åŸºæº–æ¸¬è©¦"><a class="header" href="#å°fizzbuzzçš„åŸºæº–æ¸¬è©¦">å°FizzBuzzçš„åŸºæº–æ¸¬è©¦</a></h2>
<p>ç‚ºäº†å°æˆ‘å€‘çš„ç¨‹å¼ç¢¼é€²è¡ŒåŸºæº–æ¸¬è©¦ï¼Œæˆ‘å€‘éœ€è¦å»ºç«‹ä¸€å€‹<code>benches</code>ç›®éŒ„ï¼Œä¸¦æ–°å¢ä¸€å€‹æª”æ¡ˆä¾†åŒ…å«æˆ‘å€‘çš„åŸºæº–æ¸¬è©¦ï¼Œ<code>play_game.rs</code>ï¼š</p>
<pre><code>game
â”œâ”€â”€ Cargo.lock
â”œâ”€â”€ Cargo.toml
â””â”€â”€ benches
    â””â”€â”€ play_game.rs
â””â”€â”€ src
    â””â”€â”€ lib.rs
    â””â”€â”€ main.rs
</code></pre>
<p>åœ¨<code>play_game.rs</code>ä¸­å¢åŠ ä¸‹åˆ—ç¨‹å¼ç¢¼ï¼š</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use criterion::{criterion_group, criterion_main, Criterion};
use game::play_game;
fn bench_play_game(c: &amp;mut Criterion) {
    c.bench_function("bench_play_game", |b| {
        b.iter(|| {
            std::hint::black_box(for i in 1..=100 {
                play_game(i, false)
            });
        });
    });
}
criterion_group!(benches, bench_play_game,);
criterion_main!(benches);
<span class="boring">}</span></code></pre></pre>
<ul>
<li>åŒ¯å…¥<code>Criterion</code>åŸºæº–æ¸¬è©¦é‹è¡Œå™¨ã€‚</li>
<li>å¾æˆ‘å€‘çš„<code>game</code>åŒ…ä¸­åŒ¯å…¥<code>play_game</code>å‡½æ•¸ã€‚</li>
<li>å»ºç«‹ä¸€å€‹åç‚º<code>bench_play_game</code>çš„å‡½æ•¸ï¼Œå®ƒæ¥å—ä¸€å€‹å°<code>Criterion</code>çš„å¯è®Šå¼•ç”¨ã€‚</li>
<li>ä½¿ç”¨<code>Criterion</code>å¯¦ä¾‹ï¼ˆ<code>c</code>ï¼‰ä¾†å»ºç«‹ä¸€å€‹åç‚º<code>bench_play_game</code>çš„åŸºæº–æ¸¬è©¦ã€‚</li>
<li>ç„¶å¾Œä½¿ç”¨åŸºæº–æ¸¬è©¦é‹è¡Œå™¨ï¼ˆ<code>b</code>ï¼‰ä¾†å¤šæ¬¡é‹è¡Œæˆ‘å€‘çš„å®ç¢æº–æ¸¬è©¦ã€‚</li>
<li>åœ¨ä¸€å€‹â€é»‘ç®±â€ä¸­é‹è¡Œæˆ‘å€‘çš„å®ç¢æº–æ¸¬è©¦ï¼Œé€™æ¨£ç·¨è­¯å™¨å°±ä¸æœƒæœ€ä½³åŒ–æˆ‘å€‘çš„ç¨‹å¼ç¢¼ã€‚</li>
<li>å¾<code>1</code>åˆ°<code>100</code>åŒ…æ‹¬ï¼Œé€²è¡Œè¿­ä»£ã€‚</li>
<li>å°æ–¼æ¯ä¸€å€‹æ•¸å­—ï¼Œå‘¼å«<code>play_game</code>ï¼Œè¨­å®š<code>print</code>ç‚º<code>false</code>ã€‚</li>
</ul>
<p>ç¾åœ¨æˆ‘å€‘éœ€è¦çµ„æ…‹<code>game</code>åŒ…ä¾†é‹è¡Œæˆ‘å€‘çš„åŸºæº–æ¸¬è©¦ã€‚</p>
<p>åœ¨ä½ çš„<code>Cargo.toml</code>æª”æ¡ˆçš„åº•éƒ¨æ–°å¢ä»¥ä¸‹å…§å®¹ï¼š</p>
<pre><code>[dev-dependencies]
criterion = "0.5"

[[bench]]
name = "play_game"
harness = false
</code></pre>
<ul>
<li><code>criterion</code>ï¼šå°‡<code>criterion</code>æ–°å¢ç‚ºé–‹ç™¼ä¾è³´ï¼Œå› ç‚ºæˆ‘å€‘åªåœ¨æ€§èƒ½æ¸¬è©¦ä¸­ä½¿ç”¨å®ƒã€‚</li>
<li><code>bench</code>ï¼šè¨»å†Š<code>play_game</code>ä½œç‚ºä¸€å€‹åŸºæº–æ¸¬è©¦ï¼Œä¸¦è¨­å®š<code>harness</code>ç‚º<code>false</code>ï¼Œå› ç‚ºæˆ‘å€‘å°‡ä½¿ç”¨Criterionä½œç‚ºæˆ‘å€‘çš„åŸºæº–æ¸¬è©¦å·¥å…·ã€‚</li>
</ul>
<p>ç¾åœ¨æˆ‘å€‘å·²ç¶“æº–å‚™å¥½é€²è¡ŒåŸºæº–æ¸¬è©¦äº†ï¼Œé‹è¡Œ<code>cargo bench</code>ï¼š</p>
<pre><code class="language-shell">$ cargo bench
   Compiling playground v0.0.1 (/home/bencher)
    Finished bench [optimized] target(s) in 4.79s
     Running unittests src/main.rs (target/release/deps/game-68f58c96f4025bd4)

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

     Running unittests src/main.rs (target/release/deps/game-043972c4132076a9)

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

     Running benches/play_game.rs (target/release/deps/play_game-e0857103eb02eb56)
bench_play_game         time:   [3.0020 Âµs 3.0781 Âµs 3.1730 Âµs]
Found 12 outliers among 100 measurements (12.00%)
  2 (2.00%) high mild
  10 (10.00%) high severe
</code></pre>
<blockquote>
<p>ğŸ° è®“æˆ‘å€‘èª¿é«˜ç¯€æ‹ï¼æˆ‘å€‘å·²ç¶“å¾—åˆ°äº†ç¬¬ä¸€å€‹åŸºæº–æ¸¬è©¦æŒ‡æ¨™ï¼</p>
</blockquote>
<p>æœ€å¾Œï¼Œæˆ‘å€‘å¯ä»¥è®“æˆ‘å€‘ç–²å€¦çš„é–‹ç™¼è€…é ­è…¦å¾—åˆ°ä¼‘æ¯â€¦ é–‹ç©ç¬‘ï¼Œæˆ‘å€‘çš„ä½¿ç”¨è€…æƒ³è¦ä¸€å€‹æ–°åŠŸèƒ½ï¼</p>
<h2 id="ç”¨-rust-ç·¨å¯«-fizzbuzzfibonacci"><a class="header" href="#ç”¨-rust-ç·¨å¯«-fizzbuzzfibonacci">ç”¨ Rust ç·¨å¯« FizzBuzzFibonacci</a></h2>
<p>æˆ‘å€‘çš„é—œéµç¸¾æ•ˆæŒ‡æ¨™ï¼ˆKPIï¼‰ä¸‹é™äº†ï¼Œæ‰€ä»¥æˆ‘å€‘çš„ç”¢å“ç¶“ç†ï¼ˆPMï¼‰å¸Œæœ›æˆ‘å€‘æ–°å¢æ–°åŠŸèƒ½ã€‚ ç¶“éå¤šæ¬¡é ­è…¦é¢¨æš´å’Œè¨±å¤šä½¿ç”¨è€…æ¡è¨ªå¾Œï¼Œæˆ‘å€‘æ±ºå®šå…‰æœ‰ FizzBuzz å·²ç¶“ä¸å¤ äº†ã€‚ ç¾åœ¨çš„å­©å­å€‘å¸Œæœ›æœ‰ä¸€å€‹æ–°çš„éŠæˆ²ï¼ŒFizzBuzzFibonacciã€‚</p>
<p>FizzBuzzFibonacciçš„è¦å‰‡å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>ç·¨å¯«ä¸€å€‹ç¨‹åºï¼Œåˆ—å°å¾ <code>1</code> åˆ° <code>100</code> çš„æ•´æ•¸ï¼ˆåŒ…æ‹¬ï¼‰ï¼š</p>
<ul>
<li>å°æ–¼ä¸‰çš„å€æ•¸ï¼Œåˆ—å° <code>Fizz</code></li>
<li>å°æ–¼äº”çš„å€æ•¸ï¼Œåˆ—å° <code>Buzz</code></li>
<li>å°æ–¼æ—¢æ˜¯ä¸‰çš„å€æ•¸åˆæ˜¯äº”çš„å€æ•¸çš„ï¼Œåˆ—å° <code>FizzBuzz</code></li>
<li>å°æ–¼æ˜¯æ–æ³¢é‚£å¥‘æ•¸åˆ—çš„æ•¸å­—ï¼Œåªåˆ—å° <code>Fibonacci</code></li>
<li>å°æ–¼æ‰€æœ‰å…¶ä»–çš„ï¼Œåˆ—å°è©²æ•¸</li>
</ul>
</blockquote>
<p><a href="https://zh.wikipedia.org/wiki/%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E6%95%B8%E5%88%97">æ–æ³¢é‚£å¥‘æ•¸åˆ—</a>æ˜¯ä¸€å€‹æ¯å€‹æ•¸å­—æ˜¯å‰å…©å€‹æ•¸å­—ä¹‹å’Œçš„åºåˆ—ã€‚ ä¾‹å¦‚ï¼Œå¾ <code>0</code> å’Œ <code>1</code>é–‹å§‹ï¼Œæ–æ³¢é‚£å¥‘æ•¸åˆ—çš„ä¸‹ä¸€å€‹æ•¸å­—å°‡æ˜¯ <code>1</code>ã€‚ å¾Œé¢æ˜¯ï¼š<code>2</code>, <code>3</code>, <code>5</code>, <code>8</code> ç­‰ç­‰ã€‚ æ–æ³¢é‚£å¥‘æ•¸åˆ—çš„æ•¸å­—è¢«ç¨±ç‚ºæ–æ³¢é‚£å¥‘æ•¸ã€‚æ‰€ä»¥æˆ‘å€‘å°‡ä¸å¾—ä¸ç·¨å¯«ä¸€å€‹æª¢æ¸¬æ–æ³¢é‚£å¥‘æ•¸çš„å‡½æ•¸ã€‚</p>
<p>æœ‰<a href="https://rosettacode.org/wiki/Fibonacci_sequence">è¨±å¤šæ–¹æ³•å¯ä»¥ç·¨å¯«æ–æ³¢é‚£å¥‘æ•¸åˆ—</a>ï¼ŒåŒæ¨£ä¹Ÿæœ‰è¨±å¤šæ–¹æ³•å¯ä»¥æª¢æ¸¬ä¸€å€‹æ–æ³¢é‚£å¥‘æ•¸ã€‚ æ‰€ä»¥æˆ‘å€‘å°‡æ¡ç”¨æˆ‘çš„æœ€æ„›ï¼š</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn is_fibonacci_number(n: u32) -&gt; bool {
    for i in 0..=n {
        let (mut previous, mut current) = (0, 1);
        while current &lt; i {
            let next = previous + current;
            previous = current;
            current = next;
        }
        if current == n {
            return true;
        }
    }
    false
}
<span class="boring">}</span></code></pre></pre>
<ul>
<li>å»ºç«‹ä¸€å€‹åç‚º <code>is_fibonacci_number</code> çš„å‡½æ•¸ï¼Œè©²å‡½æ•¸æ¥æ”¶ä¸€å€‹ç„¡ç¬¦è™Ÿæ•´æ•¸ï¼Œä¸¦è¿”å›ä¸€å€‹å¸ƒæ—å€¼ã€‚</li>
<li>éæ­·å¾ <code>0</code> åˆ°æˆ‘å€‘çµ¦å®šçš„æ•¸ <code>n</code>ï¼ˆåŒ…å« <code>n</code>ï¼‰çš„æ‰€æœ‰æ•¸å­—ã€‚</li>
<li>ç”¨ <code>0</code> å’Œ <code>1</code> åˆ†åˆ¥ä½œç‚º<code>å‰ä¸€å€‹</code> å’Œ <code>ç•¶å‰</code> æ•¸å­—ä¾†åˆå§‹åŒ–æˆ‘å€‘çš„æ–æ³¢é‚£å¥‘åºåˆ—ã€‚</li>
<li>ç•¶<code>ç•¶å‰</code>æ•¸å­—å°æ–¼ç•¶å‰è¿­ä»£ <code>i</code> æ™‚æŒçºŒè¿­ä»£ã€‚</li>
<li>æ–°å¢<code>å‰ä¸€å€‹</code> å’Œ <code>ç•¶å‰</code> æ•¸å­—ä¾†ç²å¾— <code>ä¸‹ä¸€å€‹</code> æ•¸å­—ã€‚</li>
<li>å°‡ <code>å‰ä¸€å€‹</code> æ•¸å­—æ›´æ–°ç‚º <code>ç•¶å‰</code> æ•¸å­—ã€‚</li>
<li>å°‡ <code>ç•¶å‰</code> æ•¸å­—æ›´æ–°ç‚º <code>ä¸‹ä¸€å€‹</code> æ•¸å­—ã€‚</li>
<li>ä¸€æ—¦ <code>ç•¶å‰</code> å¤§æ–¼æˆ–ç­‰æ–¼çµ¦å®šæ•¸å­— <code>n</code>ï¼Œæˆ‘å€‘å°‡é€€å‡ºå¾ªç’°ã€‚</li>
<li>æª¢æŸ¥ <code>ç•¶å‰</code> æ•¸å­—æ˜¯å¦ç­‰æ–¼çµ¦å®šæ•¸å­— <code>n</code>ï¼Œå¦‚æœæ˜¯ï¼Œå‰‡è¿”å› <code>true</code>ã€‚</li>
<li>å¦å‰‡ï¼Œè¿”å› <code>false</code>ã€‚</li>
</ul>
<p>ç¾åœ¨æˆ‘å€‘éœ€è¦æ›´æ–°æˆ‘å€‘çš„ <code>fizz_buzz</code> åŠŸèƒ½ï¼š</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub fn fizz_buzz_fibonacci(n: u32) -&gt; String {
    if is_fibonacci_number(n) {
        "Fibonacci".to_string()
    } else {
        match (n % 3, n % 5) {
            (0, 0) =&gt; "FizzBuzz".to_string(),
            (0, _) =&gt; "Fizz".to_string(),
            (_, 0) =&gt; "Buzz".to_string(),
            (_, _) =&gt; n.to_string(),
        }
    }
}
<span class="boring">}</span></code></pre></pre>
<ul>
<li>å°‡ <code>fizz_buzz</code> åŠŸèƒ½é‡æ–°å‘½åç‚º <code>fizz_buzz_fibonacci</code> ä»¥ä½¿å…¶æ›´å…·æè¿°æ€§ã€‚</li>
<li>å‘¼å«æˆ‘å€‘çš„ <code>is_fibonacci_number</code> è¼”åŠ©å‡½æ•¸ã€‚</li>
<li>å¦‚æœ <code>is_fibonacci_number</code> çš„çµæœç‚º <code>true</code>ï¼Œå‰‡è¿”å› <code>Fibonacci</code>ã€‚</li>
<li>å¦‚æœ <code>is_fibonacci_number</code> çš„çµæœç‚º <code>false</code>ï¼Œå‰‡åŸ·è¡Œç›¸åŒçš„ <code>Fizz</code>ã€<code>Buzz</code>ã€<code>FizzBuzz</code> æˆ–æ•¸å­—é‚è¼¯ï¼Œä¸¦è¿”å›çµæœã€‚</li>
</ul>
<p>å› ç‚ºæˆ‘å€‘å°‡ <code>fizz_buzz</code> é‡æ–°å‘½åç‚º <code>fizz_buzz_fibonacci</code>ï¼Œæˆ‘å€‘ä¹Ÿéœ€è¦æ›´æ–°æˆ‘å€‘çš„ <code>play_game</code> åŠŸèƒ½ï¼š</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub fn play_game(n: u32, print: bool) {
    let result = fizz_buzz_fibonacci(n);
    if print {
        println!("{result}");
    }
}
<span class="boring">}</span></code></pre></pre>
<p>æˆ‘å€‘çš„ <code>main</code> å’Œ <code>bench_play_game</code> åŠŸèƒ½å¯ä»¥ä¿æŒå®Œå…¨ç›¸åŒã€‚</p>
<h2 id="å°fizzbuzzfibonacciçš„åŸºæº–æ¸¬è©¦"><a class="header" href="#å°fizzbuzzfibonacciçš„åŸºæº–æ¸¬è©¦">å°FizzBuzzFibonacciçš„åŸºæº–æ¸¬è©¦</a></h2>
<p>ç¾åœ¨æˆ‘å€‘å¯ä»¥é‡æ–°é‹è¡Œæˆ‘å€‘çš„åŸºæº–æ¸¬è©¦äº†ï¼š</p>
<pre><code>$ cargo bench
   Compiling playground v0.0.1 (/home/bencher)
    Finished bench [optimized] target(s) in 4.79s
     Running unittests src/main.rs (target/release/deps/game-68f58c96f4025bd4)

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

     Running unittests src/main.rs (target/release/deps/game-043972c4132076a9)

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

     Running benches/play_game.rs (target/release/deps/play_game-e0857103eb02eb56)
bench_play_game         time:   [20.067 Âµs 20.107 Âµs 20.149 Âµs]
                        change: [+557.22% +568.69% +577.93%] (p = 0.00 &lt; 0.05)
                        Performance has regressed.
Found 6 outliers among 100 measurements (6.00%)
  4 (4.00%) high mild
  2 (2.00%) high severe
</code></pre>
<p>å“¦å“¦ï¼Criterionå‘æˆ‘å€‘é¡¯ç¤ºäº†FizzBuzzå’ŒFizzBuzzFibonacciéŠæˆ²ä¹‹é–“æ€§èƒ½å·®è·ç‚º<code>+568.69%</code>ã€‚ ä½ çš„æ•¸å­—æœƒæ¯”æˆ‘çš„ç¨å¾®æœ‰äº›ä¸åŒã€‚ ç„¶è€Œï¼Œå…©è€…ä¹‹é–“çš„å·®è·å¯èƒ½åœ¨<code>5x</code>çš„ç¯„åœå…§ã€‚ é€™å°æˆ‘ä¾†èªªçœ‹èµ·ä¾†æ˜¯æ¯”è¼ƒå¥½çš„çµæœï¼ç‰¹åˆ¥æ˜¯è€ƒæ…®åˆ°æˆ‘å€‘å°‡åƒ_Fibonacci_é€™æ¨£çš„èŠ±å“¨åŠŸèƒ½æ–°å¢åˆ°æˆ‘å€‘çš„éŠæˆ²ä¸­ã€‚ å­©å­å€‘æœƒå–œæ­¡çš„ï¼</p>
<h2 id="åœ¨-rust-ä¸­å±•é–‹-fizzbuzzfibonacci"><a class="header" href="#åœ¨-rust-ä¸­å±•é–‹-fizzbuzzfibonacci">åœ¨ Rust ä¸­å±•é–‹ FizzBuzzFibonacci</a></h2>
<p>æˆ‘å€‘çš„éŠæˆ²å¾ˆå—æ­¡è¿ï¼å­©å­å€‘ç¢ºå¯¦å–œæ­¡ç© FizzBuzzFibonacciã€‚ ç‚ºæ­¤ï¼Œé«˜å±¤ä¸‹é”äº†ä»–å€‘æƒ³è¦çºŒé›†çš„æ¶ˆæ¯ã€‚ ä½†é€™æ˜¯ç¾ä»£ä¸–ç•Œï¼Œæˆ‘å€‘éœ€è¦çš„æ˜¯å¹´åº¦å¾ªç’°æ”¶å…¥ï¼ˆARRï¼‰ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§è³¼è²·ï¼ æˆ‘å€‘éŠæˆ²çš„æ–°é¡˜æ™¯æ˜¯é–‹æ”¾æ€§çš„ï¼Œä¸å†å›ºå®šåœ¨ <code>1</code> å’Œ <code>100</code> ä¹‹é–“ï¼ˆå³ä½¿æ˜¯åŒ…å«åœ¨å…§çš„ï¼‰ã€‚ ä¸ï¼Œæˆ‘å€‘æ­£åœ¨é–‹æ‹“æ–°çš„ç–†åŸŸï¼</p>
<p>Open World FizzBuzzFibonacciçš„è¦å‰‡å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>ç·¨å¯«ä¸€å€‹ç¨‹åºï¼Œå®ƒæ¥å—_ä»»ä½•_æ­£æ•´æ•¸ä¸¦åˆ—å°ï¼š</p>
<ul>
<li>å°æ–¼ä¸‰çš„å€æ•¸ï¼Œåˆ—å° <code>Fizz</code></li>
<li>å°æ–¼äº”çš„å€æ•¸ï¼Œåˆ—å° <code>Buzz</code></li>
<li>å°æ–¼åŒæ™‚æ˜¯ä¸‰å’Œäº”çš„å€æ•¸çš„ï¼Œå‰‡åˆ—å° <code>FizzBuzz</code></li>
<li>å°æ–¼æ˜¯æ–æ³¢é‚£å¥‘æ•¸åˆ—çš„æ•¸å­—ï¼Œåªåˆ—å° <code>Fibonacci</code></li>
<li>å°æ–¼å…¶ä»–æ‰€æœ‰æ•¸å­—ï¼Œåˆ—å°è©²æ•¸å­—</li>
</ul>
</blockquote>
<p>ç‚ºäº†è®“æˆ‘å€‘çš„éŠæˆ²é©æ‡‰ä»»ä½•æ•¸å­—ï¼Œæˆ‘å€‘éœ€è¦æ¥å—ä¸€å€‹å‘½ä»¤åˆ—åƒæ•¸ã€‚ å°‡ <code>main</code> å‡½æ•¸æ›´æ–°ç‚ºå¦‚ä¸‹å½¢å¼ï¼š</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let args: Vec&lt;String&gt; = std::env::args().collect();
    let i = args
        .get(1)
        .map(|s| s.parse::&lt;u32&gt;())
        .unwrap_or(Ok(15))
        .unwrap_or(15);
    play_game(i, true);
}</code></pre></pre>
<ul>
<li>æ”¶é›†æ‰€æœ‰å¾å‘½ä»¤åˆ—å‚³éçµ¦æˆ‘å€‘éŠæˆ²çš„åƒæ•¸ï¼ˆ<code>args</code>ï¼‰ã€‚</li>
<li>ç²å–å‚³éçµ¦æˆ‘å€‘éŠæˆ²çš„ç¬¬ä¸€å€‹åƒæ•¸ï¼Œä¸¦å°‡å…¶è§£æç‚ºç„¡ç¬¦è™Ÿæ•´æ•¸ <code>i</code>ã€‚</li>
<li>å¦‚æœè§£æå¤±æ•—æˆ–æ²’æœ‰å‚³å…¥åƒæ•¸ï¼Œå°±é»˜èªä»¥ <code>15</code> ä½œç‚ºè¼¸å…¥é‹è¡Œæˆ‘å€‘çš„éŠæˆ²ã€‚</li>
<li>æœ€å¾Œï¼Œç”¨æ–°è§£æçš„ç„¡ç¬¦è™Ÿæ•´æ•¸ <code>i</code> ä¾†ç©æˆ‘å€‘çš„éŠæˆ²ã€‚</li>
</ul>
<p>ç¾åœ¨æˆ‘å€‘å¯ä»¥ç”¨ä»»ä½•æ•¸å­—ä¾†ç©æˆ‘å€‘çš„éŠæˆ²äº†ï¼ ä½¿ç”¨ <code>cargo run</code> å¾Œè·Ÿ <code>--</code> å°‡åƒæ•¸å‚³éçµ¦æˆ‘å€‘çš„éŠæˆ²ï¼š</p>
<pre><code>$ cargo run -- 9
   Compiling playground v0.0.1 (/home/bencher)
    Finished dev [unoptimized + debuginfo] target(s) in 0.44s
     Running `target/debug/game 9`
Fizz
$ cargo run -- 10
    Finished dev [unoptimized + debuginfo] target(s) in 0.03s
     Running `target/debug/game 10`
Buzz
$ cargo run -- 13
    Finished dev [unoptimized + debuginfo] target(s) in 0.04s
     Running `target/debug/game 13`
Fibonacci
</code></pre>
<p>å¦‚æœæˆ‘å€‘çœç•¥æˆ–æä¾›äº†ç„¡æ•ˆçš„æ•¸å­—ï¼š</p>
<pre><code>$ cargo run
    Finished dev [unoptimized + debuginfo] target(s) in 0.03s
     Running `target/debug/game`
FizzBuzz
$ cargo run -- bad
    Finished dev [unoptimized + debuginfo] target(s) in 0.05s
     Running `target/debug/game bad`
FizzBuzz
</code></pre>
<p>å“‡ï¼Œé€™æ˜¯ä¸€å€‹ä»”ç´°çš„æ¸¬è©¦éç¨‹ï¼CI é€šéäº†ã€‚æˆ‘å€‘çš„ä¸Šå¸éå¸¸é«˜èˆˆã€‚ è®“æˆ‘å€‘ç™¼ä½ˆå§ï¼ğŸš€</p>
<h2 id="çµæŸ"><a class="header" href="#çµæŸ">çµæŸ</a></h2>
<p><img src="images/three-weeks-later.jpeg" alt="æµ·ç¶¿å¯¶å¯¶ä¸‰é€±å¾Œ" /></p>
<p><img src="images/this-is-fine.jpg" alt="ä¸€åˆ‡æ­£å¸¸çš„æ¨¡å› " /></p>
<blockquote>
<p>ğŸ° â€¦ ä¹Ÿè¨±é€™æ˜¯ä½ çš„è·æ¥­ç”Ÿæ¶¯çš„çµæŸï¼Ÿ</p>
</blockquote>
<h2 id="é–‹ç©ç¬‘çš„å…¶å¯¦ä¸€åˆ‡éƒ½åœ¨ç‡ƒç‡’"><a class="header" href="#é–‹ç©ç¬‘çš„å…¶å¯¦ä¸€åˆ‡éƒ½åœ¨ç‡ƒç‡’">é–‹ç©ç¬‘çš„ï¼å…¶å¯¦ä¸€åˆ‡éƒ½åœ¨ç‡ƒç‡’ï¼ğŸ”¥</a></h2>
<p>èµ·åˆï¼Œä¸€åˆ‡çœ‹ä¼¼é€²è¡Œå¾—é †åˆ©ã€‚ ä½†åœ¨é€±å…­æ—©ä¸Š02:07ï¼Œæˆ‘çš„å°‹å‘¼æ©ŸéŸ¿äº†èµ·ä¾†ï¼š</p>
<blockquote>
<p>ğŸ“Ÿ ä½ çš„éŠæˆ²èµ·ç«äº†ï¼ğŸ”¥</p>
</blockquote>
<p>å¾åºŠä¸ŠåŒ†å¿™çˆ¬èµ·ä¾†å¾Œï¼Œæˆ‘è©¦åœ–å¼„æ¸…æ¥šç™¼ç”Ÿäº†ä»€éº¼ã€‚ æˆ‘è©¦åœ–æœå°‹æ—¥èªŒï¼Œä½†é€™éå¸¸å›°é›£ï¼Œå› ç‚ºä¸€åˆ‡éƒ½åœ¨ä¸åœåœ°å´©æ½°ã€‚ æœ€å¾Œï¼Œæˆ‘ç™¼ç¾äº†å•é¡Œã€‚å­©å­å€‘ï¼ä»–å€‘éå¸¸å–œæ­¡æˆ‘å€‘çš„éŠæˆ²ï¼Œä»¥è‡³æ–¼ç©äº†é«˜é”ä¸€ç™¾è¬æ¬¡ï¼ åœ¨ä¸€è‚¡éˆæ„Ÿçš„é–ƒç¾ä¸­ï¼Œæˆ‘æ–°å¢äº†å…©å€‹æ–°çš„åŸºæº–æ¸¬è©¦ï¼š</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn bench_play_game_100(c: &amp;mut Criterion) {
    c.bench_function("bench_play_game_100", |b| {
        b.iter(|| std::hint::black_box(play_game(100, false)));
    });
}
fn bench_play_game_1_000_000(c: &amp;mut Criterion) {
    c.bench_function("bench_play_game_1_000_000", |b| {
        b.iter(|| std::hint::black_box(play_game(1_000_000, false)));
    });
}
<span class="boring">}</span></code></pre></pre>
<ul>
<li>ä¸€å€‹ç”¨æ–¼ç©éŠæˆ²ä¸¦è¼¸å…¥æ•¸å­—ä¸€ç™¾ï¼ˆ<code>100</code>ï¼‰çš„å¾®åŸºæº–æ¸¬è©¦<code>bench_play_game_100</code>ã€‚</li>
<li>ä¸€å€‹ç”¨æ–¼ç©éŠæˆ²ä¸¦è¼¸å…¥æ•¸å­—ä¸€ç™¾è¬ï¼ˆ<code>1_000_000</code>ï¼‰çš„å¾®åŸºæº–æ¸¬è©¦<code>bench_play_game_1_000_000</code>ã€‚</li>
</ul>
<p>ç•¶æˆ‘é‹è¡Œå®ƒæ™‚ï¼Œæˆ‘å¾—åˆ°äº†é€™å€‹ï¼š</p>
<pre><code>$ cargo bench
   Compiling playground v0.0.1 (/home/bencher)
    Finished bench [optimized] target(s) in 4.79s
     Running unittests src/main.rs (target/release/deps/game-68f58c96f4025bd4)

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

     Running unittests src/main.rs (target/release/deps/game-043972c4132076a9)

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

     Running benches/play_game.rs (target/release/deps/play_game-e0857103eb02eb56)
bench_play_game         time:   [20.024 Âµs 20.058 Âµs 20.096 Âµs]
                        change: [-0.0801% +0.1431% +0.3734%] (p = 0.21 &gt; 0.05)
                        No change in performance detected.
Found 17 outliers among 100 measurements (17.00%)
  9 (9.00%) high mild
  8 (8.00%) high severe

bench_play_game_100     time:   [403.00 ns 403.57 ns 404.27 ns]
Found 13 outliers among 100 measurements (13.00%)
  6 (6.00%) high mild
  7 (7.00%) high severe
</code></pre>
<p>ç­‰å¾…ä¸€ä¸‹â€¦ ç­‰å¾…ä¸€ä¸‹â€¦</p>
<pre><code>bench_play_game_1_000_000
                        time:   [9.5865 ms 9.5968 ms 9.6087 ms]
Found 16 outliers among 100 measurements (16.00%)
  8 (8.00%) high mild
  8 (8.00%) high severe
</code></pre>
<p>ä»€éº¼ï¼<code>403.57 ns</code> x <code>1,000</code> æ‡‰è©²æ˜¯ <code>403,570 ns</code> è€Œä¸æ˜¯ <code>9,596,800 ns</code> (<code>9.5968 ms</code> x <code>1_000_000 ns/1 ms</code>) ğŸ¤¯ å„˜ç®¡æˆ‘çš„æ–æ³¢é‚£å¥‘æ•¸åˆ—ç¨‹å¼ç¢¼åŠŸèƒ½ä¸Šæ˜¯æ­£ç¢ºçš„ï¼Œæˆ‘å¿…é ˆåœ¨æŸå€‹åœ°æ–¹æœ‰ä¸€å€‹æ€§èƒ½bugã€‚</p>
<h2 id="ä¿®å¾©-rust-ä¸­çš„-fizzbuzzfibonacci"><a class="header" href="#ä¿®å¾©-rust-ä¸­çš„-fizzbuzzfibonacci">ä¿®å¾© Rust ä¸­çš„ FizzBuzzFibonacci</a></h2>
<p>è®“æˆ‘å€‘å†æ¬¡çœ‹ä¸€ä¸‹ <code>is_fibonacci_number</code> å‡½æ•¸ï¼š</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn is_fibonacci_number(n: u32) -&gt; bool {
    for i in 0..=n {
        let (mut previous, mut current) = (0, 1);
        while current &lt; i {
            let next = previous + current;
            previous = current;
            current = next;
        }
        if current == n {
            return true;
        }
    }
    false
}
<span class="boring">}</span></code></pre></pre>
<p>ç¾åœ¨æˆ‘åœ¨è€ƒæ…®æ€§èƒ½ï¼Œæˆ‘æ„è­˜åˆ°æˆ‘æœ‰ä¸€å€‹ä¸å¿…è¦çš„ï¼Œé¡å¤–çš„å¾ªç’°ã€‚ æˆ‘å€‘å¯ä»¥å®Œå…¨æ“ºè„« <code>for i in 0..=n {}</code> å¾ªç’°ï¼Œ åªéœ€ç›´æ¥æ¯”è¼ƒ <code>current</code> å€¼å’Œçµ¦å®šçš„æ•¸å­— (<code>n</code>) ğŸ¤¦</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn is_fibonacci_number(n: u32) -&gt; bool {
    let (mut previous, mut current) = (0, 1);
    while current &lt; n {
        let next = previous + current;
        previous = current;
        current = next;
    }
    current == n
}
<span class="boring">}</span></code></pre></pre>
<ul>
<li>æ›´æ–°æ‚¨çš„ <code>is_fibonacci_number</code> å‡½æ•¸ã€‚</li>
<li>ç”¨ <code>0</code> å’Œ <code>1</code> åˆå§‹åŒ–æˆ‘å€‘çš„æ–æ³¢é‚£å¥‘åºåˆ—ä½œç‚º <code>previous</code> å’Œ <code>current</code> æ•¸å­—ã€‚</li>
<li>ç•¶ <code>current</code> æ•¸å­—å°æ–¼ <em>çµ¦å®šæ•¸å­—</em> <code>n</code> æ™‚è¿­ä»£ã€‚</li>
<li>å°‡ <code>previous</code> å’Œ <code>current</code> æ•¸å­—ç›¸åŠ ä»¥ç²å¾— <code>next</code> æ•¸å­—ã€‚</li>
<li>æŠŠ <code>previous</code> æ•¸å­—æ›´æ–°ç‚º <code>current</code> æ•¸å­—ã€‚</li>
<li>æŠŠ <code>current</code> æ•¸å­—æ›´æ–°ç‚º <code>next</code> æ•¸å­—ã€‚</li>
<li>ä¸€æ—¦ <code>current</code> å¤§æ–¼æˆ–ç­‰æ–¼çµ¦å®šçš„æ•¸å­— <code>n</code>ï¼Œæˆ‘å€‘å°‡é€€å‡ºå¾ªç’°ã€‚</li>
<li>æª¢æŸ¥ <code>current</code> æ•¸å­—æ˜¯å¦ç­‰æ–¼çµ¦å®šçš„æ•¸å­— <code>n</code> ä¸¦è¿”å›è©²çµæœã€‚</li>
</ul>
<p>ç¾åœ¨ï¼Œè®“æˆ‘å€‘é‡æ–°é‹è¡Œé€™äº›åŸºæº–æ¸¬è©¦ï¼Œçœ‹çœ‹æˆ‘å€‘åšå¾—å¦‚ä½•ï¼š</p>
<pre><code>$ cargo bench
   Compiling playground v0.0.1 (/home/bencher)
    Finished bench [optimized] target(s) in 4.79s
     Running unittests src/main.rs (target/release/deps/game-68f58c96f4025bd4)

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

     Running unittests src/main.rs (target/release/deps/game-043972c4132076a9)

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

     Running benches/play_game.rs (target/release/deps/play_game-e0857103eb02eb56)
bench_play_game         time:   [3.1201 Âµs 3.1772 Âµs 3.2536 Âµs]
                        change: [-84.469% -84.286% -84.016%] (p = 0.00 &lt; 0.05)
                        Performance has improved.
Found 5 outliers among 100 measurements (5.00%)
  1 (1.00%) high mild
  4 (4.00%) high severe

bench_play_game_100     time:   [24.460 ns 24.555 ns 24.650 ns]
                        change: [-93.976% -93.950% -93.927%] (p = 0.00 &lt; 0.05)
                        Performance has improved.

bench_play_game_1_000_000
                        time:   [30.260 ns 30.403 ns 30.564 ns]
                        change: [-100.000% -100.000% -100.000%] (p = 0.00 &lt; 0.05)
                        Performance has improved.
Found 4 outliers among 100 measurements (4.00%)
  1 (1.00%) high mild
  3 (3.00%) high severe
</code></pre>
<p>å“¦å“‡ï¼æˆ‘å€‘çš„<code>bench_play_game</code>åŸºæº–æ¸¬è©¦å›è½åˆ°åŸä¾†FizzBuzzæ¸¬è©¦çš„é™„è¿‘ä½ç½®ã€‚ æˆ‘å¸Œæœ›æˆ‘èƒ½è¨˜ä½é‚£å€‹å¾—åˆ†æ˜¯å¤šå°‘ã€‚ä½†æ˜¯å·²ç¶“éäº†ä¸‰å€‹æ˜ŸæœŸäº†ã€‚ æˆ‘çš„çµ‚ç«¯æ­·å²è¨˜éŒ„æ²’æœ‰å›æº¯é€™éº¼é ã€‚ è€ŒCriterionåªæœƒå’Œæœ€è¿‘çš„çµæœé€²è¡Œæ¯”è¼ƒã€‚ ä½†æˆ‘èªç‚ºé€™æ˜¯å¾ˆæ¥è¿‘çš„ï¼</p>
<p><code>bench_play_game_100</code>åŸºæº–æ¸¬è©¦çš„çµæœä¸‹é™äº†è¿‘10å€ï¼Œ<code>-93.950%</code>ã€‚ å’Œ<code>bench_play_game_1_000_000</code>åŸºæº–æ¸¬è©¦çš„çµæœä¸‹é™äº†è¶…é10,000å€ï¼å¾<code>9,596,800 ns</code>é™åˆ°<code>30.403 ns</code>ï¼ æˆ‘å€‘ç”šè‡³è®“Criterionçš„æ”¹è®Šè¨ˆæ•¸å™¨é”åˆ°äº†æœ€å¤§å€¼ï¼Œå®ƒåªæœƒé”åˆ°<code>-100.000%</code>ï¼</p>
<blockquote>
<p>ğŸ° å˜¿ï¼Œè‡³å°‘æˆ‘å€‘åœ¨æ€§èƒ½bugè¶•åˆ°ç”Ÿç”¢ç’°å¢ƒä¹‹å‰æŠ“ä½äº†å®ƒâ€¦ å“¦ï¼Œå°äº†ã€‚ç®—äº†â€¦</p>
</blockquote>
<h2 id="åœ¨-ci-ä¸­æ•ç²æ€§èƒ½å›æ­¸"><a class="header" href="#åœ¨-ci-ä¸­æ•ç²æ€§èƒ½å›æ­¸">åœ¨ CI ä¸­æ•ç²æ€§èƒ½å›æ­¸</a></h2>
<p>ç”±æ–¼æˆ‘é‚£å€‹å°å°çš„æ€§èƒ½éŒ¯èª¤ï¼Œæˆ‘å€‘çš„éŠæˆ²æ”¶åˆ°äº†å¤§é‡çš„è² é¢è©•è«–ï¼Œé€™è®“é«˜ç®¡å€‘éå¸¸ä¸æ»¿ã€‚ ä»–å€‘å‘Šè¨´æˆ‘ä¸è¦è®“é€™ç¨®æƒ…æ³å†æ¬¡ç™¼ç”Ÿï¼Œè€Œç•¶æˆ‘è©¢å•å¦‚ä½•åšåˆ°æ™‚ï¼Œä»–å€‘åªæ˜¯å‘Šè¨´æˆ‘ä¸è¦å†çŠ¯ã€‚ æˆ‘è©²å¦‚ä½•ç®¡ç†é€™å€‹å•é¡Œå‘¢â€½</p>
<p>å¹¸é‹çš„æ˜¯ï¼Œæˆ‘æ‰¾åˆ°äº†é€™æ¬¾å«åš Bencher çš„è¶…æ£’é–‹æºå·¥å…·ã€‚ å®ƒæœ‰ä¸€å€‹éå¸¸æ…·æ…¨çš„å…è²»å±¤ï¼Œå› æ­¤æˆ‘å¯ä»¥åœ¨æˆ‘çš„å€‹äººé …ç›®ä¸­ä½¿ç”¨ <a href="https://bencher.dev/">Bencher Cloud</a>ã€‚ è€Œåœ¨å·¥ä½œä¸­éœ€è¦åœ¨æˆ‘å€‘çš„ç§æœ‰é›²å…§ï¼Œæˆ‘å·²ç¶“é–‹å§‹ä½¿ç”¨ <a href="https://bencher.dev/zh/docs/tutorial/docker/">Bencher Self-Hosted</a>ã€‚</p>
<p>Bencheræœ‰ä¸€å€‹<a href="https://bencher.dev/zh/docs/explanation/adapters/">å…§å»ºçš„ä»‹é¢å¡</a>ï¼Œ æ‰€ä»¥å¾ˆå®¹æ˜“æ•´åˆåˆ° CI ä¸­ã€‚åœ¨<a href="https://bencher.dev/zh/docs/tutorial/quick-start/">éµå¾ªå¿«é€Ÿé–‹å§‹æŒ‡å—</a>å¾Œï¼Œ æˆ‘èƒ½å¤ é‹è¡Œæˆ‘çš„åŸºæº–æ¸¬è©¦ä¸¦ç”¨ Bencher è¿½è¹¤å®ƒå€‘ã€‚</p>
<pre><code>$ bencher run --project game "cargo bench"
    Finished bench [optimized] target(s) in 0.07s
     Running unittests src/lib.rs (target/release/deps/game-13f4bad779fbfde4)

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

     Running unittests src/main.rs (target/release/deps/game-043972c4132076a9)

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

     Running benches/play_game.rs (target/release/deps/play_game-e0857103eb02eb56)
Gnuplot not found, using plotters backend
bench_play_game         time:   [3.0713 Âµs 3.0902 Âµs 3.1132 Âµs]
Found 16 outliers among 100 measurements (16.00%)
  3 (3.00%) high mild
  13 (13.00%) high severe

bench_play_game_100     time:   [23.938 ns 23.970 ns 24.009 ns]
Found 15 outliers among 100 measurements (15.00%)
  5 (5.00%) high mild
  10 (10.00%) high severe

bench_play_game_1_000_000
                        time:   [30.004 ns 30.127 ns 30.279 ns]
Found 5 outliers among 100 measurements (5.00%)
  1 (1.00%) high mild
  4 (4.00%) high severe

Bencher New Report:
...
View results:
- bench_play_game (Latency): https://bencher.dev/console/projects/game/perf?measures=52507e04-ffd9-4021-b141-7d4b9f1e9194&amp;branches=3a27b3ce-225c-4076-af7c-75adbc34ef9a&amp;testbeds=bc05ed88-74c1-430d-b96a-5394fdd18bb0&amp;benchmarks=077449e5-5b45-4c00-bdfb-3a277413180d&amp;start_time=1697224006000&amp;end_time=1699816009000&amp;upper_boundary=true
- bench_play_game_100 (Latency): https://bencher.dev/console/projects/game/perf?measures=52507e04-ffd9-4021-b141-7d4b9f1e9194&amp;branches=3a27b3ce-225c-4076-af7c-75adbc34ef9a&amp;testbeds=bc05ed88-74c1-430d-b96a-5394fdd18bb0&amp;benchmarks=96508869-4fa2-44ac-8e60-b635b83a17b7&amp;start_time=1697224006000&amp;end_time=1699816009000&amp;upper_boundary=true
- bench_play_game_1_000_000 (Latency): https://bencher.dev/console/projects/game/perf?measures=52507e04-ffd9-4021-b141-7d4b9f1e9194&amp;branches=3a27b3ce-225c-4076-af7c-75adbc34ef9a&amp;testbeds=bc05ed88-74c1-430d-b96a-5394fdd18bb0&amp;benchmarks=ff014217-4570-42ea-8813-6ed0284500a4&amp;start_time=1697224006000&amp;end_time=1699816009000&amp;upper_boundary=true
</code></pre>
<p>ä½¿ç”¨é€™å€‹ç”±ä¸€å€‹å‹å–„çš„å…”å­çµ¦æˆ‘çš„å·§å¦™çš„æ™‚é–“æ—…è¡Œè£ç½®ï¼Œ æˆ‘èƒ½å¤ å›åˆ°éå»ï¼Œé‡æ¼”å¦‚æœæˆ‘å€‘ä¸€ç›´éƒ½åœ¨ä½¿ç”¨Bencherçš„æƒ…æ³ä¸‹æœƒç™¼ç”Ÿä»€éº¼ã€‚ ä½ å¯ä»¥çœ‹åˆ°æˆ‘å€‘é¦–æ¬¡æ¨å‡ºå­˜åœ¨å•é¡Œçš„FizzBuzzFibonacciå¯¦ç¾çš„ä½ç½®ã€‚ æˆ‘é¦¬ä¸Šåœ¨æˆ‘çš„æ‹‰å–è«‹æ±‚è©•è«–ä¸­å¾—åˆ°äº†CIçš„å¤±æ•—è³‡è¨Šã€‚ å°±åœ¨é‚£å¤©ï¼Œæˆ‘ä¿®å¾©äº†æ€§èƒ½å•é¡Œï¼Œæ“ºè„«äº†é‚£ä¸å¿…è¦çš„é¡å¤–å¾ªç’°ã€‚ æ²’æœ‰ç«ç½ã€‚é¡§å®¢éƒ½éå¸¸é–‹å¿ƒã€‚</p>
<iframe title="å¦‚ä½•ç”¨Criterionå°Rusté€²è¡ŒåŸºæº–æ¸¬è©¦" width="100%" height="800px" src="https://bencher.dev/perf/game/embed?reports_per_page=4&amp;reports_page=1&amp;branches_per_page=8&amp;branches_page=1&amp;testbeds_per_page=8&amp;testbeds_page=1&amp;benchmarks_per_page=8&amp;benchmarks_page=1&amp;clear=true&amp;tab=benchmarks&amp;measures=52507e04-ffd9-4021-b141-7d4b9f1e9194&amp;branches=3a27b3ce-225c-4076-af7c-75adbc34ef9a&amp;testbeds=bc05ed88-74c1-430d-b96a-5394fdd18bb0&amp;benchmarks=077449e5-5b45-4c00-bdfb-3a277413180d&amp;upper_boundary=true&amp;start_time=1697414400000" style="box-sizing: inherit; margin: 0px; padding: 0px; border: 1rem solid rgb(237, 103, 4); color: rgb(74, 74, 74); font-family: BlinkMacSystemFont, -apple-system, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"></iframe>
<h2 id="bencher-æŒçºŒæ€§èƒ½åŸºæº–æ¸¬è©¦"><a class="header" href="#bencher-æŒçºŒæ€§èƒ½åŸºæº–æ¸¬è©¦"><a href="https://bencher.dev/pricing">Bencher</a>: æŒçºŒæ€§èƒ½åŸºæº–æ¸¬è©¦</a></h2>
<p><a href="https://bencher.dev/pricing"><img src="https://bencher.dev/wordmark.svg" alt="ğŸ° Bencher" /></a></p>
<p><a href="https://bencher.dev/pricing">Bencher</a>æ˜¯ä¸€å¥—æŒçºŒå‹çš„æ€§èƒ½åŸºæº–æ¸¬è©¦å·¥å…·ã€‚ ä½ æ˜¯å¦æ›¾ç¶“å› ç‚ºæ€§èƒ½å›æ­¸å½±éŸ¿åˆ°äº†ä½ çš„ä½¿ç”¨è€…ï¼Ÿ Bencherå¯ä»¥é˜²æ­¢é€™ç¨®æƒ…æ³çš„ç™¼ç”Ÿã€‚ Bencherè®“ä½ æœ‰èƒ½åŠ›åœ¨æ€§èƒ½å›æ­¸é€²å…¥ç”Ÿç”¢ç’°å¢ƒ <em>ä¹‹å‰</em> å°±é€²è¡Œæª¢æ¸¬å’Œé é˜²ã€‚</p>
<ul>
<li><strong>é‹è¡Œ</strong>: ä½¿ç”¨ä½ å–œæ„›çš„åŸºæº–æ¸¬è©¦å·¥å…·åœ¨æœ¬åœ°æˆ–CIä¸­åŸ·è¡Œä½ çš„åŸºæº–æ¸¬è©¦ã€‚<code>bencher</code> CLIç°¡å–®åœ°åŒ…è£äº†ä½ ç¾æœ‰çš„åŸºæº–æ¸¬é©—è£ç½®ä¸¦å„²å­˜å…¶çµæœã€‚</li>
<li><strong>è¿½è¹¤</strong>: è¿½è¹¤ä½ çš„åŸºæº–æ¸¬è©¦çµæœçš„è¶¨å‹¢ã€‚æ ¹æ“šæºåˆ†æ”¯ã€æ¸¬è©¦åºŠå’Œåº¦é‡ï¼Œä½¿ç”¨Bencher webæ§åˆ¶æª¯ä¾†ç›£è¦–ã€æŸ¥è©¢å’Œç¹ªè£½çµæœåœ–è¡¨ã€‚</li>
<li><strong>æ•ç²</strong>: åœ¨CIä¸­æ•ç²æ€§èƒ½å›æ­¸ã€‚Bencherä½¿ç”¨æœ€å…ˆé€²çš„ã€å¯å®šè£½çš„åˆ†ææŠ€è¡“åœ¨å®ƒå€‘é€²å…¥ç”Ÿç”¢ç’°å¢ƒä¹‹å‰å°±æª¢æ¸¬åˆ°æ€§èƒ½å›æ­¸ã€‚</li>
</ul>
<p>åŸºæ–¼é˜²æ­¢åŠŸèƒ½å›æ­¸çš„åŸå› ï¼Œåœ¨CIä¸­é‹è¡Œå–®å…ƒæ¸¬è©¦ï¼Œæˆ‘å€‘ä¹Ÿæ‡‰è©²ä½¿ç”¨Bencheråœ¨CIä¸­é‹è¡ŒåŸºæº–æ¸¬è©¦ä»¥é˜²æ­¢æ€§èƒ½å›æ­¸ã€‚æ€§èƒ½å•é¡Œå°±æ˜¯éŒ¯èª¤ï¼</p>
<p>é–‹å§‹åœ¨CIä¸­æ•æ‰æ€§èƒ½å›æ­¸ â€” <a href="https://bencher.dev/pricing">å…è²»è©¦ç”¨Bencher Cloud</a>ã€‚</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../rust/é«˜é »äº¤æ˜“Rustçµ‚æ¥µæ•ˆèƒ½å„ªåŒ–æŒ‡å—.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../rust/rust-wasm-compilation-guide.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../rust/é«˜é »äº¤æ˜“Rustçµ‚æ¥µæ•ˆèƒ½å„ªåŒ–æŒ‡å—.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../rust/rust-wasm-compilation-guide.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="../ace.js"></script>
        <script src="../mode-rust.js"></script>
        <script src="../editor.js"></script>
        <script src="../theme-dawn.js"></script>
        <script src="../theme-tomorrow_night.js"></script>

        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../mermaid.min.js"></script>
        <script src="../mermaid-init.js"></script>



    </div>
    </body>
</html>
