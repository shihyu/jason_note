<!DOCTYPE HTML>
<html lang="zh" class="rust sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>ä¸¦ç™¼ç·¨ç¨‹æŒ‡å— - Jason&#x27;s Notes</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "rust";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>â†</kbd> or <kbd>â†’</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Jason&#x27;s Notes</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/shihyu/jason_note" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="python-ä¸¦ç™¼ç·¨ç¨‹å®Œæ•´æŒ‡å—"><a class="header" href="#python-ä¸¦ç™¼ç·¨ç¨‹å®Œæ•´æŒ‡å—">Python ä¸¦ç™¼ç·¨ç¨‹å®Œæ•´æŒ‡å—</a></h1>
<h2 id="ç›®éŒ„"><a class="header" href="#ç›®éŒ„">ç›®éŒ„</a></h2>
<ol>
<li><a href="#%E5%9F%BA%E7%A4%8E%E6%A6%82%E5%BF%B5%E5%9F%B7%E8%A1%8C%E7%B7%92%E8%88%87%E9%80%B2%E7%A8%8B">åŸºç¤æ¦‚å¿µï¼šåŸ·è¡Œç·’èˆ‡é€²ç¨‹</a></li>
<li><a href="#cpu-%E5%AF%86%E9%9B%86%E5%9E%8B-vs-io-%E5%AF%86%E9%9B%86%E5%9E%8B%E4%BB%BB%E5%8B%99">CPU å¯†é›†å‹ vs I/O å¯†é›†å‹ä»»å‹™</a></li>
<li><a href="#threadpoolexecutor-%E8%A9%B3%E8%A7%A3">ThreadPoolExecutor è©³è§£</a></li>
<li><a href="#threadpoolexecutor-vs-asyncio">ThreadPoolExecutor vs asyncio</a></li>
</ol>
<hr />
<h2 id="åŸºç¤æ¦‚å¿µåŸ·è¡Œç·’èˆ‡é€²ç¨‹"><a class="header" href="#åŸºç¤æ¦‚å¿µåŸ·è¡Œç·’èˆ‡é€²ç¨‹">åŸºç¤æ¦‚å¿µï¼šåŸ·è¡Œç·’èˆ‡é€²ç¨‹</a></h2>
<h3 id="ä»€éº¼æ˜¯åŸ·è¡Œç·’thread"><a class="header" href="#ä»€éº¼æ˜¯åŸ·è¡Œç·’thread">ä»€éº¼æ˜¯åŸ·è¡Œç·’ï¼ˆThreadï¼‰ï¼Ÿ</a></h3>
<p><strong>åŸ·è¡Œç·’ï¼ˆThreadï¼‰æ˜¯ç¨‹å¼åŸ·è¡Œçš„æœ€å°å–®ä½</strong>ã€‚ç•¶ä½œæ¥­ç³»çµ±é‹è¡Œç¨‹å¼æ™‚ï¼Œæœƒå°‡æ¯å€‹ç¨‹å¼è¦–ç‚ºä¸€å€‹ã€Œé€²ç¨‹ï¼ˆProcessï¼‰ã€ï¼Œè€Œæ¯å€‹é€²ç¨‹å…§éƒ¨å¯ä»¥æœ‰ä¸€å€‹æˆ–å¤šå€‹åŸ·è¡Œç·’ä¾†è² è²¬åŸ·è¡Œä¸åŒçš„å·¥ä½œã€‚</p>
<h4 id="å–®åŸ·è¡Œç·’ç¯„ä¾‹"><a class="header" href="#å–®åŸ·è¡Œç·’ç¯„ä¾‹">å–®åŸ·è¡Œç·’ç¯„ä¾‹</a></h4>
<pre><code class="language-python">import time

def task1():
    print("ğŸ”„ ä»»å‹™ 1 é–‹å§‹åŸ·è¡Œ")
    time.sleep(3)  # æ¨¡æ“¬ 3 ç§’çš„å·¥ä½œæ™‚é–“
    print("âœ… ä»»å‹™ 1 å®Œæˆ")

def task2():
    print("ğŸ”„ ä»»å‹™ 2 é–‹å§‹åŸ·è¡Œ")
    time.sleep(2)  # æ¨¡æ“¬ 2 ç§’çš„å·¥ä½œæ™‚é–“
    print("âœ… ä»»å‹™ 2 å®Œæˆ")

print("ğŸš€ é–‹å§‹åŸ·è¡Œç¨‹å¼")
task1()
task2()
print("ğŸ‰ æ‰€æœ‰ä»»å‹™å®Œæˆ")
</code></pre>
<p><strong>åŸ·è¡Œçµæœï¼š</strong></p>
<ul>
<li>ç¸½åŸ·è¡Œæ™‚é–“ï¼š5 ç§’</li>
<li>task1() åŸ·è¡Œå®Œå¾Œï¼Œtask2() æ‰é–‹å§‹åŸ·è¡Œ</li>
</ul>
<h4 id="å¤šåŸ·è¡Œç·’ç¯„ä¾‹"><a class="header" href="#å¤šåŸ·è¡Œç·’ç¯„ä¾‹">å¤šåŸ·è¡Œç·’ç¯„ä¾‹</a></h4>
<pre><code class="language-python">import threading
import time

def task1():
    print("ğŸ”„ ä»»å‹™ 1ï¼ˆåŸ·è¡Œç·’ 1ï¼‰é–‹å§‹åŸ·è¡Œ")
    time.sleep(3)
    print("âœ… ä»»å‹™ 1ï¼ˆåŸ·è¡Œç·’ 1ï¼‰å®Œæˆ")

def task2():
    print("ğŸ”„ ä»»å‹™ 2ï¼ˆåŸ·è¡Œç·’ 2ï¼‰é–‹å§‹åŸ·è¡Œ")
    time.sleep(2)
    print("âœ… ä»»å‹™ 2ï¼ˆåŸ·è¡Œç·’ 2ï¼‰å®Œæˆ")

print("ğŸš€ é–‹å§‹åŸ·è¡Œç¨‹å¼")

# å‰µå»ºå…©å€‹åŸ·è¡Œç·’
thread1 = threading.Thread(target=task1)
thread2 = threading.Thread(target=task2)

# å•Ÿå‹•åŸ·è¡Œç·’
thread1.start()
thread2.start()

# ç­‰å¾…åŸ·è¡Œç·’åŸ·è¡Œå®Œç•¢
thread1.join()
thread2.join()

print("ğŸ‰ æ‰€æœ‰ä»»å‹™å®Œæˆ")
</code></pre>
<p><strong>åŸ·è¡Œçµæœï¼š</strong></p>
<ul>
<li>ç¸½åŸ·è¡Œæ™‚é–“ï¼š3 ç§’ï¼ˆæ¯”å–®åŸ·è¡Œç·’å¿« 2 ç§’ï¼‰</li>
<li>task1() å’Œ task2() åŒæ™‚åŸ·è¡Œ</li>
</ul>
<h3 id="é€²ç¨‹-vs-åŸ·è¡Œç·’æ¯”è¼ƒ"><a class="header" href="#é€²ç¨‹-vs-åŸ·è¡Œç·’æ¯”è¼ƒ">é€²ç¨‹ vs åŸ·è¡Œç·’æ¯”è¼ƒ</a></h3>
<div class="table-wrapper"><table><thead><tr><th>é¡åˆ¥</th><th>é€²ç¨‹ï¼ˆProcessï¼‰</th><th>åŸ·è¡Œç·’ï¼ˆThreadï¼‰</th></tr></thead><tbody>
<tr><td><strong>å®šç¾©</strong></td><td>ç¨‹å¼çš„åŸ·è¡Œå¯¦é«”</td><td>é€²ç¨‹å…§çš„åŸ·è¡Œå–®ä½</td></tr>
<tr><td><strong>è¨˜æ†¶é«”</strong></td><td>ä¸å…±äº«è¨˜æ†¶é«”</td><td>å…±äº«è¨˜æ†¶é«”</td></tr>
<tr><td><strong>å»ºç«‹æˆæœ¬</strong></td><td>é«˜ï¼ˆéœ€è¦ç¨ç«‹è¨˜æ†¶é«”ï¼‰</td><td>ä½ï¼ˆå…±ç”¨é€²ç¨‹è³‡æºï¼‰</td></tr>
<tr><td><strong>é©ç”¨å ´æ™¯</strong></td><td>CPU å¯†é›†å‹ï¼ˆå½±åƒè™•ç†ã€æ•¸æ“šè¨ˆç®—ï¼‰</td><td>I/O å¯†é›†å‹ï¼ˆAPI è«‹æ±‚ã€çˆ¬èŸ²ï¼‰</td></tr>
</tbody></table>
</div>
<h3 id="python-å¯¦ä½œç¯„ä¾‹"><a class="header" href="#python-å¯¦ä½œç¯„ä¾‹">Python å¯¦ä½œç¯„ä¾‹</a></h3>
<h4 id="é€²ç¨‹ç¯„ä¾‹ä½¿ç”¨-multiprocessing"><a class="header" href="#é€²ç¨‹ç¯„ä¾‹ä½¿ç”¨-multiprocessing">é€²ç¨‹ç¯„ä¾‹ï¼ˆä½¿ç”¨ multiprocessingï¼‰</a></h4>
<pre><code class="language-python">from multiprocessing import Process
import time

def task(name):
    print(f"ğŸ”„ é€²ç¨‹ {name} é–‹å§‹åŸ·è¡Œ")
    time.sleep(2)
    print(f"âœ… é€²ç¨‹ {name} å®Œæˆ")

if __name__ == "__main__":
    process1 = Process(target=task, args=("P1",))
    process2 = Process(target=task, args=("P2",))
    
    process1.start()
    process2.start()
    
    process1.join()
    process2.join()
    
    print("ğŸ‰ æ‰€æœ‰é€²ç¨‹å®Œæˆ")
</code></pre>
<h4 id="åŸ·è¡Œç·’ç¯„ä¾‹ä½¿ç”¨-threading"><a class="header" href="#åŸ·è¡Œç·’ç¯„ä¾‹ä½¿ç”¨-threading">åŸ·è¡Œç·’ç¯„ä¾‹ï¼ˆä½¿ç”¨ threadingï¼‰</a></h4>
<pre><code class="language-python">import threading
import time

def task(name):
    print(f"ğŸ”„ åŸ·è¡Œç·’ {name} é–‹å§‹åŸ·è¡Œ")
    time.sleep(2)
    print(f"âœ… åŸ·è¡Œç·’ {name} å®Œæˆ")

thread1 = threading.Thread(target=task, args=("T1",))
thread2 = threading.Thread(target=task, args=("T2",))

thread1.start()
thread2.start()

thread1.join()
thread2.join()

print("ğŸ‰ æ‰€æœ‰åŸ·è¡Œç·’å®Œæˆ")
</code></pre>
<h3 id="çœŸå¯¦ä¸–ç•Œçš„æ‡‰ç”¨æ¡ˆä¾‹"><a class="header" href="#çœŸå¯¦ä¸–ç•Œçš„æ‡‰ç”¨æ¡ˆä¾‹">çœŸå¯¦ä¸–ç•Œçš„æ‡‰ç”¨æ¡ˆä¾‹</a></h3>
<div class="table-wrapper"><table><thead><tr><th>æ‡‰ç”¨ç¨‹å¼</th><th>é€²ç¨‹ï¼ˆProcessï¼‰</th><th>åŸ·è¡Œç·’ï¼ˆThreadï¼‰</th></tr></thead><tbody>
<tr><td><strong>Google Chrome</strong></td><td>æ¯å€‹åˆ†é æ˜¯ç¨ç«‹é€²ç¨‹</td><td>åˆ†é å…§çš„ JavaScriptã€å½±ç‰‡æ’­æ”¾ç­‰</td></tr>
<tr><td><strong>VS Code</strong></td><td>ä¸»ç¨‹å¼æ˜¯ä¸€å€‹é€²ç¨‹</td><td>èªæ³•åˆ†æã€æ’ä»¶é‹è¡Œç­‰</td></tr>
<tr><td><strong>éŠæˆ²ï¼ˆå¦‚ GTA 5ï¼‰</strong></td><td>éŠæˆ²æœ¬é«”æ˜¯é€²ç¨‹</td><td>æ¸²æŸ“ã€ç‰©ç†è¨ˆç®—ã€AI è¡Œç‚º</td></tr>
<tr><td><strong>éŸ³æ¨‚æ’­æ”¾å™¨ï¼ˆSpotifyï¼‰</strong></td><td>æ’­æ”¾å™¨æ˜¯é€²ç¨‹</td><td>ä¸‹è¼‰éŸ³æ¨‚ã€æ’­æ”¾ã€UI é¡¯ç¤º</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="cpu-å¯†é›†å‹-vs-io-å¯†é›†å‹ä»»å‹™"><a class="header" href="#cpu-å¯†é›†å‹-vs-io-å¯†é›†å‹ä»»å‹™">CPU å¯†é›†å‹ vs I/O å¯†é›†å‹ä»»å‹™</a></h2>
<h3 id="ä»€éº¼æ˜¯-cpu-å¯†é›†å‹cpu-bound"><a class="header" href="#ä»€éº¼æ˜¯-cpu-å¯†é›†å‹cpu-bound">ä»€éº¼æ˜¯ CPU å¯†é›†å‹ï¼ˆCPU-Boundï¼‰ï¼Ÿ</a></h3>
<p>CPU é‹ç®—æŒ‡çš„æ˜¯ç¨‹å¼åŸ·è¡Œé€Ÿåº¦å—é™æ–¼ CPU çš„é‹ç®—èƒ½åŠ›ï¼Œé€™é¡é‹ç®—é€šå¸¸éœ€è¦å¤§é‡è¨ˆç®—ã€‚</p>
<p><strong>å¸¸è¦‹å ´æ™¯ï¼š</strong></p>
<ul>
<li>æ©Ÿå™¨å­¸ç¿’èˆ‡æ·±åº¦å­¸ç¿’è¨“ç·´</li>
<li>å½±åƒè™•ç†ï¼ˆå¦‚ Photoshop æ¿¾é¡ï¼‰</li>
<li>æ•¸å­¸è¨ˆç®—ï¼ˆçŸ©é™£é‹ç®—ã€å¤§é‡è¿´åœˆï¼‰</li>
<li>æ•¸æ“šåˆ†æèˆ‡çµ±è¨ˆé‹ç®—</li>
</ul>
<p>ğŸ“Œ **é©åˆä½¿ç”¨å¤šé€²ç¨‹ï¼ˆMultiprocessingï¼‰**ä¾†å……åˆ†åˆ©ç”¨å¤šæ ¸å¿ƒ CPUã€‚</p>
<h3 id="ä»€éº¼æ˜¯-io-å¯†é›†å‹io-bound"><a class="header" href="#ä»€éº¼æ˜¯-io-å¯†é›†å‹io-bound">ä»€éº¼æ˜¯ I/O å¯†é›†å‹ï¼ˆI/O-Boundï¼‰ï¼Ÿ</a></h3>
<p>I/O æ“ä½œæŒ‡çš„æ˜¯ç¨‹å¼åŸ·è¡Œé€Ÿåº¦å—é™æ–¼å¤–éƒ¨è¨­å‚™ï¼ˆç¶²è·¯ã€ç¡¬ç¢Ÿã€è³‡æ–™åº«ï¼‰çš„å­˜å–é€Ÿåº¦ã€‚</p>
<p><strong>å¸¸è¦‹å ´æ™¯ï¼š</strong></p>
<ul>
<li>è®€å–æˆ–å¯«å…¥æª”æ¡ˆ</li>
<li>ç™¼é€ API è«‹æ±‚</li>
<li>å­˜å–è³‡æ–™åº«</li>
<li>ç¶²é çˆ¬èŸ²</li>
</ul>
<p>ğŸ“Œ **é©åˆä½¿ç”¨å¤šåŸ·è¡Œç·’ï¼ˆThreadingï¼‰**ä¾†åŒæ™‚åŸ·è¡Œå¤šå€‹ I/O ä»»å‹™ã€‚</p>
<h3 id="threadpoolexecutor-vs-processpoolexecutor"><a class="header" href="#threadpoolexecutor-vs-processpoolexecutor">ThreadPoolExecutor vs ProcessPoolExecutor</a></h3>
<div class="table-wrapper"><table><thead><tr><th>åŠŸèƒ½</th><th>ThreadPoolExecutor</th><th>ProcessPoolExecutor</th></tr></thead><tbody>
<tr><td><strong>é©ç”¨å ´æ™¯</strong></td><td>I/O å¯†é›†å‹ï¼ˆAPIã€çˆ¬èŸ²ã€æª”æ¡ˆè®€å¯«ï¼‰</td><td>CPU å¯†é›†å‹ï¼ˆæ•¸æ“šè¨ˆç®—ã€å½±åƒè™•ç†ï¼‰</td></tr>
<tr><td><strong>è³‡æºä½¿ç”¨</strong></td><td>å¤šåŸ·è¡Œç·’ï¼ˆå…±äº«è¨˜æ†¶é«”ï¼‰</td><td>å¤šé€²ç¨‹ï¼ˆç¨ç«‹è¨˜æ†¶é«”ï¼‰</td></tr>
<tr><td><strong>GIL é™åˆ¶</strong></td><td>æ˜¯ï¼ˆPython GIL é™åˆ¶ï¼‰</td><td>å¦ï¼ˆæ¯å€‹é€²ç¨‹æœ‰ç¨ç«‹è§£é‡‹å™¨ï¼‰</td></tr>
<tr><td><strong>é–‹éŠ·</strong></td><td>ä½ï¼ˆåŸ·è¡Œç·’åˆ‡æ›å¿«ï¼‰</td><td>é«˜ï¼ˆéœ€è¦é¡å¤–è¨˜æ†¶é«”ï¼‰</td></tr>
</tbody></table>
</div>
<h3 id="å¯¦ä½œç¯„ä¾‹"><a class="header" href="#å¯¦ä½œç¯„ä¾‹">å¯¦ä½œç¯„ä¾‹</a></h3>
<h4 id="io-å¯†é›†å‹ä½¿ç”¨-threadpoolexecutor"><a class="header" href="#io-å¯†é›†å‹ä½¿ç”¨-threadpoolexecutor">I/O å¯†é›†å‹ï¼šä½¿ç”¨ ThreadPoolExecutor</a></h4>
<pre><code class="language-python">from concurrent.futures import ThreadPoolExecutor
import requests

URLS = [
    "https://jsonplaceholder.typicode.com/todos/1",
    "https://jsonplaceholder.typicode.com/todos/2"
]

def fetch_data(url):
    response = requests.get(url)
    return response.json()

with ThreadPoolExecutor(max_workers=2) as executor:
    results = list(executor.map(fetch_data, URLS))
    print(results)  # åŒæ™‚ç™¼é€ API è«‹æ±‚
</code></pre>
<h4 id="cpu-å¯†é›†å‹ä½¿ç”¨-processpoolexecutor"><a class="header" href="#cpu-å¯†é›†å‹ä½¿ç”¨-processpoolexecutor">CPU å¯†é›†å‹ï¼šä½¿ç”¨ ProcessPoolExecutor</a></h4>
<pre><code class="language-python">from concurrent.futures import ProcessPoolExecutor

def compute(n):
    return sum(i**2 for i in range(n))

numbers = [10**6, 10**6, 10**6]

with ProcessPoolExecutor(max_workers=3) as executor:
    results = list(executor.map(compute, numbers))
    print(results)  # ä½¿ç”¨å¤šæ ¸å¿ƒ CPU è¨ˆç®—
</code></pre>
<hr />
<h2 id="threadpoolexecutor-è©³è§£"><a class="header" href="#threadpoolexecutor-è©³è§£">ThreadPoolExecutor è©³è§£</a></h2>
<h3 id="ä»€éº¼æ˜¯-threadpoolexecutor"><a class="header" href="#ä»€éº¼æ˜¯-threadpoolexecutor">ä»€éº¼æ˜¯ ThreadPoolExecutorï¼Ÿ</a></h3>
<p><code>ThreadPoolExecutor</code> æ˜¯ Python <code>concurrent.futures</code> æ¨¡çµ„çš„ä¸€éƒ¨åˆ†ï¼Œæä¾›ç®¡ç†åŸ·è¡Œç·’æ± ï¼ˆThread Poolï¼‰çš„æ–¹å¼ï¼Œè®“ç¨‹å¼èƒ½å¤ æ›´å¿«åœ°è™•ç†å¤§é‡ I/O æ“ä½œã€‚</p>
<h3 id="åŸºæœ¬ç”¨æ³•"><a class="header" href="#åŸºæœ¬ç”¨æ³•">åŸºæœ¬ç”¨æ³•</a></h3>
<pre><code class="language-python">from concurrent.futures import ThreadPoolExecutor
import time

def task(n):
    """æ¨¡æ“¬ä¸€å€‹éœ€è¦ 2 ç§’çš„å·¥ä½œ"""
    print(f"ğŸ”„ ä»»å‹™ {n} é–‹å§‹åŸ·è¡Œ")
    time.sleep(2)
    print(f"âœ… ä»»å‹™ {n} å®Œæˆ")
    return f"ä»»å‹™ {n} çš„çµæœ"

# å»ºç«‹åŸ·è¡Œç·’æ± ï¼Œæœ€å¤šå…è¨± 3 å€‹åŸ·è¡Œç·’åŒæ™‚é‹è¡Œ
with ThreadPoolExecutor(max_workers=3) as executor:
    results = list(executor.map(task, range(5)))  # åŸ·è¡Œ 5 å€‹ä»»å‹™
    print(results)
</code></pre>
<h3 id="submit-vs-map-çš„å·®ç•°"><a class="header" href="#submit-vs-map-çš„å·®ç•°">submit() vs map() çš„å·®ç•°</a></h3>
<div class="table-wrapper"><table><thead><tr><th>åŠŸèƒ½</th><th>submit()</th><th>map()</th></tr></thead><tbody>
<tr><td><strong>æäº¤æ–¹å¼</strong></td><td>é€å€‹æäº¤ï¼ˆå–®æ¬¡è™•ç†å–®ä¸€ä»»å‹™ï¼‰</td><td>æ‰¹é‡æäº¤ï¼ˆå–®æ¬¡è™•ç†å¤šå€‹ä»»å‹™ï¼‰</td></tr>
<tr><td><strong>å›å‚³å€¼</strong></td><td>Future ç‰©ä»¶ï¼ˆéœ€ .result() å–å¾—ï¼‰</td><td>ç›´æ¥å›å‚³çµæœåˆ—è¡¨</td></tr>
<tr><td><strong>é©ç”¨å ´æ™¯</strong></td><td>éœ€è¦é€æ­¥è™•ç†çµæœã€éŒ¯èª¤è™•ç†</td><td>å–®è¼¸å…¥å°æ‡‰å–®è¼¸å‡ºçš„æ‰¹é‡è™•ç†</td></tr>
<tr><td><strong>éŒ¯èª¤è™•ç†</strong></td><td>æ›´éˆæ´»ï¼Œå¯å–®ç¨æ•æ‰éŒ¯èª¤</td><td>ä¸€å€‹ä»»å‹™å¤±æ•—æœƒä¸­æ–·æ•´å€‹ map()</td></tr>
</tbody></table>
</div>
<h4 id="submit-ç¯„ä¾‹"><a class="header" href="#submit-ç¯„ä¾‹">submit() ç¯„ä¾‹</a></h4>
<pre><code class="language-python">from concurrent.futures import ThreadPoolExecutor

def square(n):
    return n * n

with ThreadPoolExecutor(max_workers=3) as executor:
    future1 = executor.submit(square, 2)
    future2 = executor.submit(square, 3)
    
    print(future1.result())  # 4
    print(future2.result())  # 9
</code></pre>
<h4 id="submit-éŒ¯èª¤è™•ç†"><a class="header" href="#submit-éŒ¯èª¤è™•ç†">submit() éŒ¯èª¤è™•ç†</a></h4>
<pre><code class="language-python">def divide(n, d):
    if d == 0:
        raise ValueError("âŒ é™¤æ•¸ä¸èƒ½ç‚º 0")
    return n / d

with ThreadPoolExecutor(max_workers=3) as executor:
    futures = [executor.submit(divide, 10, i) for i in range(3)]
    
    for future in futures:
        try:
            print(future.result())
        except Exception as e:
            print(f"âš ï¸ éŒ¯èª¤: {e}")
</code></pre>
<h4 id="map-ç¯„ä¾‹"><a class="header" href="#map-ç¯„ä¾‹">map() ç¯„ä¾‹</a></h4>
<pre><code class="language-python">def square(n):
    return n * n

with ThreadPoolExecutor(max_workers=3) as executor:
    results = executor.map(square, [1, 2, 3, 4, 5])
    print(list(results))  # [1, 4, 9, 16, 25]
</code></pre>
<h3 id="threadpoolexecutor-æ‡‰ç”¨å ´æ™¯"><a class="header" href="#threadpoolexecutor-æ‡‰ç”¨å ´æ™¯">ThreadPoolExecutor æ‡‰ç”¨å ´æ™¯</a></h3>
<div class="table-wrapper"><table><thead><tr><th>æ‡‰ç”¨å ´æ™¯</th><th>ç‚ºä»€éº¼é©åˆ</th><th>ç¤ºä¾‹æ‡‰ç”¨</th></tr></thead><tbody>
<tr><td><strong>API è«‹æ±‚</strong></td><td>åŒæ™‚ç™¼é€å¤šå€‹è«‹æ±‚ï¼Œæé«˜æ•ˆç‡</td><td>OpenAI APIã€å¤©æ°£æŸ¥è©¢</td></tr>
<tr><td><strong>ç¶²è·¯çˆ¬èŸ²</strong></td><td>åŒæ™‚çˆ¬å–å¤šå€‹ç¶²é </td><td>æ–°èçˆ¬å–ã€æ‰¹é‡ä¸‹è¼‰</td></tr>
<tr><td><strong>æª”æ¡ˆ I/O</strong></td><td>åŒæ™‚è™•ç†å¤šå€‹æ–‡ä»¶</td><td>æ—¥èªŒåˆ†æã€æ ¼å¼è½‰æ›</td></tr>
<tr><td><strong>èƒŒæ™¯ä»»å‹™</strong></td><td>ä¸å½±éŸ¿ä¸»æµç¨‹</td><td>è‡ªå‹•å‚™ä»½ã€æ•¸æ“šåŒæ­¥</td></tr>
</tbody></table>
</div>
<h3 id="å¯¦æˆ°æ‡‰ç”¨"><a class="header" href="#å¯¦æˆ°æ‡‰ç”¨">å¯¦æˆ°æ‡‰ç”¨</a></h3>
<h4 id="åŒæ™‚ç™¼é€å¤šå€‹-api-è«‹æ±‚"><a class="header" href="#åŒæ™‚ç™¼é€å¤šå€‹-api-è«‹æ±‚">åŒæ™‚ç™¼é€å¤šå€‹ API è«‹æ±‚</a></h4>
<pre><code class="language-python">from concurrent.futures import ThreadPoolExecutor
import requests

API_URLS = [
    "https://jsonplaceholder.typicode.com/todos/1",
    "https://jsonplaceholder.typicode.com/todos/2",
    "https://jsonplaceholder.typicode.com/todos/3"
]

def fetch_data(url):
    response = requests.get(url)
    return response.json()

with ThreadPoolExecutor(max_workers=3) as executor:
    results = list(executor.map(fetch_data, API_URLS))
    print(results)
</code></pre>
<h4 id="æ‰¹é‡è™•ç†æª”æ¡ˆ"><a class="header" href="#æ‰¹é‡è™•ç†æª”æ¡ˆ">æ‰¹é‡è™•ç†æª”æ¡ˆ</a></h4>
<pre><code class="language-python">from concurrent.futures import ThreadPoolExecutor

def read_file(file_path):
    with open(file_path, "r", encoding="utf-8") as file:
        return file.read()

files = ["file1.txt", "file2.txt", "file3.txt"]

with ThreadPoolExecutor(max_workers=3) as executor:
    contents = list(executor.map(read_file, files))
    print(contents)
</code></pre>
<h3 id="æœ€ä½³å¯¦è¸"><a class="header" href="#æœ€ä½³å¯¦è¸">æœ€ä½³å¯¦è¸</a></h3>
<ol>
<li><strong>æ§åˆ¶ max_workers</strong>ï¼šé€šå¸¸è¨­ç‚º CPU æ ¸å¿ƒæ•¸ * 2</li>
<li><strong>ä½¿ç”¨ submit() è™•ç†å›å‚³å€¼</strong>ï¼šéœ€è¦ç²å–çµæœæ™‚æ›´éˆæ´»</li>
<li><strong>ç¢ºä¿ä½¿ç”¨ with èªæ³•</strong>ï¼šè‡ªå‹•é—œé–‰åŸ·è¡Œç·’æ± ï¼Œé¿å…è³‡æºæµªè²»</li>
</ol>
<h3 id="æ½›åœ¨å•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆ"><a class="header" href="#æ½›åœ¨å•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆ">æ½›åœ¨å•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆ</a></h3>
<div class="table-wrapper"><table><thead><tr><th>å•é¡Œ</th><th>è§£æ±ºæ–¹æ¡ˆ</th></tr></thead><tbody>
<tr><td>å¤§é‡åŸ·è¡Œç·’å°è‡´è¨˜æ†¶é«”è€—ç›¡</td><td>é©ç•¶é™åˆ¶ max_workers</td></tr>
<tr><td>å…±äº«è®Šæ•¸çš„ Race Condition</td><td>ä½¿ç”¨ threading.Lock() ä¿è­·</td></tr>
<tr><td>ç¶²è·¯è«‹æ±‚ç•°å¸¸ï¼ˆå¦‚è¶…æ™‚ï¼‰</td><td>ä½¿ç”¨ try-except æ•æ‰éŒ¯èª¤</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="threadpoolexecutor-vs-asyncio"><a class="header" href="#threadpoolexecutor-vs-asyncio">ThreadPoolExecutor vs asyncio</a></h2>
<h3 id="å…©ç¨®ä¸¦ç™¼æ–¹å¼çš„æ¯”è¼ƒ"><a class="header" href="#å…©ç¨®ä¸¦ç™¼æ–¹å¼çš„æ¯”è¼ƒ">å…©ç¨®ä¸¦ç™¼æ–¹å¼çš„æ¯”è¼ƒ</a></h3>
<p>Python æä¾›å…©ç¨®æ–¹å¼ä¾†æé«˜ I/O æ“ä½œæ•ˆç‡ï¼š</p>
<ol>
<li><strong>å¤šåŸ·è¡Œç·’ï¼ˆThreadingï¼‰</strong>ï¼šä½¿ç”¨ <code>ThreadPoolExecutor</code> ä¸¦è¡ŒåŸ·è¡ŒåŒæ­¥å‡½å¼</li>
<li><strong>éåŒæ­¥ï¼ˆAsynchronousï¼‰</strong>ï¼šä½¿ç”¨ <code>asyncio</code> éåŒæ­¥åŸ·è¡Œæ”¯æ´ async çš„å‡½å¼</li>
</ol>
<h3 id="æ ¸å¿ƒå·®ç•°"><a class="header" href="#æ ¸å¿ƒå·®ç•°">æ ¸å¿ƒå·®ç•°</a></h3>
<div class="table-wrapper"><table><thead><tr><th>ç‰¹æ€§</th><th>ThreadPoolExecutor</th><th>asyncio</th></tr></thead><tbody>
<tr><td><strong>ä¸¦è¡Œæ–¹å¼</strong></td><td>å¤šå€‹åŸ·è¡Œç·’</td><td>å–®åŸ·è¡Œç·’ + äº‹ä»¶è¿´åœˆ</td></tr>
<tr><td><strong>é©åˆå ´æ™¯</strong></td><td>åŒæ­¥ I/Oï¼ˆrequestsã€æª”æ¡ˆè®€å¯«ï¼‰</td><td>æ”¯æ´ async çš„å‡½å¼ï¼ˆaiohttpï¼‰</td></tr>
<tr><td><strong>GIL é™åˆ¶</strong></td><td>æ˜¯ï¼ˆä½† I/O å½±éŸ¿ä¸å¤§ï¼‰</td><td>å¦ï¼ˆéåŒæ­¥è™•ç†ï¼‰</td></tr>
<tr><td><strong>CPU å¯†é›†å‹</strong></td><td>âŒ ä¸é©åˆ</td><td>âŒ ä¸é©åˆ</td></tr>
</tbody></table>
</div>
<h3 id="threadpoolexecutor-ç¯„ä¾‹"><a class="header" href="#threadpoolexecutor-ç¯„ä¾‹">ThreadPoolExecutor ç¯„ä¾‹</a></h3>
<pre><code class="language-python">import requests
from concurrent.futures import ThreadPoolExecutor
import time

URLS = [
    "https://jsonplaceholder.typicode.com/todos/1",
    "https://jsonplaceholder.typicode.com/todos/2",
    "https://jsonplaceholder.typicode.com/todos/3",
]

def fetch(url):
    """ç™¼é€ HTTP è«‹æ±‚ï¼ˆåŒæ­¥ï¼‰"""
    print(f"ğŸ”„ ç™¼é€è«‹æ±‚: {url}")
    response = requests.get(url)
    print(f"âœ… å®Œæˆè«‹æ±‚: {url}")
    return response.json()

start_time = time.time()

# ä½¿ç”¨ ThreadPoolExecutor è®“å¤šå€‹è«‹æ±‚åŒæ™‚åŸ·è¡Œ
with ThreadPoolExecutor(max_workers=3) as executor:
    results = list(executor.map(fetch, URLS))

end_time = time.time()
print(f"ç¸½åŸ·è¡Œæ™‚é–“: {end_time - start_time:.2f} ç§’")
</code></pre>
<p><strong>å„ªé»ï¼š</strong></p>
<ul>
<li>ç°¡å–®æ˜“ç”¨ï¼Œä¸éœ€è¦ä¿®æ”¹ç¾æœ‰åŒæ­¥ç¨‹å¼ç¢¼</li>
<li>é©åˆè™•ç† <code>requests</code> ç­‰åŒæ­¥åº«</li>
</ul>
<h3 id="asyncio-ç¯„ä¾‹"><a class="header" href="#asyncio-ç¯„ä¾‹">asyncio ç¯„ä¾‹</a></h3>
<pre><code class="language-python">import aiohttp
import asyncio

URLS = [
    "https://jsonplaceholder.typicode.com/todos/1",
    "https://jsonplaceholder.typicode.com/todos/2",
    "https://jsonplaceholder.typicode.com/todos/3",
]

async def fetch(session, url):
    """ä½¿ç”¨ aiohttp éåŒæ­¥ç™¼é€è«‹æ±‚"""
    print(f"ğŸ”„ ç™¼é€è«‹æ±‚: {url}")
    async with session.get(url) as response:
        result = await response.json()
        print(f"âœ… å®Œæˆè«‹æ±‚: {url}")
        return result

async def main():
    async with aiohttp.ClientSession() as session:
        tasks = [fetch(session, url) for url in URLS]
        results = await asyncio.gather(*tasks)
        return results

# åŸ·è¡ŒéåŒæ­¥ä¸»ç¨‹å¼
results = asyncio.run(main())
print(results)
</code></pre>
<p><strong>å„ªé»ï¼š</strong></p>
<ul>
<li>çœŸæ­£çš„éåŒæ­¥åŸ·è¡Œï¼Œæ•ˆèƒ½æ›´å¥½</li>
<li>å–®åŸ·è¡Œç·’ï¼Œè³‡æºæ¶ˆè€—æ›´å°‘</li>
</ul>
<h3 id="asyncio--threadpoolexecutor-æ··åˆä½¿ç”¨"><a class="header" href="#asyncio--threadpoolexecutor-æ··åˆä½¿ç”¨">asyncio + ThreadPoolExecutor æ··åˆä½¿ç”¨</a></h3>
<p>ç•¶éœ€è¦åœ¨ asyncio ç’°å¢ƒä¸­åŸ·è¡ŒåŒæ­¥å‡½å¼æ™‚ï¼Œå¯ä»¥ä½¿ç”¨ <code>run_in_executor</code>ï¼š</p>
<pre><code class="language-python">import asyncio
import requests
from concurrent.futures import ThreadPoolExecutor

URL = "https://jsonplaceholder.typicode.com/todos/1"

def fetch():
    """åŒæ­¥å‡½å¼"""
    return requests.get(URL).json()

async def main():
    loop = asyncio.get_running_loop()
    
    # åœ¨åŸ·è¡Œç·’æ± ä¸­åŸ·è¡ŒåŒæ­¥å‡½å¼
    with ThreadPoolExecutor() as executor:
        result = await loop.run_in_executor(executor, fetch)
        print(result)

asyncio.run(main())
</code></pre>
<h3 id="é‹ä½œæµç¨‹åœ–è§£"><a class="header" href="#é‹ä½œæµç¨‹åœ–è§£">é‹ä½œæµç¨‹åœ–è§£</a></h3>
<h4 id="threadpoolexecutor-é‹ä½œæµç¨‹"><a class="header" href="#threadpoolexecutor-é‹ä½œæµç¨‹">ThreadPoolExecutor é‹ä½œæµç¨‹</a></h4>
<pre><code>ä¸»åŸ·è¡Œç·’
    â”œâ”€&gt; åŸ·è¡Œç·’ 1: åŸ·è¡Œ task1()
    â”œâ”€&gt; åŸ·è¡Œç·’ 2: åŸ·è¡Œ task2()
    â””â”€&gt; åŸ·è¡Œç·’ 3: åŸ·è¡Œ task3()
    
æ‰€æœ‰åŸ·è¡Œç·’åŒæ™‚é‹è¡Œï¼Œä½†å— GIL é™åˆ¶
</code></pre>
<h4 id="asyncio-é‹ä½œæµç¨‹"><a class="header" href="#asyncio-é‹ä½œæµç¨‹">asyncio é‹ä½œæµç¨‹</a></h4>
<pre><code>äº‹ä»¶è¿´åœˆï¼ˆå–®åŸ·è¡Œç·’ï¼‰
    â”œâ”€&gt; task1(): é‡åˆ° awaitï¼Œåˆ‡æ›åˆ° task2()
    â”œâ”€&gt; task2(): é‡åˆ° awaitï¼Œåˆ‡æ›åˆ° task3()
    â””â”€&gt; task3(): é‡åˆ° awaitï¼Œåˆ‡æ›å› task1()
    
å–®åŸ·è¡Œç·’å…§å¿«é€Ÿåˆ‡æ›ï¼Œä¸æœƒé˜»å¡
</code></pre>
<h3 id="æ•ˆèƒ½æ¯”è¼ƒ"><a class="header" href="#æ•ˆèƒ½æ¯”è¼ƒ">æ•ˆèƒ½æ¯”è¼ƒ</a></h3>
<div class="table-wrapper"><table><thead><tr><th>æ–¹æ³•</th><th>åŸ·è¡Œæ–¹å¼</th><th>3 å€‹è«‹æ±‚è€—æ™‚ï¼ˆæ¯å€‹ 1 ç§’ï¼‰</th></tr></thead><tbody>
<tr><td><strong>å–®åŸ·è¡Œç·’ï¼ˆåŒæ­¥ï¼‰</strong></td><td>é€å€‹è«‹æ±‚</td><td>â³ 3 ç§’</td></tr>
<tr><td><strong>ThreadPoolExecutor</strong></td><td>3 å€‹åŸ·è¡Œç·’åŒæ™‚</td><td>ğŸš€ 1 ç§’</td></tr>
<tr><td><strong>asyncio</strong></td><td>å–®åŸ·è¡Œç·’éåŒæ­¥</td><td>ğŸš€ 1 ç§’</td></tr>
</tbody></table>
</div>
<h3 id="é¸æ“‡å»ºè­°"><a class="header" href="#é¸æ“‡å»ºè­°">é¸æ“‡å»ºè­°</a></h3>
<h4 id="ä½¿ç”¨-threadpoolexecutor-çš„æƒ…æ³"><a class="header" href="#ä½¿ç”¨-threadpoolexecutor-çš„æƒ…æ³">ä½¿ç”¨ ThreadPoolExecutor çš„æƒ…æ³ï¼š</a></h4>
<ul>
<li>ä½¿ç”¨ <code>requests</code> ç­‰åŒæ­¥åº«</li>
<li>ç¾æœ‰ç¨‹å¼ç¢¼æ˜¯åŒæ­¥çš„ï¼Œä¸æƒ³å¤§å¹…ä¿®æ”¹</li>
<li>éœ€è¦å¿«é€Ÿå¯¦ç¾ä¸¦ç™¼åŠŸèƒ½</li>
</ul>
<h4 id="ä½¿ç”¨-asyncio-çš„æƒ…æ³"><a class="header" href="#ä½¿ç”¨-asyncio-çš„æƒ…æ³">ä½¿ç”¨ asyncio çš„æƒ…æ³ï¼š</a></h4>
<ul>
<li>ä½¿ç”¨ <code>aiohttp</code> ç­‰éåŒæ­¥åº«</li>
<li>éœ€è¦è™•ç†å¤§é‡ä¸¦ç™¼é€£æ¥ï¼ˆå¦‚ WebSocketï¼‰</li>
<li>è¿½æ±‚æ›´é«˜çš„æ•ˆèƒ½å’Œæ›´ä½çš„è³‡æºæ¶ˆè€—</li>
</ul>
<h4 id="æ··åˆä½¿ç”¨çš„æƒ…æ³"><a class="header" href="#æ··åˆä½¿ç”¨çš„æƒ…æ³">æ··åˆä½¿ç”¨çš„æƒ…æ³ï¼š</a></h4>
<ul>
<li>ä¸»é«”ä½¿ç”¨ asyncioï¼Œä½†éœ€è¦å‘¼å«æŸäº›åŒæ­¥å‡½å¼</li>
<li>é€æ­¥å°‡åŒæ­¥ç¨‹å¼ç¢¼é·ç§»åˆ°éåŒæ­¥</li>
</ul>
<hr />
<h2 id="ç¸½çµèˆ‡æœ€ä½³å¯¦è¸"><a class="header" href="#ç¸½çµèˆ‡æœ€ä½³å¯¦è¸">ç¸½çµèˆ‡æœ€ä½³å¯¦è¸</a></h2>
<h3 id="å¿«é€Ÿé¸æ“‡æŒ‡å—"><a class="header" href="#å¿«é€Ÿé¸æ“‡æŒ‡å—">å¿«é€Ÿé¸æ“‡æŒ‡å—</a></h3>
<pre><code>ä»»å‹™é¡å‹åˆ¤æ–·ï¼š
â”œâ”€&gt; CPU å¯†é›†å‹ï¼Ÿ
â”‚   â””â”€&gt; ä½¿ç”¨ ProcessPoolExecutor
â”‚
â””â”€&gt; I/O å¯†é›†å‹ï¼Ÿ
    â”œâ”€&gt; éœ€è¦ä½¿ç”¨åŒæ­¥åº«ï¼ˆrequestsï¼‰ï¼Ÿ
    â”‚   â””â”€&gt; ä½¿ç”¨ ThreadPoolExecutor
    â”‚
    â””â”€&gt; å¯ä»¥ä½¿ç”¨éåŒæ­¥åº«ï¼ˆaiohttpï¼‰ï¼Ÿ
        â””â”€&gt; ä½¿ç”¨ asyncio
</code></pre>
<h3 id="æ ¸å¿ƒè¦é»"><a class="header" href="#æ ¸å¿ƒè¦é»">æ ¸å¿ƒè¦é»</a></h3>
<ol>
<li>
<p><strong>åŸ·è¡Œç·’ vs é€²ç¨‹</strong></p>
<ul>
<li>åŸ·è¡Œç·’ï¼šå…±äº«è¨˜æ†¶é«”ï¼Œé©åˆ I/O å¯†é›†å‹</li>
<li>é€²ç¨‹ï¼šç¨ç«‹è¨˜æ†¶é«”ï¼Œé©åˆ CPU å¯†é›†å‹</li>
</ul>
</li>
<li>
<p><strong>Python GIL é™åˆ¶</strong></p>
<ul>
<li>å½±éŸ¿å¤šåŸ·è¡Œç·’çš„ CPU é‹ç®—æ•ˆèƒ½</li>
<li>ä¸å½±éŸ¿ I/O æ“ä½œçš„ä¸¦ç™¼</li>
</ul>
</li>
<li>
<p><strong>ThreadPoolExecutor ä½¿ç”¨å ´æ™¯</strong></p>
<ul>
<li>API è«‹æ±‚ã€æª”æ¡ˆè™•ç†ã€ç¶²è·¯çˆ¬èŸ²</li>
<li>å¿«é€Ÿå°‡åŒæ­¥ç¨‹å¼ç¢¼ä¸¦è¡ŒåŒ–</li>
</ul>
</li>
<li>
<p><strong>asyncio å„ªå‹¢</strong></p>
<ul>
<li>çœŸæ­£çš„éåŒæ­¥åŸ·è¡Œ</li>
<li>æ›´é«˜æ•ˆèƒ½ã€æ›´ä½è³‡æºæ¶ˆè€—</li>
</ul>
</li>
</ol>
<h3 id="å¯¦æˆ°å»ºè­°"><a class="header" href="#å¯¦æˆ°å»ºè­°">å¯¦æˆ°å»ºè­°</a></h3>
<ol>
<li><strong>å¾ç°¡å–®é–‹å§‹</strong>ï¼šå…ˆç”¨ ThreadPoolExecutor å„ªåŒ–ç¾æœ‰åŒæ­¥ç¨‹å¼ç¢¼</li>
<li><strong>é€æ­¥é·ç§»</strong>ï¼šæ–°å°ˆæ¡ˆè€ƒæ…®ä½¿ç”¨ asyncio</li>
<li><strong>æ··åˆä½¿ç”¨</strong>ï¼šåœ¨ asyncio ä¸­ç”¨ run_in_executor åŸ·è¡ŒåŒæ­¥å‡½å¼</li>
<li><strong>ç›£æ§æ•ˆèƒ½</strong>ï¼šæ ¹æ“šå¯¦éš›å ´æ™¯æ¸¬è©¦ä¸¦é¸æ“‡æœ€ä½³æ–¹æ¡ˆ</li>
</ol>
<h3 id="å¸¸è¦‹é™·é˜±èˆ‡è§£æ±ºæ–¹æ¡ˆ"><a class="header" href="#å¸¸è¦‹é™·é˜±èˆ‡è§£æ±ºæ–¹æ¡ˆ">å¸¸è¦‹é™·é˜±èˆ‡è§£æ±ºæ–¹æ¡ˆ</a></h3>
<div class="table-wrapper"><table><thead><tr><th>é™·é˜±</th><th>è§£æ±ºæ–¹æ¡ˆ</th></tr></thead><tbody>
<tr><td>éå¤šåŸ·è¡Œç·’å°è‡´è³‡æºè€—ç›¡</td><td>é™åˆ¶ max_workers æ•¸é‡</td></tr>
<tr><td>åŒæ­¥å‡½å¼é˜»å¡ asyncio</td><td>ä½¿ç”¨ run_in_executor</td></tr>
<tr><td>GIL é™åˆ¶ CPU é‹ç®—</td><td>æ”¹ç”¨ ProcessPoolExecutor</td></tr>
<tr><td>Race Condition</td><td>ä½¿ç”¨ Lock æˆ–å…¶ä»–åŒæ­¥æ©Ÿåˆ¶</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="åƒè€ƒè³‡æº"><a class="header" href="#åƒè€ƒè³‡æº">åƒè€ƒè³‡æº</a></h2>
<ul>
<li><a href="https://docs.python.org/3/library/concurrent.futures.html">Python å®˜æ–¹æ–‡ä»¶ - concurrent.futures</a></li>
<li><a href="https://docs.python.org/3/library/asyncio.html">Python å®˜æ–¹æ–‡ä»¶ - asyncio</a></li>
<li><a href="https://docs.python.org/3/library/threading.html">Python å®˜æ–¹æ–‡ä»¶ - threading</a></li>
<li><a href="https://docs.python.org/3/library/multiprocessing.html">Python å®˜æ–¹æ–‡ä»¶ - multiprocessing</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../python/condition.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../python/02_æ€§èƒ½å„ªåŒ–èˆ‡åˆ†æ.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../python/condition.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../python/02_æ€§èƒ½å„ªåŒ–èˆ‡åˆ†æ.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="../ace.js"></script>
        <script src="../mode-rust.js"></script>
        <script src="../editor.js"></script>
        <script src="../theme-dawn.js"></script>
        <script src="../theme-tomorrow_night.js"></script>

        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../mermaid.min.js"></script>
        <script src="../mermaid-init.js"></script>



    </div>
    </body>
</html>
