# WASM å°ˆæ¡ˆ Makefile

.PHONY: all build test serve clean help

# é è¨­ç›®æ¨™
all: build

# ç·¨è­¯ WASM
build:
	@echo "ğŸ”¨ ç·¨è­¯ WASM..."
	@wasm-pack build --target web --out-dir pkg
	@echo "âœ… ç·¨è­¯å®Œæˆ"

# åŸ·è¡Œæ¸¬è©¦
test: build
	@echo "ğŸ§ª åŸ·è¡Œæ¸¬è©¦..."
	@node test.js

# å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨
serve: build
	@echo "ğŸ” æª¢æŸ¥ä¸¦æ¸…ç† 8000 ç«¯å£..."
	@lsof -ti:8000 | xargs -r kill -9 2>/dev/null || true
	@echo "ğŸŒ å•Ÿå‹•ä¼ºæœå™¨ (http://localhost:8000)..."
	@echo "ğŸ“‹ æ¸¬è©¦é é¢:"
	@echo "  - http://localhost:8000/test-with-logs.html (Log é¡¯ç¤º)"
	@echo "  - http://localhost:8000/test.html (åŸºæœ¬æ¸¬è©¦)"
	@python3 -m http.server 8000

# æ¸…ç†æª”æ¡ˆ
clean:
	@echo "ğŸ§¹ æ¸…ç†æª”æ¡ˆ..."
	@rm -rf pkg/ target/
	@cargo clean

# èªªæ˜
help:
	@echo "å¯ç”¨æŒ‡ä»¤:"
	@echo "  make build  - ç·¨è­¯ WASM"
	@echo "  make test   - åŸ·è¡Œæ¸¬è©¦"  
	@echo "  make serve  - å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨"
	@echo "  make clean  - æ¸…ç†ç”Ÿæˆæª”æ¡ˆ"
	@echo "  make help   - é¡¯ç¤ºèªªæ˜"