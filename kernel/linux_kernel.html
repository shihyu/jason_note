<!DOCTYPE HTML>
<html lang="zh" class="rust sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Linux Kernel - Jason Notes</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "rust";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Jason Notes</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/shihyu/jason_note" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="linux-kernel-深度解析"><a class="header" href="#linux-kernel-深度解析">Linux Kernel 深度解析</a></h1>
<h2 id="簡介"><a class="header" href="#簡介">簡介</a></h2>
<p>Linux Kernel 是整個 Linux 作業系統的核心，負責管理系統資源、硬體設備、進程調度等底層操作。它是由 Linus Torvalds 於 1991 年創建的開源項目，現已成為世界上最廣泛使用的作業系統核心之一。</p>
<h3 id="核心架構層次"><a class="header" href="#核心架構層次">核心架構層次</a></h3>
<pre><code>┌─────────────────────────────────────┐
│         使用者空間 (User Space)        │
├─────────────────────────────────────┤
│         系統呼叫介面 (System Call)      │
├─────────────────────────────────────┤
│    ┌──────────┬──────────┬──────┐   │
│    │  VFS     │  進程管理  │ IPC  │   │
│    ├──────────┼──────────┼──────┤   │
│    │  網路協議 │  記憶體管理 │ 檔案 │   │
│    ├──────────┴──────────┴──────┤   │
│    │        裝置驅動程式          │   │
│    └──────────────────────────────┘   │
├─────────────────────────────────────┤
│         硬體抽象層 (HAL)              │
└─────────────────────────────────────┘
</code></pre>
<h2 id="核心子系統"><a class="header" href="#核心子系統">核心子系統</a></h2>
<h3 id="1-進程管理-process-management"><a class="header" href="#1-進程管理-process-management">1. 進程管理 (Process Management)</a></h3>
<ul>
<li><strong>調度器 (Scheduler)</strong>: CFS (Completely Fair Scheduler)</li>
<li><strong>進程狀態</strong>: Running, Waiting, Stopped, Zombie</li>
<li><strong>上下文切換</strong>: 保存和恢復 CPU 狀態</li>
<li><strong>進程通訊</strong>: Signal, Pipe, Socket, Shared Memory</li>
</ul>
<h3 id="2-記憶體管理-memory-management"><a class="header" href="#2-記憶體管理-memory-management">2. 記憶體管理 (Memory Management)</a></h3>
<ul>
<li><strong>虛擬記憶體</strong>: 分頁機制、位址空間</li>
<li><strong>記憶體分配器</strong>: SLAB, SLUB, SLOB</li>
<li><strong>頁面置換演算法</strong>: LRU, Clock</li>
<li><strong>記憶體映射</strong>: mmap(), munmap()</li>
</ul>
<h3 id="3-檔案系統-file-system"><a class="header" href="#3-檔案系統-file-system">3. 檔案系統 (File System)</a></h3>
<ul>
<li><strong>VFS (Virtual File System)</strong>: 統一的檔案系統介面</li>
<li><strong>支援的檔案系統</strong>: ext4, Btrfs, XFS, ZFS</li>
<li><strong>塊設備層</strong>: I/O 調度器 (CFQ, Deadline, NOOP)</li>
<li><strong>頁緩存</strong>: Page Cache 機制</li>
</ul>
<h3 id="4-網路子系統-networking"><a class="header" href="#4-網路子系統-networking">4. 網路子系統 (Networking)</a></h3>
<ul>
<li><strong>協議棧</strong>: TCP/IP, UDP, ICMP</li>
<li><strong>Netfilter</strong>: 防火牆框架</li>
<li><strong>Socket 層</strong>: BSD Socket API</li>
<li><strong>網路設備驅動</strong>: 網卡驅動介面</li>
</ul>
<h3 id="5-裝置驅動-device-drivers"><a class="header" href="#5-裝置驅動-device-drivers">5. 裝置驅動 (Device Drivers)</a></h3>
<ul>
<li><strong>字符設備</strong>: 按字節訪問 (如終端、串口)</li>
<li><strong>塊設備</strong>: 按塊訪問 (如硬碟、SSD)</li>
<li><strong>網路設備</strong>: 網路介面卡</li>
<li><strong>Platform 設備</strong>: 嵌入式系統設備</li>
</ul>
<h2 id="開發工具"><a class="header" href="#開發工具">開發工具</a></h2>
<h3 id="編譯工具"><a class="header" href="#編譯工具">編譯工具</a></h3>
<pre><code class="language-bash"># 安裝編譯工具鏈
sudo apt-get install build-essential libncurses-dev bison flex libssl-dev libelf-dev

# 配置核心
make menuconfig    # 圖形化配置
make defconfig     # 預設配置
make oldconfig     # 基於舊配置

# 編譯核心
make -j$(nproc)    # 多核心編譯
make modules       # 編譯模組
make modules_install  # 安裝模組
make install       # 安裝核心
</code></pre>
<h3 id="調試工具"><a class="header" href="#調試工具">調試工具</a></h3>
<h4 id="1-printk"><a class="header" href="#1-printk">1. <strong>printk</strong></a></h4>
<pre><code class="language-c">// 核心日誌等級
#define KERN_EMERG   "&lt;0&gt;"  // 系統無法使用
#define KERN_ALERT   "&lt;1&gt;"  // 必須立即採取行動
#define KERN_CRIT    "&lt;2&gt;"  // 危急情況
#define KERN_ERR     "&lt;3&gt;"  // 錯誤情況
#define KERN_WARNING "&lt;4&gt;"  // 警告情況
#define KERN_NOTICE  "&lt;5&gt;"  // 正常但重要
#define KERN_INFO    "&lt;6&gt;"  // 資訊
#define KERN_DEBUG   "&lt;7&gt;"  // 調試資訊

printk(KERN_INFO "Module loaded\n");
</code></pre>
<h4 id="2-kgdb"><a class="header" href="#2-kgdb">2. <strong>KGDB</strong></a></h4>
<pre><code class="language-bash"># 在 kernel config 中啟用
CONFIG_KGDB=y
CONFIG_KGDB_SERIAL_CONSOLE=y

# 啟動參數
kgdboc=ttyS0,115200 kgdbwait
</code></pre>
<h4 id="3-systemtap"><a class="header" href="#3-systemtap">3. <strong>SystemTap</strong></a></h4>
<pre><code class="language-bash"># 安裝
sudo apt-get install systemtap systemtap-runtime

# 範例腳本
stap -e 'probe kernel.function("sys_open") { printf("open called\n") }'
</code></pre>
<h4 id="4-ftrace"><a class="header" href="#4-ftrace">4. <strong>ftrace</strong></a></h4>
<pre><code class="language-bash"># 啟用 function tracer
echo function &gt; /sys/kernel/debug/tracing/current_tracer

# 查看追蹤結果
cat /sys/kernel/debug/tracing/trace
</code></pre>
<h4 id="5-perf"><a class="header" href="#5-perf">5. <strong>perf</strong></a></h4>
<pre><code class="language-bash"># 安裝
sudo apt-get install linux-tools-common linux-tools-generic

# CPU 分析
perf record -a -g ./program
perf report

# 查看系統調用
perf trace

# 統計效能計數器
perf stat ./program
</code></pre>
<h3 id="分析工具"><a class="header" href="#分析工具">分析工具</a></h3>
<h4 id="1-ebpf-extended-berkeley-packet-filter"><a class="header" href="#1-ebpf-extended-berkeley-packet-filter">1. <strong>eBPF (Extended Berkeley Packet Filter)</strong></a></h4>
<pre><code class="language-python"># 使用 bcc 工具
from bcc import BPF

# BPF 程式
bpf_text = """
int trace_open(struct pt_regs *ctx) {
    bpf_trace_printk("open() called\\n");
    return 0;
}
"""

b = BPF(text=bpf_text)
b.attach_kprobe(event="sys_open", fn_name="trace_open")
</code></pre>
<h4 id="2-bpftrace"><a class="header" href="#2-bpftrace">2. <strong>bpftrace</strong></a></h4>
<pre><code class="language-bash"># 追蹤系統調用
sudo bpftrace -e 'tracepoint:syscalls:sys_enter_open { printf("%s %s\n", comm, str(args-&gt;filename)); }'

# 統計函數執行時間
sudo bpftrace -e 'kprobe:vfs_read { @start[tid] = nsecs; } kretprobe:vfs_read /@start[tid]/ { @ns = hist(nsecs - @start[tid]); delete(@start[tid]); }'
</code></pre>
<h4 id="3-lttng-linux-trace-toolkit-next-generation"><a class="header" href="#3-lttng-linux-trace-toolkit-next-generation">3. <strong>LTTng (Linux Trace Toolkit Next Generation)</strong></a></h4>
<pre><code class="language-bash"># 創建會話
lttng create my-session

# 啟用核心事件
lttng enable-event -k sched_switch

# 開始追蹤
lttng start

# 停止並查看
lttng stop
lttng view
</code></pre>
<h2 id="核心模組開發"><a class="header" href="#核心模組開發">核心模組開發</a></h2>
<h3 id="基本模組範例"><a class="header" href="#基本模組範例">基本模組範例</a></h3>
<pre><code class="language-c">#include &lt;linux/init.h&gt;
#include &lt;linux/module.h&gt;
#include &lt;linux/kernel.h&gt;

static int __init hello_init(void)
{
    printk(KERN_INFO "Hello, Kernel!\n");
    return 0;
}

static void __exit hello_exit(void)
{
    printk(KERN_INFO "Goodbye, Kernel!\n");
}

module_init(hello_init);
module_exit(hello_exit);

MODULE_LICENSE("GPL");
MODULE_AUTHOR("Your Name");
MODULE_DESCRIPTION("A simple kernel module");
MODULE_VERSION("1.0");
</code></pre>
<h3 id="makefile"><a class="header" href="#makefile">Makefile</a></h3>
<pre><code class="language-makefile">obj-m += hello.o

all:
	make -C /lib/modules/$(shell uname -r)/build M=$(PWD) modules

clean:
	make -C /lib/modules/$(shell uname -r)/build M=$(PWD) clean
</code></pre>
<h3 id="模組操作"><a class="header" href="#模組操作">模組操作</a></h3>
<pre><code class="language-bash"># 編譯模組
make

# 載入模組
sudo insmod hello.ko

# 查看模組
lsmod | grep hello

# 查看模組資訊
modinfo hello.ko

# 卸載模組
sudo rmmod hello

# 查看核心日誌
dmesg | tail
</code></pre>
<h2 id="重要資料結構"><a class="header" href="#重要資料結構">重要資料結構</a></h2>
<h3 id="1-task_struct-進程描述符"><a class="header" href="#1-task_struct-進程描述符">1. task_struct (進程描述符)</a></h3>
<pre><code class="language-c">struct task_struct {
    volatile long state;        // 進程狀態
    void *stack;               // 核心棧
    unsigned int flags;        // 進程標誌
    int prio, static_prio;     // 優先級
    struct mm_struct *mm;      // 記憶體描述符
    struct files_struct *files; // 開啟的檔案
    pid_t pid;                 // 進程 ID
    pid_t tgid;                // 執行緒群組 ID
    // ... 更多欄位
};
</code></pre>
<h3 id="2-file_operations-檔案操作"><a class="header" href="#2-file_operations-檔案操作">2. file_operations (檔案操作)</a></h3>
<pre><code class="language-c">struct file_operations {
    struct module *owner;
    loff_t (*llseek) (struct file *, loff_t, int);
    ssize_t (*read) (struct file *, char __user *, size_t, loff_t *);
    ssize_t (*write) (struct file *, const char __user *, size_t, loff_t *);
    int (*open) (struct inode *, struct file *);
    int (*release) (struct inode *, struct file *);
    // ... 更多操作
};
</code></pre>
<h2 id="學習資源"><a class="header" href="#學習資源">學習資源</a></h2>
<h3 id="官方文件"><a class="header" href="#官方文件">官方文件</a></h3>
<ul>
<li><a href="https://www.kernel.org/doc/html/latest/">Linux Kernel Documentation</a></li>
<li><a href="https://kernelnewbies.org/">Kernel Newbies</a></li>
<li><a href="https://lkml.org/">Linux Kernel Mailing List (LKML)</a></li>
</ul>
<h3 id="書籍推薦"><a class="header" href="#書籍推薦">書籍推薦</a></h3>
<ol>
<li><strong>《Linux Kernel Development》</strong> - Robert Love</li>
<li><strong>《Understanding the Linux Kernel》</strong> - Daniel P. Bovet &amp; Marco Cesati</li>
<li><strong>《Linux Device Drivers》</strong> - Jonathan Corbet, Alessandro Rubini</li>
<li><strong>《Professional Linux Kernel Architecture》</strong> - Wolfgang Mauerer</li>
<li><strong>《The Linux Programming Interface》</strong> - Michael Kerrisk</li>
</ol>
<h3 id="線上課程"><a class="header" href="#線上課程">線上課程</a></h3>
<ul>
<li><a href="https://www.coursera.org/learn/linux-kernel-programming">Linux Kernel Programming (Coursera)</a></li>
<li><a href="https://www.edx.org/course/linux-kernel">Linux Kernel Internals (edX)</a></li>
<li><a href="http://eudyptula-challenge.org/">Eudyptula Challenge</a> - Kernel 開發挑戰</li>
</ul>
<h3 id="實用網站"><a class="header" href="#實用網站">實用網站</a></h3>
<ul>
<li><a href="https://lwn.net/">LWN.net</a> - Linux 週報</li>
<li><a href="https://www.phoronix.com/">Phoronix</a> - Linux 硬體和效能新聞</li>
<li><a href="https://0xax.gitbooks.io/linux-insides/">Linux Inside</a> - 深入理解 Linux 核心</li>
<li><a href="https://sysprog21.github.io/lkmpg/">The Linux Kernel Module Programming Guide</a></li>
</ul>
<h3 id="原始碼瀏覽"><a class="header" href="#原始碼瀏覽">原始碼瀏覽</a></h3>
<ul>
<li><a href="https://elixir.bootlin.com/linux/latest/source">Elixir Cross Referencer</a></li>
<li><a href="https://github.com/torvalds/linux">Linux Kernel GitHub Mirror</a></li>
<li><a href="https://git.kernel.org/">Kernel.org Git</a></li>
</ul>
<h2 id="實戰專案"><a class="header" href="#實戰專案">實戰專案</a></h2>
<h3 id="入門級"><a class="header" href="#入門級">入門級</a></h3>
<ol>
<li><strong>Hello World 模組</strong>: 基本的核心模組</li>
<li><strong>字符設備驅動</strong>: 實現簡單的字符設備</li>
<li><strong>/proc 檔案系統</strong>: 創建 /proc 條目</li>
<li><strong>sysfs 介面</strong>: 實現 sysfs 屬性</li>
</ol>
<h3 id="進階級"><a class="header" href="#進階級">進階級</a></h3>
<ol>
<li><strong>塊設備驅動</strong>: RAM disk 實現</li>
<li><strong>網路驅動</strong>: 虛擬網路設備</li>
<li><strong>檔案系統</strong>: 簡單的檔案系統實現</li>
<li><strong>調度器修改</strong>: 自定義調度策略</li>
</ol>
<h3 id="專家級"><a class="header" href="#專家級">專家級</a></h3>
<ol>
<li><strong>即時核心修改</strong>: RT-PREEMPT 補丁</li>
<li><strong>安全模組</strong>: LSM (Linux Security Module)</li>
<li><strong>虛擬化</strong>: KVM 模組開發</li>
<li><strong>效能優化</strong>: 核心效能調優</li>
</ol>
<h2 id="常用命令速查"><a class="header" href="#常用命令速查">常用命令速查</a></h2>
<pre><code class="language-bash"># 核心版本
uname -r

# 核心參數
sysctl -a                  # 查看所有參數
sysctl kernel.version      # 查看特定參數
echo 1 &gt; /proc/sys/net/ipv4/ip_forward  # 修改參數

# 模組管理
lsmod                      # 列出載入的模組
modprobe module_name       # 載入模組及依賴
modprobe -r module_name    # 卸載模組
depmod                     # 生成模組依賴

# 核心日誌
dmesg                      # 查看核心環緩衝區
journalctl -k              # 查看核心日誌 (systemd)
cat /proc/kmsg             # 即時核心訊息

# 系統資訊
cat /proc/cpuinfo          # CPU 資訊
cat /proc/meminfo          # 記憶體資訊
cat /proc/interrupts       # 中斷資訊
cat /proc/modules          # 載入的模組
cat /proc/version          # 核心版本

# 效能監控
vmstat 1                   # 虛擬記憶體統計
iostat -x 1                # I/O 統計
mpstat -P ALL 1            # CPU 統計
sar -n DEV 1               # 網路統計
</code></pre>
<h2 id="核心開發最佳實踐"><a class="header" href="#核心開發最佳實踐">核心開發最佳實踐</a></h2>
<h3 id="1-編碼規範"><a class="header" href="#1-編碼規範">1. 編碼規範</a></h3>
<ul>
<li>遵循 <a href="https://www.kernel.org/doc/html/latest/process/coding-style.html">Linux Kernel Coding Style</a></li>
<li>使用 checkpatch.pl 檢查程式碼</li>
<li>保持函數簡短，一個函數一個功能</li>
</ul>
<h3 id="2-記憶體管理"><a class="header" href="#2-記憶體管理">2. 記憶體管理</a></h3>
<ul>
<li>正確使用 kmalloc/kfree</li>
<li>避免記憶體洩漏</li>
<li>使用適當的 GFP 標誌</li>
<li>注意原子上下文限制</li>
</ul>
<h3 id="3-並發控制"><a class="header" href="#3-並發控制">3. 並發控制</a></h3>
<ul>
<li>正確使用鎖機制 (spinlock, mutex, semaphore)</li>
<li>避免死鎖</li>
<li>使用 RCU 進行讀優化</li>
<li>注意中斷上下文</li>
</ul>
<h3 id="4-錯誤處理"><a class="header" href="#4-錯誤處理">4. 錯誤處理</a></h3>
<ul>
<li>檢查所有返回值</li>
<li>使用 goto 進行錯誤清理</li>
<li>提供有意義的錯誤訊息</li>
<li>正確釋放資源</li>
</ul>
<h3 id="5-測試和調試"><a class="header" href="#5-測試和調試">5. 測試和調試</a></h3>
<ul>
<li>使用 KASAN 檢測記憶體錯誤</li>
<li>啟用 DEBUG 選項</li>
<li>進行壓力測試</li>
<li>使用 sparse 進行靜態分析</li>
</ul>
<h2 id="結語"><a class="header" href="#結語">結語</a></h2>
<p>Linux Kernel 是一個龐大而複雜的系統，掌握它需要時間和實踐。建議從簡單的模組開始，逐步深入到更複雜的子系統。記住，核心開發需要謹慎，因為錯誤可能導致系統崩潰。始終在虛擬機或測試環境中進行開發和測試。</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../linux_system/api_vs_abi_guide.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../kernel/what-is-ebpf.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../linux_system/api_vs_abi_guide.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../kernel/what-is-ebpf.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="../ace.js"></script>
        <script src="../mode-rust.js"></script>
        <script src="../editor.js"></script>
        <script src="../theme-dawn.js"></script>
        <script src="../theme-tomorrow_night.js"></script>

        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../mermaid.min.js"></script>
        <script src="../mermaid-init.js"></script>



    </div>
    </body>
</html>
