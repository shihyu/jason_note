<!DOCTYPE HTML>
<html lang="zh" class="rust sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Ubuntu FPGA 開發指南 - Jason Notes</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "rust";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Jason Notes</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/shihyu/jason_note" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="ubuntu-fpga-開發環境完整指南"><a class="header" href="#ubuntu-fpga-開發環境完整指南">Ubuntu FPGA 開發環境完整指南</a></h1>
<h2 id="目錄"><a class="header" href="#目錄">目錄</a></h2>
<ol>
<li><a href="#fpga-%E9%96%8B%E7%99%BC%E6%9D%BF%E9%81%B8%E6%93%87">FPGA 開發板選擇</a></li>
<li><a href="#%E9%96%8B%E7%99%BC%E5%B7%A5%E5%85%B7%E5%AE%89%E8%A3%9D">開發工具安裝</a></li>
<li><a href="#%E6%A8%A1%E6%93%AC%E8%88%87%E9%99%A4%E9%8C%AF%E5%B7%A5%E5%85%B7">模擬與除錯工具</a></li>
<li><a href="#risc-v-%E9%96%8B%E7%99%BC%E7%92%B0%E5%A2%83">RISC-V 開發環境</a></li>
<li><a href="#%E9%96%8B%E6%BA%90%E5%B7%A5%E5%85%B7%E9%8F%88">開源工具鏈</a></li>
<li><a href="#%E5%AF%A6%E7%94%A8%E8%B3%87%E6%BA%90%E9%80%A3%E7%B5%90">實用資源連結</a></li>
</ol>
<hr />
<h2 id="fpga-開發板選擇"><a class="header" href="#fpga-開發板選擇">FPGA 開發板選擇</a></h2>
<h3 id="預算與性能對比表"><a class="header" href="#預算與性能對比表">預算與性能對比表</a></h3>
<div class="table-wrapper"><table><thead><tr><th>開發板</th><th>價格 (USD)</th><th>FPGA</th><th>記憶體</th><th>特色</th><th>開源工具</th><th>推薦度</th></tr></thead><tbody>
<tr><td><strong>Milk-V Duo S</strong></td><td>$20-25</td><td>-</td><td>512MB</td><td>RISC-V硬核+網口</td><td>✅</td><td>⭐⭐⭐⭐⭐</td></tr>
<tr><td><strong>Tang Nano 9K</strong></td><td>$15</td><td>Gowin 9K</td><td>32MB</td><td>HDMI、便宜</td><td>❌</td><td>⭐⭐⭐⭐</td></tr>
<tr><td><strong>ColorLight i5</strong></td><td>$30</td><td>ECP5-25K</td><td>32MB</td><td>雙千兆網、改裝板</td><td>✅</td><td>⭐⭐⭐⭐⭐</td></tr>
<tr><td><strong>Tang Primer 25K</strong></td><td>$45</td><td>Gowin 23K</td><td>128MB</td><td>PCIe、大記憶體</td><td>❌</td><td>⭐⭐⭐⭐</td></tr>
<tr><td><strong>ColorLight i9</strong></td><td>$50</td><td>ECP5-45K</td><td>32MB</td><td>資源多、雙網口</td><td>✅</td><td>⭐⭐⭐⭐⭐</td></tr>
<tr><td><strong>VisionFive 2</strong></td><td>$55</td><td>-</td><td>4GB</td><td>完整RISC-V電腦</td><td>✅</td><td>⭐⭐⭐⭐</td></tr>
</tbody></table>
</div>
<h3 id="選擇建議"><a class="header" href="#選擇建議">選擇建議</a></h3>
<ul>
<li><strong>初學者最佳</strong>: Milk-V Duo S（便宜、實用、可跑 Linux）</li>
<li><strong>FPGA 學習</strong>: ColorLight i5（開源工具鏈）</li>
<li><strong>高性能需求</strong>: ColorLight i9 或 Tang Primer 25K</li>
</ul>
<hr />
<h2 id="開發工具安裝"><a class="header" href="#開發工具安裝">開發工具安裝</a></h2>
<h3 id="1-基礎開發環境"><a class="header" href="#1-基礎開發環境">1. 基礎開發環境</a></h3>
<pre><code class="language-bash"># 更新系統
sudo apt update &amp;&amp; sudo apt upgrade -y

# 安裝基礎工具
sudo apt install -y \
    build-essential \
    git \
    wget \
    curl \
    python3 \
    python3-pip \
    cmake \
    ninja-build \
    gtkwave \
    vim \
    tmux

# 安裝 Python 套件
pip3 install --user \
    pyserial \
    pillow \
    numpy
</code></pre>
<h3 id="2-verilator-verilog-模擬器"><a class="header" href="#2-verilator-verilog-模擬器">2. Verilator (Verilog 模擬器)</a></h3>
<pre><code class="language-bash"># 方法一：從套件管理器安裝（簡單但版本較舊）
sudo apt install verilator

# 方法二：從源碼編譯最新版（推薦）
# 安裝必要依賴
sudo apt-get install git perl python3 make autoconf g++ flex bison ccache
sudo apt-get install libgoogle-perftools-dev numactl perl-doc
sudo apt-get install libfl2 libfl-dev zlibc zlib1g zlib1g-dev
sudo apt-get install help2man  # 生成 man pages 所需

# 克隆並編譯
git clone https://github.com/verilator/verilator
cd verilator
git checkout stable

# 配置安裝路徑（選擇其一）
# 選項 1: 安裝到系統目錄
./configure --prefix=/usr/local

# 選項 2: 安裝到自定義目錄（不需要 sudo）
./configure --prefix=$HOME/.mybin/verilator
# 記得將 $HOME/.mybin/verilator/bin 加入 PATH

# 編譯和安裝
make -j$(nproc)
make install  # 如果是系統目錄則需要 sudo make install

# 驗證安裝
verilator --version
</code></pre>
<h3 id="3-gtkwave-波形檢視器"><a class="header" href="#3-gtkwave-波形檢視器">3. GTKWave (波形檢視器)</a></h3>
<pre><code class="language-bash"># 安裝 GTKWave
sudo apt install gtkwave

# 測試安裝
gtkwave --version
</code></pre>
<h3 id="4-開源-fpga-工具鏈"><a class="header" href="#4-開源-fpga-工具鏈">4. 開源 FPGA 工具鏈</a></h3>
<h4 id="lattice-ecp5-工具鏈-適用於-colorlight"><a class="header" href="#lattice-ecp5-工具鏈-適用於-colorlight">Lattice ECP5 工具鏈 (適用於 ColorLight)</a></h4>
<pre><code class="language-bash"># 安裝 Yosys (綜合工具)
sudo apt install yosys

# 安裝 nextpnr-ecp5 (布局布線)
sudo apt install nextpnr-ecp5

# 安裝 prjtrellis (位流生成)
sudo apt install prjtrellis

# 安裝 openFPGALoader (燒錄工具)
# 方法一：從源碼編譯
git clone https://github.com/trabucayre/openFPGALoader.git
cd openFPGALoader
mkdir build &amp;&amp; cd build
cmake ..
make -j$(nproc)
sudo make install
</code></pre>
<h4 id="gowin-工具鏈-適用於-tang-nanoprimer"><a class="header" href="#gowin-工具鏈-適用於-tang-nanoprimer">Gowin 工具鏈 (適用於 Tang Nano/Primer)</a></h4>
<pre><code class="language-bash"># 下載 Gowin EDA (需要註冊)
# https://www.gowinsemi.com/en/support/download_eda/

# 解壓縮
tar -xzf Gowin_V1.9.9_linux.tar.gz

# 安裝依賴
sudo apt-get install -y \
    libglib2.0-0 \
    libpng16-16 \
    libfreetype6 \
    libfontconfig1 \
    libxrender1 \
    libsm6 \
    libice6 \
    libxext6 \
    libx11-6 \
    libqt5widgets5 \
    libqt5gui5 \
    libqt5core5a

# 設定環境變數 (加入 ~/.bashrc)
export GOWIN_HOME=/path/to/gowin
export PATH=$GOWIN_HOME/IDE/bin:$PATH
export LD_LIBRARY_PATH=$GOWIN_HOME/IDE/lib:$LD_LIBRARY_PATH

# 設定 USB 權限
sudo cp $GOWIN_HOME/IDE/bin/99-gowin.rules /etc/udev/rules.d/
sudo udevadm control --reload-rules
sudo udevadm trigger
</code></pre>
<hr />
<h2 id="模擬與除錯工具"><a class="header" href="#模擬與除錯工具">模擬與除錯工具</a></h2>
<h3 id="icarus-verilog-另一個模擬器選擇"><a class="header" href="#icarus-verilog-另一個模擬器選擇">Icarus Verilog (另一個模擬器選擇)</a></h3>
<pre><code class="language-bash"># 安裝 Icarus Verilog
sudo apt install iverilog

# 使用範例
iverilog -o test.vvp testbench.v design.v
vvp test.vvp
gtkwave dump.vcd
</code></pre>
<h3 id="簡單的-verilog-測試範例"><a class="header" href="#簡單的-verilog-測試範例">簡單的 Verilog 測試範例</a></h3>
<pre><code class="language-verilog">// counter.v
module counter(
    input clk,
    input reset,
    output reg [7:0] count
);
    always @(posedge clk) begin
        if (reset)
            count &lt;= 0;
        else
            count &lt;= count + 1;
    end
endmodule

// counter_tb.v
module counter_tb;
    reg clk = 0;
    reg reset = 1;
    wire [7:0] count;
    
    always #5 clk = ~clk;
    
    initial begin
        $dumpfile("counter.vcd");
        $dumpvars(0, counter_tb);
        #20 reset = 0;
        #200 $finish;
    end
    
    counter dut(
        .clk(clk),
        .reset(reset),
        .count(count)
    );
endmodule
</code></pre>
<pre><code class="language-bash"># 執行模擬
iverilog -o counter.vvp counter_tb.v counter.v
vvp counter.vvp
gtkwave counter.vcd
</code></pre>
<hr />
<h2 id="risc-v-開發環境"><a class="header" href="#risc-v-開發環境">RISC-V 開發環境</a></h2>
<h3 id="milk-v-duo-s-開發環境"><a class="header" href="#milk-v-duo-s-開發環境">Milk-V Duo S 開發環境</a></h3>
<pre><code class="language-bash"># 安裝交叉編譯工具鏈
wget https://github.com/milkv-duo/duo-buildroot-sdk/releases/download/v1.0.0/host-tools.tar.gz
tar -xzf host-tools.tar.gz
export PATH=$PATH:$(pwd)/host-tools/gcc/riscv64-linux-musl-x86_64/bin

# 安裝串口工具
sudo apt install minicom picocom screen

# 設定串口權限
sudo usermod -a -G dialout $USER
# 需要重新登入

# 連接 Duo S
# USB 串口通常是 /dev/ttyUSB0 或 /dev/ttyACM0
minicom -D /dev/ttyUSB0 -b 115200
</code></pre>
<h3 id="ssh-連接設定-duo-s"><a class="header" href="#ssh-連接設定-duo-s">SSH 連接設定 (Duo S)</a></h3>
<pre><code class="language-bash"># Duo S 透過網路連接
ssh root@192.168.42.1  # 預設 IP

# 或透過乙太網（Duo S 有 RJ45）
ssh root@[duo-s-ip]

# 設定 SSH 金鑰（免密碼登入）
ssh-keygen -t rsa
ssh-copy-id root@192.168.42.1
</code></pre>
<h3 id="編譯範例程式"><a class="header" href="#編譯範例程式">編譯範例程式</a></h3>
<pre><code class="language-c">// hello.c
#include &lt;stdio.h&gt;

int main() {
    printf("Hello from RISC-V!\n");
    return 0;
}
</code></pre>
<pre><code class="language-bash"># 交叉編譯
riscv64-linux-musl-gcc hello.c -o hello

# 傳送到 Duo S
scp hello root@192.168.42.1:/root/

# 在 Duo S 上執行
ssh root@192.168.42.1 ./hello
</code></pre>
<hr />
<h2 id="開源工具鏈"><a class="header" href="#開源工具鏈">開源工具鏈</a></h2>
<h3 id="litex-soc-生成框架"><a class="header" href="#litex-soc-生成框架">LiteX (SoC 生成框架)</a></h3>
<pre><code class="language-bash"># 安裝 LiteX
wget https://raw.githubusercontent.com/enjoy-digital/litex/master/litex_setup.py
python3 litex_setup.py --init --install

# 生成 RISC-V SoC 範例
cd litex-boards/litex_boards/targets
python3 colorlight_i5.py --build --cpu-type vexriscv
</code></pre>
<h3 id="risc-v-軟核實現"><a class="header" href="#risc-v-軟核實現">RISC-V 軟核實現</a></h3>
<pre><code class="language-bash"># PicoRV32
git clone https://github.com/YosysHQ/picorv32.git

# VexRiscv
git clone https://github.com/SpinalHDL/VexRiscv.git

# 使用 FuseSoC 管理
pip3 install fusesoc
fusesoc library add fusesoc-cores https://github.com/fusesoc/fusesoc-cores
fusesoc run --target=colorlight_i5 servant
</code></pre>
<hr />
<h2 id="實用資源連結"><a class="header" href="#實用資源連結">實用資源連結</a></h2>
<h3 id="官方資源"><a class="header" href="#官方資源">官方資源</a></h3>
<ul>
<li><a href="https://milkv.io/">Milk-V 官方</a></li>
<li><a href="https://wiki.sipeed.com/">Sipeed Wiki (Tang 系列)</a></li>
<li><a href="https://www.gowinsemi.com/">Gowin 半導體</a></li>
<li><a href="https://www.latticesemi.com/">Lattice 半導體</a></li>
</ul>
<h3 id="開源專案"><a class="header" href="#開源專案">開源專案</a></h3>
<ul>
<li><a href="https://github.com/enjoy-digital/litex">LiteX Framework</a></li>
<li><a href="https://github.com/YosysHQ/yosys">Yosys 綜合工具</a></li>
<li><a href="https://github.com/YosysHQ/nextpnr">nextpnr 布局布線</a></li>
<li><a href="https://github.com/trabucayre/openFPGALoader">OpenFPGALoader</a></li>
</ul>
<h3 id="colorlight-改裝資源"><a class="header" href="#colorlight-改裝資源">ColorLight 改裝資源</a></h3>
<ul>
<li><a href="https://github.com/q3k/chubby75">Chubby75 - ColorLight 5A-75B 逆向</a></li>
<li><a href="https://github.com/tomverbeure/colorlight_i5">ColorLight i5 資料</a></li>
<li><a href="https://github.com/wuxx/colorlight-i9">ColorLight i9 資料</a></li>
</ul>
<h3 id="學習資源"><a class="header" href="#學習資源">學習資源</a></h3>
<ul>
<li><a href="https://hdlbits.01xz.net/">HDLBits - Verilog 練習</a></li>
<li><a href="https://www.fpga4fun.com/">FPGA4Fun</a></li>
<li><a href="https://www.nandland.com/">Nandland FPGA 教程</a></li>
<li><a href="https://f4pga.readthedocs.io/">開源 FPGA 工具文檔</a></li>
</ul>
<h3 id="社群"><a class="header" href="#社群">社群</a></h3>
<ul>
<li><a href="https://discord.gg/c4Dnr3b">1BitSquared Discord</a></li>
<li><a href="https://web.libera.chat/##fpga">##fpga on libera.chat</a></li>
<li><a href="https://www.reddit.com/r/FPGA/">Reddit r/FPGA</a></li>
</ul>
<hr />
<h2 id="vim-開發環境設定"><a class="header" href="#vim-開發環境設定">Vim 開發環境設定</a></h2>
<h3 id="安裝-vim-和相關工具"><a class="header" href="#安裝-vim-和相關工具">安裝 Vim 和相關工具</a></h3>
<pre><code class="language-bash"># 安裝 Vim 8+ 或 Neovim
sudo apt install vim vim-gtk3  # Vim with clipboard support
# 或
sudo apt install neovim

# 安裝 ctags 和 cscope (程式碼導航)
sudo apt install universal-ctags cscope

# 安裝 ripgrep (快速搜尋)
sudo apt install ripgrep

# 安裝 fzf (模糊搜尋)
git clone --depth 1 https://github.com/junegunn/fzf.git ~/.fzf
~/.fzf/install
</code></pre>
<h3 id="verilogsystemverilog-vim-設定"><a class="header" href="#verilogsystemverilog-vim-設定">Verilog/SystemVerilog Vim 設定</a></h3>
<p>創建或編輯 <code>~/.vimrc</code>:</p>
<pre><code class="language-vim">" === 基礎設定 ===
set nocompatible
filetype plugin indent on
syntax on
set number relativenumber
set expandtab
set tabstop=4
set shiftwidth=4
set autoindent
set smartindent
set hlsearch
set incsearch
set ignorecase
set smartcase
set mouse=a
set clipboard=unnamedplus
set cursorline
set colorcolumn=80
set encoding=utf-8

" === Verilog 特定設定 ===
autocmd FileType verilog,systemverilog setlocal tabstop=2 shiftwidth=2
autocmd FileType verilog,systemverilog setlocal commentstring=//\ %s

" === 快捷鍵設定 ===
" Leader 鍵設為空格
let mapleader=" "

" 快速編譯 Verilog
autocmd FileType verilog nnoremap &lt;leader&gt;c :!iverilog -o %:r.vvp %&lt;CR&gt;
autocmd FileType verilog nnoremap &lt;leader&gt;r :!vvp %:r.vvp&lt;CR&gt;
autocmd FileType verilog nnoremap &lt;leader&gt;w :!gtkwave %:r.vcd &amp;&lt;CR&gt;

" 使用 Verilator
autocmd FileType verilog nnoremap &lt;leader&gt;v :!verilator --cc % --exe --trace&lt;CR&gt;

" === 自動補全括號 ===
inoremap ( ()&lt;Left&gt;
inoremap [ []&lt;Left&gt;
inoremap { {}&lt;Left&gt;
inoremap " ""&lt;Left&gt;

" === Verilog 程式碼片段 ===
" 輸入 ,mod 快速建立 module
autocmd FileType verilog inoreabbrev &lt;buffer&gt; ,mod module ()&lt;CR&gt;endmodule&lt;Up&gt;&lt;End&gt;&lt;Left&gt;
" 輸入 ,alw 快速建立 always block
autocmd FileType verilog inoreabbrev &lt;buffer&gt; ,alw always @(posedge clk) begin&lt;CR&gt;end&lt;Up&gt;&lt;End&gt;
" 輸入 ,iff 快速建立 if-else
autocmd FileType verilog inoreabbrev &lt;buffer&gt; ,iff if () begin&lt;CR&gt;end else begin&lt;CR&gt;end&lt;Up&gt;&lt;Up&gt;&lt;End&gt;&lt;Left&gt;&lt;Left&gt;&lt;Left&gt;&lt;Left&gt;&lt;Left&gt;&lt;Left&gt;&lt;Left&gt;

" === 狀態列 ===
set laststatus=2
set statusline=%F%m%r%h%w\ [%{&amp;ff}]\ [%Y]\ [POS=%l,%v]\ [%p%%]\ [LEN=%L]
</code></pre>
<h3 id="安裝-vim-插件管理器-vim-plug"><a class="header" href="#安裝-vim-插件管理器-vim-plug">安裝 Vim 插件管理器 (vim-plug)</a></h3>
<pre><code class="language-bash"># 安裝 vim-plug
curl -fLo ~/.vim/autoload/plug.vim --create-dirs \
    https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
</code></pre>
<h3 id="配置-vim-插件-vimrc-續"><a class="header" href="#配置-vim-插件-vimrc-續">配置 Vim 插件 (~/.vimrc 續)</a></h3>
<pre><code class="language-vim">" === vim-plug 插件管理 ===
call plug#begin('~/.vim/plugged')

" Verilog 語法高亮增強
Plug 'vhda/verilog_systemverilog.vim'

" 檔案瀏覽器
Plug 'preservim/nerdtree'

" 模糊搜尋
Plug 'junegunn/fzf', { 'do': { -&gt; fzf#install() } }
Plug 'junegunn/fzf.vim'

" 註釋工具
Plug 'preservim/nerdcommenter'

" Git 整合
Plug 'tpope/vim-fugitive'
Plug 'airblade/vim-gitgutter'

" 自動補全 (選擇性)
" Plug 'neoclide/coc.nvim', {'branch': 'release'}

" 顏色主題
Plug 'morhetz/gruvbox'
Plug 'joshdick/onedark.vim'

" 狀態列美化
Plug 'vim-airline/vim-airline'
Plug 'vim-airline/vim-airline-themes'

" 程式碼標籤
Plug 'preservim/tagbar'

" 多游標
Plug 'terryma/vim-multiple-cursors'

call plug#end()

" === 插件設定 ===
" NERDTree
nnoremap &lt;leader&gt;n :NERDTreeToggle&lt;CR&gt;
let NERDTreeShowHidden=1

" FZF
nnoremap &lt;leader&gt;f :Files&lt;CR&gt;
nnoremap &lt;leader&gt;b :Buffers&lt;CR&gt;
nnoremap &lt;leader&gt;g :Rg&lt;CR&gt;

" Tagbar
nnoremap &lt;leader&gt;t :TagbarToggle&lt;CR&gt;

" 顏色主題
colorscheme gruvbox
set background=dark

" Airline
let g:airline_powerline_fonts = 1
let g:airline#extensions#tabline#enabled = 1
</code></pre>
<h3 id="安裝插件"><a class="header" href="#安裝插件">安裝插件</a></h3>
<pre><code class="language-bash"># 在 Vim 中執行
:PlugInstall
</code></pre>
<h3 id="verilog-專用工具整合"><a class="header" href="#verilog-專用工具整合">Verilog 專用工具整合</a></h3>
<p>創建 <code>~/.vim/ftplugin/verilog.vim</code>:</p>
<pre><code class="language-vim">" Verilog 檔案專用設定

" === Verilator 整合 ===
function! VerilatorCompile()
    let l:filename = expand('%')
    let l:output = system('verilator --lint-only ' . l:filename . ' 2&gt;&amp;1')
    if v:shell_error != 0
        echo l:output
    else
        echo "Verilator: No lint errors found!"
    endif
endfunction

nnoremap &lt;buffer&gt; &lt;leader&gt;l :call VerilatorCompile()&lt;CR&gt;

" === 自動格式化 ===
" 需要安裝 verible-verilog-format
if executable('verible-verilog-format')
    setlocal formatprg=verible-verilog-format\ -
endif

" === Ctags 設定 ===
" 產生 tags 檔案
nnoremap &lt;buffer&gt; &lt;leader&gt;ct :!ctags -R --languages=Verilog .&lt;CR&gt;

" === 快速跳轉 ===
" 跳到 module 定義
nnoremap &lt;buffer&gt; gd :tag &lt;C-r&gt;&lt;C-w&gt;&lt;CR&gt;
" 返回
nnoremap &lt;buffer&gt; gb &lt;C-t&gt;
</code></pre>
<h3 id="tmux-整合-多視窗開發"><a class="header" href="#tmux-整合-多視窗開發">Tmux 整合 (多視窗開發)</a></h3>
<p>創建 <code>~/.tmux.conf</code>:</p>
<pre><code class="language-bash"># 基礎設定
set -g default-terminal "screen-256color"
set -g mouse on
set -g history-limit 10000

# 設定前綴鍵為 Ctrl+a
unbind C-b
set-option -g prefix C-a
bind-key C-a send-prefix

# 分割視窗
bind | split-window -h
bind - split-window -v

# Vim 風格切換視窗
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# 重新載入設定
bind r source-file ~/.tmux.conf \; display "Reloaded!"

# 狀態列
set -g status-bg black
set -g status-fg white
set -g status-left '#[fg=green]#S '
set -g status-right '#[fg=yellow]#(date +"%Y-%m-%d %H:%M")'
</code></pre>
<h3 id="fpga-開發-tmux-工作流程"><a class="header" href="#fpga-開發-tmux-工作流程">FPGA 開發 Tmux 工作流程</a></h3>
<pre><code class="language-bash">#!/bin/bash
# fpga_dev.sh - FPGA 開發環境啟動腳本

tmux new-session -d -s fpga
tmux rename-window 'Editor'
tmux send-keys 'vim' C-m

tmux new-window -n 'Compile'
tmux new-window -n 'Simulate'
tmux new-window -n 'Terminal'

tmux select-window -t 1
tmux attach-session -t fpga
</code></pre>
<h3 id="遠端開發設定-ssh--vim"><a class="header" href="#遠端開發設定-ssh--vim">遠端開發設定 (SSH + Vim)</a></h3>
<pre><code class="language-bash"># ~/.ssh/config
Host duo-s
    HostName 192.168.42.1
    User root
    ForwardAgent yes
    Compression yes

# 同步 Vim 設定到遠端
scp ~/.vimrc duo-s:~/
scp -r ~/.vim duo-s:~/

# SSH + Tmux 持續會話
ssh duo-s -t tmux attach || tmux new
</code></pre>
<hr />
<h2 id="快速開始腳本"><a class="header" href="#快速開始腳本">快速開始腳本</a></h2>
<pre><code class="language-bash">#!/bin/bash
# setup_fpga_env.sh

echo "=== Ubuntu FPGA 開發環境安裝腳本 ==="

# 基礎工具
echo "安裝基礎工具..."
sudo apt update
sudo apt install -y build-essential git wget curl python3 python3-pip \
    cmake ninja-build gtkwave vim vim-gtk3 neovim tmux iverilog verilator \
    minicom picocom screen universal-ctags cscope ripgrep

# Python 套件
echo "安裝 Python 套件..."
pip3 install --user pyserial pillow numpy fusesoc

# 開源 FPGA 工具
echo "安裝開源 FPGA 工具..."
sudo apt install -y yosys nextpnr-ecp5 prjtrellis

# 設定 USB 權限
echo "設定 USB 權限..."
sudo usermod -a -G dialout $USER

echo "=== 安裝完成 ==="
echo "請重新登入以套用群組變更"
echo "記得下載對應的商業工具（如 Gowin EDA）如果需要"
</code></pre>
<hr />
<h2 id="故障排除"><a class="header" href="#故障排除">故障排除</a></h2>
<h3 id="usb-權限問題"><a class="header" href="#usb-權限問題">USB 權限問題</a></h3>
<pre><code class="language-bash"># 檢查群組
groups

# 加入 dialout 群組
sudo usermod -a -G dialout $USER

# 重新載入 udev 規則
sudo udevadm control --reload-rules
sudo udevadm trigger
</code></pre>
<h3 id="找不到串口設備"><a class="header" href="#找不到串口設備">找不到串口設備</a></h3>
<pre><code class="language-bash"># 列出所有串口
ls /dev/tty*

# 檢查 USB 設備
lsusb

# 查看核心訊息
dmesg | tail -20
</code></pre>
<h3 id="verilator-編譯錯誤"><a class="header" href="#verilator-編譯錯誤">Verilator 編譯錯誤</a></h3>
<pre><code class="language-bash"># 檢查版本
verilator --version

# 清理並重新編譯
make clean
verilator --cc design.v --exe tb.cpp --trace
make -C obj_dir -f Vdesign.mk
</code></pre>
<hr />
<h2 id="總結"><a class="header" href="#總結">總結</a></h2>
<p>這份指南涵蓋了在 Ubuntu 上進行 FPGA 開發所需的所有基礎工具和設定。建議的學習路徑：</p>
<ol>
<li><strong>開始</strong>: 安裝基礎工具，選擇開發板</li>
<li><strong>學習</strong>: 使用 Verilator + GTKWave 模擬簡單電路</li>
<li><strong>實作</strong>: 購買 Milk-V Duo S 或 ColorLight i5 實際操作</li>
<li><strong>進階</strong>: 實現 RISC-V 軟核，跑 Linux</li>
</ol>
<p>記得經常更新工具並參與社群討論！</p>
<hr />
<p><em>最後更新：2024年</em></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../embedded_systems/fpga_vs_mcu_comparison.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../embedded_systems/verilator_complete_guide.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../embedded_systems/fpga_vs_mcu_comparison.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../embedded_systems/verilator_complete_guide.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="../ace.js"></script>
        <script src="../mode-rust.js"></script>
        <script src="../editor.js"></script>
        <script src="../theme-dawn.js"></script>
        <script src="../theme-tomorrow_night.js"></script>

        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../mermaid.min.js"></script>
        <script src="../mermaid-init.js"></script>



    </div>
    </body>
</html>
