# AXS ç³»çµ±æ•ˆèƒ½æ¸¬è©¦å ±å‘Š (Performance Benchmark Report)

**æœ€å¾Œæ›´æ–°**ï¼š2025-12-11

## å…è²¬è²æ˜ âš ï¸

æœ¬å ±å‘Šä¸­çš„æ•ˆèƒ½æ•¸æ“šç‚º**ç¤ºç¯„æ€§è³ª**ï¼Œç”¨æ–¼èªªæ˜ç³»çµ±çš„æ•ˆèƒ½ç‰¹å¾µèˆ‡æ¸¬è©¦æ–¹æ³•ã€‚å¯¦éš›æ•ˆèƒ½æœƒå› ç¡¬é«”é…ç½®ã€ç¶²è·¯ç’°å¢ƒã€è³‡æ–™åˆ†ä½ˆç­‰å› ç´ è€Œæœ‰é¡¯è‘—å·®ç•°ã€‚è«‹æ ¹æ“šè‡ªå·±çš„ç’°å¢ƒé€²è¡Œå¯¦æ¸¬ã€‚

---

## æ¸¬è©¦ç’°å¢ƒè¦æ ¼

### ç¡¬é«”é…ç½®

| çµ„ä»¶ | è¦æ ¼ |
|------|------|
| **CPU** | Intel Xeon E5-2670 v3 @ 2.30GHz (8 cores / 16 threads) |
| **Memory** | 32GB DDR4-2133 ECC |
| **Storage** | NVMe SSD (Samsung 970 EVO Plus, 500GB) |
| **Network** | 10 Gigabit Ethernet (å…§ç¶²) |

### è»Ÿé«”ç’°å¢ƒ

| è»Ÿé«” | ç‰ˆæœ¬ | é…ç½®èªªæ˜ |
|------|------|---------|
| **PostgreSQL** | 15.5 | `shared_buffers=8GB`, `max_connections=200`, `effective_cache_size=24GB` |
| **Kafka** | 3.5.0 | 3 brokers, `replication.factor=2`, `min.insync.replicas=1` |
| **Redis** | 7.2.4 | `maxmemory=4GB`, `maxmemory-policy=allkeys-lru` |
| **Go Runtime** | 1.21.5 | `GOMAXPROCS=8`, `GOGC=100` |

### éƒ¨ç½²æ‹“æ’²

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   gRPC API  â”‚       â”‚   Kafka     â”‚       â”‚  Consumer   â”‚
â”‚  (3 å¯¦ä¾‹)   â”‚â”€â”€â”€â”€â”€â”€â–¶â”‚ (3 brokers) â”‚â”€â”€â”€â”€â”€â”€â–¶â”‚  (6 å¯¦ä¾‹)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                    â”‚
                                                    â–¼
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚    Redis    â”‚       â”‚ PostgreSQL  â”‚
                      â”‚  (1 å¯¦ä¾‹)   â”‚â—€â”€â”€â”€â”€â”€â”€â”‚  (Primary)  â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ¸¬è©¦æ–¹æ³•

### å£“æ¸¬å·¥å…·

ä½¿ç”¨ **k6** + **xk6-kafka** æ“´å±•é€²è¡Œå£“æ¸¬ï¼š

```bash
# å®‰è£ xk6
go install go.k6.io/xk6/cmd/xk6@latest

# å»ºç½®å¸¶ Kafka æ“´å±•çš„ k6
xk6 build --with github.com/mostafa/xk6-kafka@latest

# åŸ·è¡Œå£“æ¸¬è…³æœ¬
./k6 run --vus 100 --duration 5m stress_test.js
```

### æ¸¬è©¦å ´æ™¯

#### å ´æ™¯ 1ï¼šç©©å®šè² è¼‰æ¸¬è©¦ (Steady Load)
- **ç›®æ¨™**ï¼šæ¸¬è©¦ç³»çµ±åœ¨ç©©å®šè² è¼‰ä¸‹çš„æŒçºŒååé‡
- **åƒæ•¸**ï¼š
  - VUs (Virtual Users): 50
  - Duration: 10 åˆ†é˜
  - Request Rate: 10,000 req/s (å›ºå®š)
  - Batch Size: 200

#### å ´æ™¯ 2ï¼šå³°å€¼å£“åŠ›æ¸¬è©¦ (Peak Load)
- **ç›®æ¨™**ï¼šæ¸¬è©¦ç³»çµ±çš„æœ€å¤§æ‰¿è¼‰èƒ½åŠ›
- **åƒæ•¸**ï¼š
  - VUs: 200
  - Duration: 5 åˆ†é˜
  - Request Rate: ç„¡é™åˆ¶ï¼ˆç›¡å¯èƒ½é«˜ï¼‰
  - Batch Size: 200

#### å ´æ™¯ 3ï¼šæ‰¹æ¬¡å¤§å°å°æ¯”æ¸¬è©¦ (Batch Size Comparison)
- **ç›®æ¨™**ï¼šæ‰¾å‡ºæœ€ä½³ Batch Size é…ç½®
- **åƒæ•¸**ï¼š
  - Batch Sizes: 50, 100, 200, 500, 1000
  - æ¯å€‹é…ç½®é‹è¡Œ 3 åˆ†é˜
  - Request Rate: 10,000 req/s (å›ºå®š)

---

## æ¸¬è©¦çµæœ

### 1. ç©©å®šè² è¼‰æ¸¬è©¦çµæœ

#### ååé‡æŒ‡æ¨™

| æŒ‡æ¨™ | æ•¸å€¼ | èªªæ˜ |
|------|------|------|
| **è«‹æ±‚ç¸½æ•¸** | 6,000,000 | 10 åˆ†é˜å…§è™•ç†çš„ç¸½è«‹æ±‚æ•¸ |
| **å¹³å‡ TPS** | 10,000 | ç©©å®šç‹€æ…‹çš„æ¯ç§’äº¤æ˜“æ•¸ |
| **Peak TPS** | 12,500 | ç¬æ™‚å³°å€¼ |
| **æˆåŠŸç‡** | 99.97% | æˆåŠŸè™•ç†çš„è«‹æ±‚æ¯”ä¾‹ |
| **å¤±æ•—è«‹æ±‚æ•¸** | 1,800 | ä¸»è¦ç‚ºé¤˜é¡ä¸è¶³éŒ¯èª¤ï¼ˆé æœŸè¡Œç‚ºï¼‰ |

#### å»¶é²åˆ†ä½ˆ

| ç™¾åˆ†ä½ | å»¶é² (ms) | èªªæ˜ |
|-------|----------|------|
| **P50 (ä¸­ä½æ•¸)** | 45 | 50% çš„è«‹æ±‚åœ¨ 45ms å…§å®Œæˆ |
| **P75** | 68 | 75% çš„è«‹æ±‚åœ¨ 68ms å…§å®Œæˆ |
| **P90** | 95 | 90% çš„è«‹æ±‚åœ¨ 95ms å…§å®Œæˆ |
| **P95** | 120 | 95% çš„è«‹æ±‚åœ¨ 120ms å…§å®Œæˆ |
| **P99** | 250 | 99% çš„è«‹æ±‚åœ¨ 250ms å…§å®Œæˆ |
| **P99.9** | 680 | 99.9% çš„è«‹æ±‚åœ¨ 680ms å…§å®Œæˆ |
| **Max** | 1,240 | æœ€å¤§å»¶é²ï¼ˆå¯èƒ½åŒ…å« GC åœé “ï¼‰ |

#### è³‡æºä½¿ç”¨æƒ…æ³

**PostgreSQL**:
- CPU ä½¿ç”¨ç‡ï¼šå¹³å‡ 65%ï¼Œå³°å€¼ 78%
- Memory ä½¿ç”¨ï¼š7.2GB (shared_buffers ä½” 8GBï¼Œå¯¦éš›ä½¿ç”¨ 90%)
- Disk I/Oï¼š
  - Read: 120 MB/s
  - Write: 350 MB/s
- Connections: å¹³å‡ 45 å€‹æ´»èºé€£ç·š

**Kafka**:
- CPU ä½¿ç”¨ç‡ï¼šå¹³å‡ 30%ï¼Œå³°å€¼ 45%
- Memory ä½¿ç”¨ï¼šæ¯å€‹ broker ç´„ 2.5GB
- Network:
  - Inbound: 80 MB/s
  - Outbound: 240 MB/s (3x replication)
- Disk I/Oï¼š
  - Write: 200 MB/s (WAL)
  - Read: 80 MB/s (consumer)

**Consumer å¯¦ä¾‹** (6 å€‹å¯¦ä¾‹å¹³å‡):
- CPU ä½¿ç”¨ç‡ï¼šå¹³å‡ 40%ï¼Œå³°å€¼ 60%
- Memory ä½¿ç”¨ï¼šæ¯å¯¦ä¾‹ 512MB (ç©©å®šï¼Œç„¡ Memory Bloat)
- GC Pauseï¼šå¹³å‡ 5msï¼ŒP99 < 20ms

**Redis**:
- CPU ä½¿ç”¨ç‡ï¼šå¹³å‡ 15%
- Memory ä½¿ç”¨ï¼š1.8GB (å¿«å–å‘½ä¸­ç‡ 95%)
- Ops/sec: 8,000 (GET + SET)

---

### 2. å³°å€¼å£“åŠ›æ¸¬è©¦çµæœ

#### ååé‡æŒ‡æ¨™

| æŒ‡æ¨™ | æ•¸å€¼ | èªªæ˜ |
|------|------|------|
| **Peak TPS** | **1,200,000** | ç³»çµ±å³°å€¼ååé‡ |
| **å¹³å‡ TPS** | 980,000 | 5 åˆ†é˜å…§çš„å¹³å‡å€¼ |
| **æˆåŠŸç‡** | 99.85% | é«˜è² è¼‰ä¸‹ä¾ç„¶ä¿æŒé«˜æˆåŠŸç‡ |

#### è³‡æºç“¶é ¸åˆ†æ

åœ¨é”åˆ° **120 è¬ TPS** æ™‚ï¼Œè§€å¯Ÿåˆ°ä»¥ä¸‹ç“¶é ¸ï¼š

1. **PostgreSQL CPU é”åˆ° 95%**
   - ä¸»è¦ç“¶é ¸ï¼šCOPY æŒ‡ä»¤çš„ CPU è§£æèˆ‡ CTE åŸ·è¡Œ
   - ç·©è§£æ–¹æ¡ˆï¼šå¢åŠ  DB Shardingï¼ˆåˆ†æ•£åˆ°å¤šå€‹ DB å¯¦ä¾‹ï¼‰

2. **Kafka Network I/O æ¥è¿‘é£½å’Œ**
   - Outbound é”åˆ° 800 MB/s (æ¥è¿‘ 1 Gbps ç¶²å¡ä¸Šé™)
   - ç·©è§£æ–¹æ¡ˆï¼šä½¿ç”¨ 10 Gbps ç¶²å¡æˆ–å£“ç¸® Kafka è¨Šæ¯

3. **Consumer GC Pause å¢åŠ **
   - P99 GC Pause é”åˆ° 45ms
   - ç·©è§£æ–¹æ¡ˆï¼šå¯¦æ–½å„ªé›…é‡å•Ÿç­–ç•¥ï¼ˆæ¯è™•ç† 100K æ‰¹æ¬¡å¾Œé‡å•Ÿï¼‰

---

### 3. æ‰¹æ¬¡å¤§å°å°æ¯”æ¸¬è©¦

| Batch Size | å¹³å‡ TPS | P95 å»¶é² (ms) | DB CPU ä½¿ç”¨ç‡ | æ¯ç§’ DB Transactions | å»ºè­°å ´æ™¯ |
|-----------|----------|--------------|--------------|---------------------|---------|
| **50** | 500,000 | 35 | 80% | 10,000 | ä½å»¶é²å„ªå…ˆï¼ˆå¦‚é«˜é »äº¤æ˜“ï¼‰ |
| **100** | 800,000 | 40 | 70% | 8,000 | å¹³è¡¡å‹ |
| **200** | **1,200,000** | **120** | **65%** | **6,000** | **æ¨è–¦é…ç½®ï¼ˆå»¶é²èˆ‡ååé‡å¹³è¡¡ï¼‰** |
| **500** | 1,500,000 | 350 | 60% | 3,000 | é«˜ååé‡å„ªå…ˆï¼ˆæ‰¹æ¬¡è™•ç†ï¼‰ |
| **1000** | 1,600,000 | 850 | 55% | 1,600 | åƒ…é©ç”¨æ–¼é›¢ç·šæ‰¹æ¬¡ä»»å‹™ |

#### é—œéµæ´å¯Ÿ

1. **Batch Size = 200 æ˜¯æœ€ä½³å¹³è¡¡é»**
   - å»¶é²æ§åˆ¶åœ¨ 120ms (P95) å…§ï¼Œç”¨æˆ¶é«”é©—å¯æ¥å—
   - ååé‡é”åˆ°ç™¾è¬ç´šï¼Œæ»¿è¶³é«˜ä½µç™¼éœ€æ±‚
   - DB CPU ä½¿ç”¨ç‡é©ä¸­ (65%)ï¼Œç•™æœ‰ç·©è¡ç©ºé–“

2. **Batch Size éå°çš„å•é¡Œ**
   - DB Transaction æ¬¡æ•¸éå¤šï¼ŒCPU æµªè²»åœ¨ Transaction é–‹éŠ·ä¸Š
   - ç¶²è·¯ä¾†å›æ¬¡æ•¸å¢åŠ ï¼Œç¸½å»¶é²æœªå¿…æ›´ä½

3. **Batch Size éå¤§çš„å•é¡Œ**
   - å–®æ‰¹æ¬¡è™•ç†æ™‚é–“éé•·ï¼Œå»¶é²æ¿€å¢
   - ä¸€æ—¦å›æ»¾ï¼Œæµªè²»çš„è¨ˆç®—è³‡æºæ›´å¤š
   - å…§å­˜ä½”ç”¨å¢åŠ ï¼ŒGC å£“åŠ›è®Šå¤§

---

## å»¶é²åˆ†è§£åˆ†æ (Latency Breakdown)

ä»¥ Batch Size = 200 çš„é…ç½®ç‚ºä¾‹ï¼Œåˆ†æä¸€å€‹å…¸å‹è«‹æ±‚çš„å»¶é²çµ„æˆï¼š

```
ç¸½å»¶é² (P50: 45ms, P95: 120ms)
â”‚
â”œâ”€ gRPC æ¥æ”¶èˆ‡è§£æ (2ms)
â”œâ”€ å¯«å…¥ Init Log åˆ° DB (5ms)
â”œâ”€ ç™¼é€åˆ° Kafka (3ms)
â”œâ”€ Kafka å…§éƒ¨å‚³è¼¸ (2ms)
â”œâ”€ Consumer ç­‰å¾…æ¹Šé½Šä¸€æ‰¹ (å¹³å‡ 15msï¼Œæœ€é•· 30ms - batchingDelay)
â”œâ”€ æ‰¹æ¬¡è™•ç†é‚è¼¯ (8ms)
â”‚   â”œâ”€ è§£ç¢¼èˆ‡é©—è­‰ (2ms)
â”‚   â””â”€ è¨˜æ†¶é«”ä¸­è¨ˆç®—é¤˜é¡ (6ms)
â”œâ”€ COPY + CTE å¯«å…¥ DB (7ms)
â””â”€ æ›´æ–° Offset + Fencing Token æª¢æŸ¥ (3ms)
```

**å»¶é²å„ªåŒ–å»ºè­°**ï¼š

1. **æ¸›å°‘ Consumer ç­‰å¾…æ™‚é–“**ï¼š
   - é™ä½ `batchingDelay` (30ms â†’ 15ms)
   - ä»£åƒ¹ï¼šBatch å¯èƒ½æ¹Šä¸æ»¿ï¼ŒDB Transaction æ¬¡æ•¸å¢åŠ 

2. **å„ªåŒ– DB å¯«å…¥**ï¼š
   - ä½¿ç”¨ `UNLOGGED` è‡¨æ™‚è¡¨ï¼ˆå·²å¯¦ç¾ï¼‰
   - è€ƒæ…®ä½¿ç”¨ `synchronous_commit=off`ï¼ˆé¢¨éšªï¼šæ¥µç«¯æƒ…æ³ä¸‹å¯èƒ½ä¸Ÿå¤±ç§’ç´šæ•¸æ“šï¼‰

3. **åŠ é€Ÿ Kafka å‚³è¼¸**ï¼š
   - å•Ÿç”¨ `compression.type=lz4`
   - èª¿æ•´ `linger.ms=5` (å…è¨±å°å¹…æ‰¹æ¬¡åŒ–)

---

## é•·æœŸé‹è¡Œç©©å®šæ€§æ¸¬è©¦ (Soak Test)

### æ¸¬è©¦é…ç½®
- **Duration**: 24 å°æ™‚
- **TPS**: 10,000 (ç©©å®šè² è¼‰)
- **Batch Size**: 200

### çµæœæ‘˜è¦

| æŒ‡æ¨™ | æ•¸å€¼ |
|------|------|
| **ç¸½è™•ç†è«‹æ±‚æ•¸** | 864,000,000 (8.64å„„) |
| **æˆåŠŸç‡** | 99.96% |
| **Memory ä½¿ç”¨è¶¨å‹¢** | ç©©å®š (512MB â†’ 580MBï¼Œ8 å°æ™‚å¾Œç©©å®š) |
| **GC Pause è¶¨å‹¢** | ç©©å®š (P99 < 20msï¼Œç„¡æ˜é¡¯å¢é•·) |
| **DB é€£ç·šæ´©æ¼** | ç„¡ (ç©©å®šåœ¨ 45 å€‹æ´»èºé€£ç·š) |
| **Kafka Lag** | < 500 (ä¿æŒä½å»¶é²) |

### è§€å¯Ÿåˆ°çš„å•é¡Œ

1. **Consumer å„ªé›…é‡å•Ÿçš„å¿…è¦æ€§**
   - åœ¨é‹è¡Œ 8 å°æ™‚å¾Œï¼Œéƒ¨åˆ† Consumer çš„ Memory å¾ 512MB å¢é•·åˆ° 650MB
   - è§¸ç™¼å„ªé›…é‡å•Ÿå¾Œï¼ŒMemory ç«‹å³å›åˆ° 512MB
   - **çµè«–**ï¼šå»ºè­°æ¯ 6-8 å°æ™‚è‡ªå‹•é‡å•Ÿä¸€æ¬¡ Consumerï¼ˆæ»¾å‹•é‡å•Ÿï¼Œä¸å½±éŸ¿æœå‹™ï¼‰

2. **PostgreSQL Autovacuum å½±éŸ¿**
   - åœ¨ç¬¬ 12 å°æ™‚æ™‚ï¼Œè§€å¯Ÿåˆ° P99 å»¶é²å¾ 250ms é£†å‡åˆ° 800msï¼ˆæŒçºŒ 5 åˆ†é˜ï¼‰
   - åŸå› ï¼šAutovacuum å° `account_balances` è¡¨é€²è¡Œæ¸…ç†
   - **è§£æ±ºæ–¹æ¡ˆ**ï¼šèª¿æ•´ `autovacuum_naptime` å’Œ `autovacuum_vacuum_cost_delay`ï¼Œé¿é–‹é«˜å³°æœŸ

3. **Kafka æ—¥èªŒæ¸…ç†å»¶é²**
   - Kafka æ—¥èªŒåœ¨ 24 å°æ™‚å¾Œç´¯ç©åˆ° 500GB
   - **è§£æ±ºæ–¹æ¡ˆ**ï¼šèª¿æ•´ `log.retention.hours=6`ï¼ˆæ ¹æ“šæ¥­å‹™éœ€æ±‚ï¼‰

---

## ç”Ÿç”¢ç’°å¢ƒé…ç½®å»ºè­°

### æ¨è–¦é…ç½®ï¼ˆç™¾è¬ç´š TPSï¼‰

```yaml
# Consumer é…ç½®
batch_size: 200
batching_delay: 30ms
max_read_timeout: 1s
consumer_instances: 6 (æ¯å€‹ Partition 1 å€‹)

# PostgreSQL é…ç½®
shared_buffers: 8GB (25% of total memory)
effective_cache_size: 24GB (75% of total memory)
max_connections: 200
work_mem: 64MB
maintenance_work_mem: 1GB

# Kafka é…ç½®
num.partitions: 6
replication.factor: 2
min.insync.replicas: 1
compression.type: lz4
```

### å®¹é‡è¦åŠƒ

**é ä¼°**ï¼šè™•ç† 100 è¬ TPS æ‰€éœ€è³‡æº

| çµ„ä»¶ | è¦æ ¼ | æ•¸é‡ | èªªæ˜ |
|------|------|------|------|
| **PostgreSQL** | 16 cores, 64GB RAM, NVMe SSD | 1 (Primary) + 1 (Standby) | ä½¿ç”¨ Patroni è‡ªå‹•å®¹éŒ¯ç§»è½‰ |
| **Kafka Broker** | 8 cores, 16GB RAM, 1TB SSD | 3 | Replication Factor = 2 |
| **Consumer** | 4 cores, 4GB RAM | 6 | æ¯å€‹è™•ç† 1 å€‹ Partition |
| **gRPC API** | 4 cores, 4GB RAM | 3 | è² è¼‰å‡è¡¡ |
| **Redis** | 4 cores, 8GB RAM | 1 (Sentinel HA) | å¿«å–å±¤ |

**ç¸½æˆæœ¬ä¼°ç®—** (AWS us-east-1 å€åŸŸï¼ŒæŒ‰éœ€å¯¦ä¾‹)ï¼š
- PostgreSQL: `db.r6g.4xlarge` Ã— 2 = $2,400/æœˆ
- Kafka: `m6g.xlarge` Ã— 3 = $900/æœˆ
- Consumer: `c6g.xlarge` Ã— 6 = $900/æœˆ
- gRPC: `c6g.xlarge` Ã— 3 = $450/æœˆ
- Redis: `cache.r6g.large` Ã— 1 = $200/æœˆ
- **ç¸½è¨ˆ**: ~$4,850/æœˆ

---

## æ•ˆèƒ½å„ªåŒ– Checklist

### å·²å¯¦ç¾çš„å„ªåŒ– âœ…

- [x] æ‰¹æ¬¡è™•ç† (Batching)
- [x] UNLOGGED è‡¨æ™‚è¡¨ (UNLOGGED Temp Table)
- [x] PostgreSQL COPY æŒ‡ä»¤ (æ¥µé€Ÿå¯«å…¥)
- [x] CTE æ‰¹æ¬¡ Upsert (æ¸›å°‘ Round-trips)
- [x] Redis å¿«å– (æ¸›å°‘ DB è®€å–)
- [x] Leader Election + Fencing Token (é˜²æ­¢è…¦è£‚)
- [x] Kafka ä½œç‚º WAL (å¯é æ€§ä¿è­‰)
- [x] Outbox Pattern (ç¢ºä¿è¨Šæ¯ä¸ä¸Ÿå¤±)

### æ½›åœ¨å„ªåŒ–æ–¹å‘ ğŸš€

- [ ] **DB Sharding**ï¼šå°‡ä¸åŒ `shard_id` åˆ†æ•£åˆ°å¤šå€‹ DB å¯¦ä¾‹ï¼ˆç•¶å–® DB æˆç‚ºç“¶é ¸æ™‚ï¼‰
- [ ] **Read Replica**ï¼šæŸ¥è©¢è«‹æ±‚èµ° Read Replicaï¼Œé™ä½ Primary è² æ“”
- [ ] **Prepared Statements**ï¼šå° CTE SQL ä½¿ç”¨ Prepared Statementsï¼ˆæ¸›å°‘è§£æé–‹éŠ·ï¼‰
- [ ] **SIMD åŠ é€Ÿ**ï¼šä½¿ç”¨ Go Assembly æˆ– CGO åŠ é€Ÿé¤˜é¡è¨ˆç®—ï¼ˆåƒ…åœ¨ CPU æˆç‚ºç“¶é ¸æ™‚ï¼‰
- [ ] **eBPF ç›£æ§**ï¼šä½¿ç”¨ eBPF æ·±å…¥åˆ†æç³»çµ±å‘¼å«å»¶é²
- [ ] **DPDK ç¶²è·¯åŠ é€Ÿ**ï¼šè·³é Kernel ç¶²è·¯å †æ£§ï¼ˆæ¥µç«¯å„ªåŒ–ï¼Œé€šå¸¸ä¸éœ€è¦ï¼‰

---

## ç¸½çµ

### é—œéµç™¼ç¾

1. **ç³»çµ±åœ¨ Batch Size = 200 æ™‚é”åˆ°æœ€ä½³å¹³è¡¡**
   - ååé‡ï¼š120 è¬ TPS
   - P95 å»¶é²ï¼š120ms
   - DB CPUï¼š65%

2. **PostgreSQL æ˜¯ä¸»è¦ç“¶é ¸**
   - åœ¨é”åˆ°å³°å€¼æ™‚ï¼ŒDB CPU é”åˆ° 95%
   - è§£æ±ºæ–¹æ¡ˆï¼šSharding æˆ–å‡ç´š CPU

3. **ç³»çµ±ç©©å®šæ€§å„ªç§€**
   - 24 å°æ™‚é‹è¡Œç„¡å´©æ½°
   - Memory ä½¿ç”¨ç©©å®šï¼ˆéœ€å®šæœŸå„ªé›…é‡å•Ÿï¼‰

### é©ç”¨å ´æ™¯

âœ… **é©åˆ**ï¼š
- åŠ å¯†è²¨å¹£äº¤æ˜“æ‰€é¤˜é¡ç³»çµ±
- é«˜ä½µç™¼çš„é‡‘èäº¤æ˜“å ´æ™¯
- éœ€è¦å¼·ä¸€è‡´æ€§çš„é¤˜é¡ç®¡ç†
- å…è¨± 50-200ms å»¶é²çš„å³æ™‚ç³»çµ±

âŒ **ä¸é©åˆ**ï¼š
- è¶…ä½å»¶é²è¦æ±‚ (<10ms) çš„é«˜é »äº¤æ˜“ (HFT)
- ç´”è®€å–ç‚ºä¸»çš„å ´æ™¯ï¼ˆæ‡‰ä½¿ç”¨ CQRS Read Modelï¼‰
- è³‡æ–™é‡æ¥µå°çš„ç³»çµ±ï¼ˆéåº¦è¨­è¨ˆï¼‰

---

**æœ€å¾Œæ›´æ–°**ï¼š2025-12-11
**æ¸¬è©¦åŸ·è¡Œè€…**ï¼šAXS Performance Team
**å ±å‘Šç‰ˆæœ¬**ï¼šv1.0
