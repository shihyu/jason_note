# æ€§èƒ½åˆ†æèˆ‡é™¤éŒ¯

> Go æ€§èƒ½åˆ†æã€Trace è¿½è¹¤ã€Debug é™¤éŒ¯èˆ‡å•é¡Œæ’æŸ¥ã€‚

## ğŸ“Š æ€§èƒ½åˆ†æ

### å®Œæ•´æŒ‡å—
- [Go æ•ˆèƒ½åˆ†æèˆ‡æœ€ä½³åŒ–æŒ‡å—](go_performance_analysis.md)
- [Golang é«˜æ•ˆèƒ½é–‹ç™¼å®Œæ•´æŒ‡å—](Golangé«˜æ•ˆèƒ½é–‹ç™¼å®Œæ•´æŒ‡å—.md)

## ğŸ” Trace è¿½è¹¤

### è¿½è¹¤å‰–æ
- [Golang å¤§æ®ºå™¨ä¹‹è·Ÿè¹¤å‰–æ trace](trace.md)

## ğŸ› é™¤éŒ¯å·¥å…·

### Debugger
- [Golang Debugger](golang_debugger.md)

## ğŸ”§ å•é¡Œæ’æŸ¥

### æ­»é–åˆ†æ
- [Go + MySQL æ­»é–å•é¡Œèª¿æŸ¥æŒ‡å—](go_mysql_deadlock_debug.md)

## ğŸ’¡ æ€§èƒ½åˆ†æå·¥å…·

### pprof
1. **CPU Profiling**
   ```go
   import _ "net/http/pprof"

   go func() {
       log.Println(http.ListenAndServe("localhost:6060", nil))
   }()
   ```

2. **Memory Profiling**
   ```bash
   go tool pprof http://localhost:6060/debug/pprof/heap
   ```

3. **Goroutine Profiling**
   ```bash
   go tool pprof http://localhost:6060/debug/pprof/goroutine
   ```

### trace
1. **å•Ÿç”¨ trace**
   ```go
   import "runtime/trace"

   f, _ := os.Create("trace.out")
   trace.Start(f)
   defer trace.Stop()
   ```

2. **åˆ†æ trace**
   ```bash
   go tool trace trace.out
   ```

## ğŸ”¬ æ€§èƒ½å„ªåŒ–æŠ€å·§

### CPU å„ªåŒ–
1. **æ¸›å°‘ CPU ä½¿ç”¨**
   - é¿å…ä¸å¿…è¦çš„è¨ˆç®—
   - ä½¿ç”¨æ›´é«˜æ•ˆçš„ç®—æ³•
   - ä½µç™¼è™•ç†

2. **æ¸›å°‘é–ç«¶çˆ­**
   - ç´°ç²’åº¦é–
   - ç„¡é–æ•¸æ“šçµæ§‹
   - Channel ä»£æ›¿é–

### è¨˜æ†¶é«”å„ªåŒ–
1. **æ¸›å°‘åˆ†é…**
   - å°è±¡æ±  sync.Pool
   - é åˆ†é… slice
   - å­—ç¬¦ä¸²æ‹¼æ¥ç”¨ strings.Builder

2. **æ¸›å°‘ GC å£“åŠ›**
   - å¾©ç”¨å°è±¡
   - æ¸›å°å°è±¡å¤§å°
   - é¿å…å…§å­˜æ´©æ¼

### ä¸¦ç™¼å„ªåŒ–
1. **Goroutine ç®¡ç†**
   - æ§åˆ¶ Goroutine æ•¸é‡
   - Worker Pool æ¨¡å¼
   - ä½¿ç”¨ context æ§åˆ¶ç”Ÿå‘½é€±æœŸ

2. **Channel å„ªåŒ–**
   - é¸æ“‡åˆé©çš„ç·©è¡å¤§å°
   - åŠæ™‚é—œé–‰ Channel
   - é¿å… Channel æ´©æ¼

## ğŸ› å¸¸è¦‹å•é¡Œ

### Goroutine æ´©æ¼
```go
// éŒ¯èª¤ï¼šGoroutine æ°¸é é˜»å¡
func leak() {
    ch := make(chan int)
    go func() {
        ch <- 1  // æ°¸é é˜»å¡
    }()
}

// æ­£ç¢ºï¼šä½¿ç”¨ context æ§åˆ¶
func noLeak(ctx context.Context) {
    ch := make(chan int)
    go func() {
        select {
        case ch <- 1:
        case <-ctx.Done():
            return
        }
    }()
}
```

### æ­»é–æª¢æ¸¬
```go
// ä½¿ç”¨ runtime æª¢æ¸¬
func main() {
    runtime.SetMutexProfileFraction(1)
    runtime.SetBlockProfileRate(1)
}
```

### Race Condition
```bash
# é–‹å•Ÿ race detector
go run -race main.go
go test -race
```

**æœ€å¾Œæ›´æ–°**: 2025-12-01
