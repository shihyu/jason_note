#10.1 設置本章的原因

我們寫OpenCL程序時，不僅限於編寫高性能的內核代碼，還要注意其他的一些因素，從而達到加速應用的效果。上一章我們介紹瞭如何使用目標機器的硬件特性，去優化OpenCL內核代碼。一個OpenCL應用可以包含多個內核，以及一系列內存對象(可在主機端和設備端對數據進行搬移)。所以，我們需要對性能進行測試，並且去了解應用的瓶頸。對應用的性能分析有助於我們提高應用的性能，在對性能進行分析時，需要注意一下幾點：

- 當程序中有多個內核時，哪些內核需要去優化？
- 內核在命令隊列中等待的時間與實際運行的時間
- 瞭解執行、初始化，以及內核編譯在整個應用執行中的時間佔比
- 主機與設備之間的數據I/O在整個應用執行中的時間佔比

弄清楚上面的問題和關係，可以幫助開發者判斷該應用是否具有優化的空間。本章我們需要結合調試工具，明確這些信息。

所以，本章我們決定來聊一聊對於OpenCL內核代碼的調試。調試並行程序要比調試串行程序複雜很多，因為在並行帶程序中存在一些諸如條件競爭這樣的非邏輯錯誤，所以有時候多線程的問題我們是很難發現和復現。