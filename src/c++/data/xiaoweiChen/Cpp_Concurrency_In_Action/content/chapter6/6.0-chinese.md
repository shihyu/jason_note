# 第6章 基於鎖的併發數據結構設計

**本章主要內容**

- 併發數據結構設計的意義<br>
- 指導如何設計<br>
- 實現為併發設計的數據結構<br>

在上一章中，我們對底層原子操作和內存模型有了詳盡的瞭解。在本章中，我們將先將底層的東西放在一邊(將會在第7章再次提及)，來對數據結構做一些討論。

數據結構的選擇，對於程序來說，是其解決方案的重要組成部分，當然，並行程序也不例外。如果一種數據結構可以被多個線程所訪問，其要不就是絕對不變的(其值不會發生變化，並且不需同步)，要不程序就要對數據結構進行正確的設計，以確保其能在多線程環境下能夠(正確的)同步。一種選擇是使用獨立的互斥量，其可以鎖住需要保護的數據(這種方法已經在第3和第4章中提到)，另一種選擇是設計一種能夠併發訪問的數據結構。

在設計併發數據結構時，你可以使用基本多線程應用中的構建塊(之前章節中有提及)，比如，互斥量和條件變量。當然，你也已經在之前的章節的例子中看到，怎樣聯合不同的構建塊，對數據結構進行寫入，並且保證這些構建塊都是在併發環境下是線程安全的。

在本章，我們將瞭解一些併發數據結構設計的基本準則。然後，我們將再次重溫鎖和條件變量的基本構建塊。最後，會去了解更為複雜的數據結構。在第7章，我們將瞭解，如何正確的“返璞歸真”，並使用第5章提到的原子操作，去構建無鎖的數據結構。

好吧！多說無益，讓我們來看一下併發數據結構的設計，都需要些*什麼*。