<!DOCTYPE HTML>
<html lang="zh" class="rust sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>影像處理:頻率域的直覺理解 - Jason Notes</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "rust";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Jason Notes</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/shihyu/jason_note" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="影像處理頻率域的直覺理解"><a class="header" href="#影像處理頻率域的直覺理解">影像處理：頻率域的直覺理解</a></h1>
<h2 id="核心概念"><a class="header" href="#核心概念">核心概念</a></h2>
<p><strong>空間域</strong>看的是「每個位置的像素值」<br />
<strong>頻率域</strong>看的是「影像變化的快慢」</p>
<hr />
<h2 id="-用聲音類比"><a class="header" href="#-用聲音類比">🎵 用聲音類比</a></h2>
<p>想像聲音的兩種呈現方式：</p>
<h3 id="空間域時域-看波形圖"><a class="header" href="#空間域時域-看波形圖">空間域（時域）= 看波形圖</a></h3>
<ul>
<li>顯示：每個時間點的振幅</li>
<li>特點：看到聲波的起伏</li>
<li>缺點：很難看出「有哪些音高」</li>
</ul>
<h3 id="頻率域--看頻譜圖"><a class="header" href="#頻率域--看頻譜圖">頻率域 = 看頻譜圖</a></h3>
<ul>
<li>顯示：有哪些音高/頻率</li>
<li>特點：可以分辨不同樂器</li>
<li>優點：一目了然看出音色組成</li>
</ul>
<h3 id="實際例子"><a class="header" href="#實際例子">實際例子</a></h3>
<p><strong>一首歌的分析：</strong></p>
<pre><code>波形圖（空間域）：
複雜的上下震盪，很難理解

頻譜圖（頻率域）：
├─ 低頻：有一根很高的柱子 → 低音鼓
├─ 中頻：有連續的波動 → 人聲
└─ 高頻：有一些尖峰 → 鈸聲、沙鈴
</code></pre>
<p><strong>關鍵領悟：</strong><br />
同樣的聲音，用不同角度看會有不同的理解方式！</p>
<hr />
<h2 id="-影像的頻率"><a class="header" href="#-影像的頻率">📸 影像的頻率</a></h2>
<h3 id="低頻--變化慢--平滑區域"><a class="header" href="#低頻--變化慢--平滑區域">低頻 = 變化慢 = 平滑區域</a></h3>
<p><strong>特徵：</strong></p>
<ul>
<li>相鄰像素的值很接近</li>
<li>顏色或亮度緩慢變化</li>
<li>大面積的均勻區域</li>
</ul>
<p><strong>實際例子：</strong></p>
<ul>
<li>🌤️ 藍天</li>
<li>🧱 牆壁</li>
<li>👤 臉部膚色</li>
<li>🌊 平靜的海面</li>
<li>📄 白紙背景</li>
</ul>
<p><strong>視覺效果：</strong>
看起來平滑、柔和、沒有明顯邊界</p>
<hr />
<h3 id="高頻--變化快--細節邊緣"><a class="header" href="#高頻--變化快--細節邊緣">高頻 = 變化快 = 細節/邊緣</a></h3>
<p><strong>特徵：</strong></p>
<ul>
<li>相鄰像素的值差異很大</li>
<li>顏色或亮度急劇變化</li>
<li>有明顯的輪廓或紋理</li>
</ul>
<p><strong>實際例子：</strong></p>
<ul>
<li>💇 頭髮絲</li>
<li>📝 文字邊緣</li>
<li>🧵 布料紋理</li>
<li>🌲 樹葉細節</li>
<li>📐 物體輪廓</li>
</ul>
<p><strong>視覺效果：</strong>
看起來銳利、清晰、有邊界感</p>
<hr />
<h2 id="-具體例子人臉照片"><a class="header" href="#-具體例子人臉照片">💡 具體例子：人臉照片</a></h2>
<p>假設一張照片內容：</p>
<pre><code>空間域看到：
一個人的臉 + 背景牆 + 頭髮細節

頻率域分解：
├─ 低頻成分：
│   ├─ 臉部大致輪廓
│   ├─ 整體光線明暗
│   └─ 背景牆的顏色
│
├─ 中頻成分：
│   ├─ 五官的形狀（眼睛、鼻子、嘴巴）
│   ├─ 臉部明暗過渡
│   └─ 膚色的漸層變化
│
└─ 高頻成分：
    ├─ 皮膚的毛孔
    ├─ 頭髮的細絲
    ├─ 眼睫毛
    └─ 瞳孔邊緣
</code></pre>
<h3 id="視覺化理解"><a class="header" href="#視覺化理解">視覺化理解</a></h3>
<div class="table-wrapper"><table><thead><tr><th>頻率</th><th>保留後的效果</th></tr></thead><tbody>
<tr><td>只保留低頻</td><td>模糊的大致輪廓，像是近視看到的</td></tr>
<tr><td>只保留高頻</td><td>只剩邊緣線條，像是素描</td></tr>
<tr><td>全部保留</td><td>完整清晰的照片</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="-實際應用"><a class="header" href="#-實際應用">🔧 實際應用</a></h2>
<h3 id="1-模糊與銳化"><a class="header" href="#1-模糊與銳化">1. 模糊與銳化</a></h3>
<h4 id="低通濾波器low-pass-filter"><a class="header" href="#低通濾波器low-pass-filter">低通濾波器（Low-pass Filter）</a></h4>
<ul>
<li><strong>操作</strong>：保留低頻，去除高頻</li>
<li><strong>效果</strong>：影像變模糊</li>
<li><strong>應用</strong>：
<ul>
<li>去除雜訊（高頻雜點）</li>
<li>平滑處理</li>
<li>磨皮美肌</li>
</ul>
</li>
</ul>
<pre><code>原圖 → [低通濾波] → 模糊、柔和的影像
</code></pre>
<h4 id="高通濾波器high-pass-filter"><a class="header" href="#高通濾波器high-pass-filter">高通濾波器（High-pass Filter）</a></h4>
<ul>
<li><strong>操作</strong>：保留高頻，去除低頻</li>
<li><strong>效果</strong>：強調邊緣和細節</li>
<li><strong>應用</strong>：
<ul>
<li>銳化影像</li>
<li>邊緣檢測</li>
<li>增強細節</li>
</ul>
</li>
</ul>
<pre><code>原圖 → [高通濾波] → 只剩輪廓和邊緣
</code></pre>
<hr />
<h3 id="2-影像壓縮jpeg"><a class="header" href="#2-影像壓縮jpeg">2. 影像壓縮（JPEG）</a></h3>
<h4 id="原理"><a class="header" href="#原理">原理</a></h4>
<p>人眼對高頻細節不敏感 → 可以丟棄部分高頻資訊</p>
<h4 id="過程"><a class="header" href="#過程">過程</a></h4>
<pre><code>1. 將影像轉換到頻率域（DCT 變換）
2. 量化高頻係數（允許較大誤差）
3. 壓縮編碼
4. 轉回空間域
</code></pre>
<h4 id="結果"><a class="header" href="#結果">結果</a></h4>
<ul>
<li>檔案大小：縮小到原本的 1/10 或更小</li>
<li>視覺效果：人眼幾乎看不出差異</li>
<li>缺點：過度壓縮會產生「方塊效應」（還是高頻資訊流失）</li>
</ul>
<hr />
<h3 id="3-去摩爾紋"><a class="header" href="#3-去摩爾紋">3. 去摩爾紋</a></h3>
<h4 id="問題"><a class="header" href="#問題">問題</a></h4>
<p>用相機拍螢幕或網狀物時出現的波紋圖案</p>
<h4 id="原因"><a class="header" href="#原因">原因</a></h4>
<p>摩爾紋是「特定頻率的干涉」現象</p>
<h4 id="解決方法"><a class="header" href="#解決方法">解決方法</a></h4>
<pre><code>1. 轉換到頻率域
2. 找出摩爾紋對應的頻率（會在頻譜中出現異常的峰值）
3. 用帶阻濾波器消除那個特定頻率
4. 轉回空間域
</code></pre>
<p>在頻率域處理比在空間域容易得多！</p>
<hr />
<h3 id="4-影像浮水印"><a class="header" href="#4-影像浮水印">4. 影像浮水印</a></h3>
<h4 id="隱藏浮水印"><a class="header" href="#隱藏浮水印">隱藏浮水印</a></h4>
<ul>
<li>在頻率域的中頻區域嵌入資訊</li>
<li>人眼看不出來，但頻譜分析能找到</li>
<li>抗壓縮、抗裁切</li>
</ul>
<h4 id="為什麼用中頻"><a class="header" href="#為什麼用中頻">為什麼用中頻？</a></h4>
<ul>
<li>低頻：太容易被修改</li>
<li>高頻：容易在壓縮時流失</li>
<li>中頻：穩定且不顯眼</li>
</ul>
<hr />
<h2 id="-關鍵概念傅立葉轉換"><a class="header" href="#-關鍵概念傅立葉轉換">🎯 關鍵概念：傅立葉轉換</a></h2>
<h3 id="核心思想"><a class="header" href="#核心思想">核心思想</a></h3>
<blockquote>
<p>任何影像都可以看成「一堆不同頻率、不同方向的正弦波疊加而成」</p>
</blockquote>
<h3 id="數學表達簡化版"><a class="header" href="#數學表達簡化版">數學表達（簡化版）</a></h3>
<pre><code>影像(x,y) = Σ [振幅 × cos(頻率×位置 + 相位)]
           不同頻率

傅立葉轉換就是找出：
- 每個頻率的「振幅」有多大
- 每個頻率的「相位」是多少
</code></pre>
<h3 id="直覺理解"><a class="header" href="#直覺理解">直覺理解</a></h3>
<h4 id="樂高積木比喻"><a class="header" href="#樂高積木比喻">樂高積木比喻</a></h4>
<p><strong>空間域：</strong></p>
<ul>
<li>看到完成的樂高作品（城堡）</li>
<li>描述每個位置有什麼顏色的積木</li>
</ul>
<p><strong>頻率域：</strong></p>
<ul>
<li>看到用了哪些種類的積木
<ul>
<li>1×1 小積木（高頻）：用來做細節</li>
<li>2×4 中積木（中頻）：用來做主結構</li>
<li>大底板（低頻）：用來做基礎</li>
</ul>
</li>
</ul>
<p><strong>轉換的意義：</strong></p>
<ul>
<li>正向轉換：從「作品」分析「用了哪些材料」</li>
<li>反向轉換：從「材料清單」組裝出「作品」</li>
</ul>
<hr />
<h3 id="波的疊加原理"><a class="header" href="#波的疊加原理">波的疊加原理</a></h3>
<h4 id="一維例子聲音"><a class="header" href="#一維例子聲音">一維例子（聲音）</a></h4>
<pre><code>簡單的聲音 = 單一頻率的波
  ～～～～～～～～～

複雜的聲音 = 多個頻率疊加
  ～～～～～～～～～  (低頻：基音)
+ ～～～～  (高頻：泛音1)
+ ～～  (更高頻：泛音2)
= ～∼～∼～∼～  (複雜波形)
</code></pre>
<h4 id="二維例子影像"><a class="header" href="#二維例子影像">二維例子（影像）</a></h4>
<pre><code>簡單的影像 = 單一方向、單一頻率的條紋
  ||||||||||||

複雜的影像 = 多個方向、多個頻率疊加
  |||||||||||| (垂直低頻)
+ ━━━━━━━━━━ (水平低頻)
+ ／／／／／／ (斜向高頻)
= 實際的照片
</code></pre>
<hr />
<h3 id="頻譜圖的閱讀"><a class="header" href="#頻譜圖的閱讀">頻譜圖的閱讀</a></h3>
<p>轉換到頻率域後，會得到一張「頻譜圖」：</p>
<pre><code>頻譜圖特徵：

┌─────────────────┐
│    ★            │  ← 中心：低頻（DC 分量，平均亮度）
│  ● ★ ●          │  ← 中間：中頻
│● ● ★ ● ●        │  ← 邊緣：高頻
│  ● ★ ●          │
│    ★            │
└─────────────────┘

★ = 最亮的點（能量最集中的頻率）
● = 較亮的點（次要頻率）
  = 較暗的區域（很少能量）
</code></pre>
<h4 id="判讀方法"><a class="header" href="#判讀方法">判讀方法</a></h4>
<ul>
<li><strong>中心很亮</strong>：影像有大片平坦區域</li>
<li><strong>中心周圍有環</strong>：影像有週期性紋理（如柵欄）</li>
<li><strong>十字形亮線</strong>：影像有水平或垂直的強烈邊緣</li>
<li><strong>分散的亮點</strong>：影像紋理複雜且多變</li>
</ul>
<hr />
<h2 id="-數學補充選讀"><a class="header" href="#-數學補充選讀">🧮 數學補充（選讀）</a></h2>
<h3 id="一維離散傅立葉轉換dft"><a class="header" href="#一維離散傅立葉轉換dft">一維離散傅立葉轉換（DFT）</a></h3>
<pre><code>正向轉換（時域 → 頻域）：
F(k) = Σ f(n) × e^(-2πikn/N)
       n=0 到 N-1

反向轉換（頻域 → 時域）：
f(n) = (1/N) × Σ F(k) × e^(2πikn/N)
              k=0 到 N-1
</code></pre>
<h3 id="二維離散傅立葉轉換2d-dft"><a class="header" href="#二維離散傅立葉轉換2d-dft">二維離散傅立葉轉換（2D-DFT）</a></h3>
<pre><code>F(u,v) = Σ Σ f(x,y) × e^(-2πi(ux/M + vy/N))
         x y

f(x,y) = (1/MN) × Σ Σ F(u,v) × e^(2πi(ux/M + vy/N))
                  u v
</code></pre>
<p><strong>不用怕複雜！</strong> 實務上都是呼叫函式庫（如 NumPy 的 <code>fft.fft2</code>）</p>
<hr />
<h2 id="-python-實作範例"><a class="header" href="#-python-實作範例">🐍 Python 實作範例</a></h2>
<h3 id="基礎範例頻域濾波"><a class="header" href="#基礎範例頻域濾波">基礎範例：頻域濾波</a></h3>
<pre><code class="language-python">import cv2
import numpy as np
from matplotlib import pyplot as plt

# 讀取灰階影像
img = cv2.imread('photo.jpg', 0)

# === 1. 轉換到頻率域 ===
# 進行傅立葉轉換
dft = cv2.dft(np.float32(img), flags=cv2.DFT_COMPLEX_OUTPUT)

# 將零頻率移到中心（方便觀察）
dft_shift = np.fft.fftshift(dft)

# 計算頻譜（用於顯示）
magnitude_spectrum = 20 * np.log(cv2.magnitude(dft_shift[:,:,0], dft_shift[:,:,1]))

# === 2. 創建濾波器遮罩 ===
rows, cols = img.shape
crow, ccol = rows // 2, cols // 2  # 中心點

# 低通濾波器（保留低頻）
mask_low = np.zeros((rows, cols, 2), np.uint8)
r = 30  # 半徑
mask_low[crow-r:crow+r, ccol-r:ccol+r] = 1

# 高通濾波器（保留高頻）
mask_high = np.ones((rows, cols, 2), np.uint8)
mask_high[crow-r:crow+r, ccol-r:ccol+r] = 0

# === 3. 應用濾波器 ===
# 低通濾波
fshift_low = dft_shift * mask_low
f_ishift_low = np.fft.ifftshift(fshift_low)
img_low = cv2.idft(f_ishift_low)
img_low = cv2.magnitude(img_low[:,:,0], img_low[:,:,1])

# 高通濾波
fshift_high = dft_shift * mask_high
f_ishift_high = np.fft.ifftshift(fshift_high)
img_high = cv2.idft(f_ishift_high)
img_high = cv2.magnitude(img_high[:,:,0], img_high[:,:,1])

# === 4. 顯示結果 ===
plt.figure(figsize=(15, 10))

plt.subplot(2, 3, 1), plt.imshow(img, cmap='gray')
plt.title('原始影像'), plt.axis('off')

plt.subplot(2, 3, 2), plt.imshow(magnitude_spectrum, cmap='gray')
plt.title('頻譜'), plt.axis('off')

plt.subplot(2, 3, 3), plt.imshow(mask_low[:,:,0], cmap='gray')
plt.title('低通濾波器遮罩'), plt.axis('off')

plt.subplot(2, 3, 5), plt.imshow(img_low, cmap='gray')
plt.title('低通濾波結果（模糊）'), plt.axis('off')

plt.subplot(2, 3, 6), plt.imshow(img_high, cmap='gray')
plt.title('高通濾波結果（邊緣）'), plt.axis('off')

plt.tight_layout()
plt.show()
</code></pre>
<hr />
<h3 id="進階範例去除週期性雜訊"><a class="header" href="#進階範例去除週期性雜訊">進階範例：去除週期性雜訊</a></h3>
<pre><code class="language-python">import cv2
import numpy as np

def remove_periodic_noise(image_path):
    """去除影像中的週期性雜訊（如掃描線）"""
    
    # 讀取影像
    img = cv2.imread(image_path, 0)
    
    # 傅立葉轉換
    dft = cv2.dft(np.float32(img), flags=cv2.DFT_COMPLEX_OUTPUT)
    dft_shift = np.fft.fftshift(dft)
    
    # 計算頻譜大小（用於找雜訊峰值）
    magnitude = cv2.magnitude(dft_shift[:,:,0], dft_shift[:,:,1])
    
    # 找出異常高的頻率峰值（雜訊）
    # 這裡簡化處理：手動標記要去除的頻率位置
    rows, cols = img.shape
    crow, ccol = rows // 2, cols // 2
    
    # 假設雜訊在 (crow-100, ccol) 和 (crow+100, ccol) 這兩個位置
    # 創建帶阻濾波器
    mask = np.ones((rows, cols, 2), np.uint8)
    r = 10  # 阻擋半徑
    
    # 在雜訊位置創建凹陷
    mask[crow-100-r:crow-100+r, ccol-r:ccol+r] = 0
    mask[crow+100-r:crow+100+r, ccol-r:ccol+r] = 0
    
    # 應用濾波器
    fshift = dft_shift * mask
    
    # 反轉換回空間域
    f_ishift = np.fft.ifftshift(fshift)
    img_back = cv2.idft(f_ishift)
    img_back = cv2.magnitude(img_back[:,:,0], img_back[:,:,1])
    
    return img, img_back

# 使用範例
original, filtered = remove_periodic_noise('noisy_image.jpg')

# 顯示結果
cv2.imshow('Original', original)
cv2.imshow('Filtered', filtered)
cv2.waitKey(0)
cv2.destroyAllWindows()
</code></pre>
<hr />
<h3 id="實用函式分析影像頻率特性"><a class="header" href="#實用函式分析影像頻率特性">實用函式：分析影像頻率特性</a></h3>
<pre><code class="language-python">def analyze_frequency_content(img):
    """分析影像的頻率內容分布"""
    
    # 轉換到頻率域
    dft = cv2.dft(np.float32(img), flags=cv2.DFT_COMPLEX_OUTPUT)
    dft_shift = np.fft.fftshift(dft)
    
    # 計算幅度譜
    magnitude = cv2.magnitude(dft_shift[:,:,0], dft_shift[:,:,1])
    
    rows, cols = img.shape
    crow, ccol = rows // 2, cols // 2
    
    # 定義頻率環
    def get_ring_energy(inner_r, outer_r):
        """計算特定頻率環的能量"""
        y, x = np.ogrid[:rows, :cols]
        dist = np.sqrt((x - ccol)**2 + (y - crow)**2)
        ring_mask = (dist &gt;= inner_r) &amp; (dist &lt; outer_r)
        return np.sum(magnitude[ring_mask])
    
    # 計算不同頻率範圍的能量
    low_freq = get_ring_energy(0, 30)
    mid_freq = get_ring_energy(30, 100)
    high_freq = get_ring_energy(100, min(rows, cols)//2)
    
    total = low_freq + mid_freq + high_freq
    
    print(f"低頻能量: {low_freq/total*100:.1f}%")
    print(f"中頻能量: {mid_freq/total*100:.1f}%")
    print(f"高頻能量: {high_freq/total*100:.1f}%")
    
    # 判斷影像特性
    if low_freq/total &gt; 0.8:
        print("→ 這是一張平滑的影像（少細節）")
    elif high_freq/total &gt; 0.3:
        print("→ 這是一張細節豐富的影像")
    else:
        print("→ 這是一張平衡的影像")

# 使用範例
img = cv2.imread('test.jpg', 0)
analyze_frequency_content(img)
</code></pre>
<hr />
<h2 id="-深入理解常見問題"><a class="header" href="#-深入理解常見問題">🎓 深入理解：常見問題</a></h2>
<h3 id="q1-為什麼頻譜圖看起來是對稱的"><a class="header" href="#q1-為什麼頻譜圖看起來是對稱的">Q1: 為什麼頻譜圖看起來是對稱的？</a></h3>
<p><strong>答：</strong> 因為實數影像的傅立葉轉換具有「共軛對稱性」</p>
<pre><code>F(u, v) = F*(-u, -v)

意思是：頻譜的左半邊和右半邊是鏡像關係
所以我們只需要看一半的頻譜就夠了
</code></pre>
<hr />
<h3 id="q2-dc-分量是什麼"><a class="header" href="#q2-dc-分量是什麼">Q2: DC 分量是什麼？</a></h3>
<p><strong>答：</strong> DC (Direct Current) 分量是頻率為 0 的成分</p>
<ul>
<li>位置：頻譜圖的正中心</li>
<li>意義：整張影像的「平均亮度」</li>
<li>特點：最大的值，通常要取 log 才能看清其他頻率</li>
</ul>
<pre><code class="language-python"># 取得 DC 分量
dc_value = dft_shift[crow, ccol]

# DC 分量越大 → 影像整體越亮
# DC 分量越小 → 影像整體越暗
</code></pre>
<hr />
<h3 id="q3-為什麼要用-log-尺度顯示頻譜"><a class="header" href="#q3-為什麼要用-log-尺度顯示頻譜">Q3: 為什麼要用 log 尺度顯示頻譜？</a></h3>
<p><strong>答：</strong> 因為頻率分布的動態範圍太大</p>
<pre><code>DC 分量的值可能是 10^6
高頻成分的值可能只有 10^1

如果不取 log，高頻成分會完全看不見（都是黑色）

magnitude_spectrum = 20 * np.log(cv2.magnitude(...) + 1)
                           ↑
                     取 log 壓縮動態範圍
</code></pre>
<hr />
<h3 id="q4-快速傅立葉轉換fft比-dft-快多少"><a class="header" href="#q4-快速傅立葉轉換fft比-dft-快多少">Q4: 快速傅立葉轉換（FFT）比 DFT 快多少？</a></h3>
<p><strong>答：</strong> 快非常多！</p>
<div class="table-wrapper"><table><thead><tr><th>影像大小</th><th>DFT 複雜度</th><th>FFT 複雜度</th><th>速度提升</th></tr></thead><tbody>
<tr><td>64×64</td><td>O(N⁴)</td><td>O(N² log N)</td><td>~100倍</td></tr>
<tr><td>512×512</td><td>O(N⁴)</td><td>O(N² log N)</td><td>~1000倍</td></tr>
<tr><td>1024×1024</td><td>O(N⁴)</td><td>O(N² log N)</td><td>~5000倍</td></tr>
</tbody></table>
</div>
<p><strong>實務建議：</strong> 永遠使用 FFT，不要用 DFT</p>
<hr />
<h3 id="q5-彩色影像怎麼做頻域處理"><a class="header" href="#q5-彩色影像怎麼做頻域處理">Q5: 彩色影像怎麼做頻域處理？</a></h3>
<p><strong>答：</strong> 有兩種方法</p>
<h4 id="方法-1分別處理三個通道"><a class="header" href="#方法-1分別處理三個通道">方法 1：分別處理三個通道</a></h4>
<pre><code class="language-python">b, g, r = cv2.split(img)

# 對每個通道分別做 FFT
dft_b = cv2.dft(np.float32(b), flags=cv2.DFT_COMPLEX_OUTPUT)
dft_g = cv2.dft(np.float32(g), flags=cv2.DFT_COMPLEX_OUTPUT)
dft_r = cv2.dft(np.float32(r), flags=cv2.DFT_COMPLEX_OUTPUT)

# ... 濾波處理 ...

# 合併回彩色影像
result = cv2.merge([b_filtered, g_filtered, r_filtered])
</code></pre>
<h4 id="方法-2轉到-hsv只處理-v-通道推薦"><a class="header" href="#方法-2轉到-hsv只處理-v-通道推薦">方法 2：轉到 HSV，只處理 V 通道（推薦）</a></h4>
<pre><code class="language-python">hsv = cv2.cvtColor(img, cv2.COLOR_BGR2HSV)
h, s, v = cv2.split(hsv)

# 只對明度（V）做頻域處理
v_filtered = frequency_filter(v)

# 合併回去
hsv_filtered = cv2.merge([h, s, v_filtered])
result = cv2.cvtColor(hsv_filtered, cv2.COLOR_HSV2BGR)
</code></pre>
<hr />
<h2 id="-延伸學習"><a class="header" href="#-延伸學習">🚀 延伸學習</a></h2>
<h3 id="相關主題"><a class="header" href="#相關主題">相關主題</a></h3>
<ol>
<li>
<p><strong>小波轉換（Wavelet Transform）</strong></p>
<ul>
<li>比傅立葉轉換更靈活</li>
<li>同時提供時間和頻率資訊</li>
<li>用於 JPEG2000 壓縮</li>
</ul>
</li>
<li>
<p><strong>離散餘弦轉換（DCT）</strong></p>
<ul>
<li>JPEG 壓縮的核心</li>
<li>只用實數（比 FFT 簡單）</li>
<li>能量集中度更好</li>
</ul>
</li>
<li>
<p><strong>加伯濾波器（Gabor Filter）</strong></p>
<ul>
<li>模擬人類視覺系統</li>
<li>同時具有空間和頻率選擇性</li>
<li>用於紋理分析和人臉識別</li>
</ul>
</li>
<li>
<p><strong>短時傅立葉轉換（STFT）</strong></p>
<ul>
<li>分段做傅立葉轉換</li>
<li>可以看到頻率隨時間的變化</li>
<li>用於語音處理</li>
</ul>
</li>
</ol>
<hr />
<h2 id="-學習資源推薦"><a class="header" href="#-學習資源推薦">📚 學習資源推薦</a></h2>
<h3 id="書籍"><a class="header" href="#書籍">書籍</a></h3>
<ul>
<li>《數位影像處理》(Rafael C. Gonzalez) - 第 4 章頻域處理</li>
<li>《Fundamentals of Digital Image Processing》(Chris Solomon)</li>
</ul>
<h3 id="線上課程"><a class="header" href="#線上課程">線上課程</a></h3>
<ul>
<li>Coursera: Image and Video Processing (Duke University)</li>
<li>YouTube: 3Blue1Brown 的傅立葉級數視覺化</li>
</ul>
<h3 id="實作練習"><a class="header" href="#實作練習">實作練習</a></h3>
<pre><code class="language-python"># 練習 1: 觀察不同影像的頻譜差異
# - 拍一張天空的照片（低頻為主）
# - 拍一張樹葉的照片（高頻豐富）
# - 比較兩者的頻譜

# 練習 2: 實作理想低通濾波器
# - 嘗試不同的截止頻率
# - 觀察「振鈴效應」（Ringing）

# 練習 3: 影像壓縮實驗
# - 手動設定頻率閾值
# - 看看要丟掉多少高頻才會明顯失真
</code></pre>
<hr />
<h2 id="-總結"><a class="header" href="#-總結">🎁 總結</a></h2>
<h3 id="核心記憶點"><a class="header" href="#核心記憶點">核心記憶點</a></h3>
<ol>
<li>
<p><strong>空間域 vs 頻率域</strong></p>
<ul>
<li>空間域 = 每個像素的值</li>
<li>頻率域 = 變化的快慢</li>
</ul>
</li>
<li>
<p><strong>頻率的意義</strong></p>
<ul>
<li>低頻 = 平滑、輪廓、整體</li>
<li>高頻 = 細節、邊緣、紋理</li>
</ul>
</li>
<li>
<p><strong>轉換的目的</strong></p>
<ul>
<li>某些操作在頻域更容易（如濾波、壓縮）</li>
<li>頻域看到空間域看不到的資訊（如週期性）</li>
</ul>
</li>
<li>
<p><strong>實務應用</strong></p>
<ul>
<li>模糊/銳化 → 濾波器</li>
<li>壓縮 → 丟棄高頻</li>
<li>去雜訊 → 帶阻濾波器</li>
<li>浮水印 → 中頻嵌入</li>
</ul>
</li>
</ol>
<h3 id="最後的比喻"><a class="header" href="#最後的比喻">最後的比喻</a></h3>
<blockquote>
<p>影像處理就像聽音樂：</p>
<ul>
<li>空間域 = 聽歌詞（一個字一個字聽）</li>
<li>頻率域 = 聽旋律（整體感受和聲、節奏）</li>
</ul>
<p>兩種方式都重要，但有時候頻域能讓你「聽出」空間域聽不到的東西！</p>
</blockquote>
<hr />
<p><strong>記住：理解比記憶重要，實作比理解重要！</strong> 🚀</p>
<p>馬上打開 Python，試試看把你的照片轉到頻率域吧！</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../cv/影像處理易混淆概念.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../cv/AR眼鏡辨別詐騙.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../cv/影像處理易混淆概念.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../cv/AR眼鏡辨別詐騙.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="../ace.js"></script>
        <script src="../mode-rust.js"></script>
        <script src="../editor.js"></script>
        <script src="../theme-dawn.js"></script>
        <script src="../theme-tomorrow_night.js"></script>

        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../mermaid.min.js"></script>
        <script src="../mermaid-init.js"></script>



    </div>
    </body>
</html>
