<!DOCTYPE HTML>
<html lang="zh" class="rust sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Understanding eBPF - Jason&#x27;s Notes</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "rust";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>â†</kbd> or <kbd>â†’</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Jason&#x27;s Notes</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/shihyu/jason_note" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="ebpf-å®Œæ•´è§£ææŒ‡å—"><a class="header" href="#ebpf-å®Œæ•´è§£ææŒ‡å—">eBPF å®Œæ•´è§£ææŒ‡å—</a></h1>
<h2 id="ç›®éŒ„"><a class="header" href="#ç›®éŒ„">ç›®éŒ„</a></h2>
<ul>
<li><a href="#%E4%BB%80%E9%BA%BC%E6%98%AF-ebpf">ä»€éº¼æ˜¯ eBPFï¼Ÿ</a></li>
<li><a href="#%E7%82%BA%E4%BB%80%E9%BA%BC-ebpf-%E9%80%99%E9%BA%BC%E5%8F%97%E6%AD%A1%E8%BF%8E">ç‚ºä»€éº¼ eBPF é€™éº¼å—æ­¡è¿ï¼Ÿ</a></li>
<li><a href="#ebpf-%E7%9A%84%E6%87%89%E7%94%A8%E9%A0%98%E5%9F%9F">eBPF çš„æ‡‰ç”¨é ˜åŸŸ</a></li>
<li><a href="#%E8%AA%9E%E8%A8%80%E5%B1%A4%E6%AC%A1%E6%9E%B6%E6%A7%8B">èªè¨€å±¤æ¬¡æ¶æ§‹</a></li>
<li><a href="#kernel-ebpf-vs-user-space-%E7%A8%8B%E5%BC%8F">Kernel eBPF vs User Space ç¨‹å¼</a></li>
<li><a href="#%E5%AF%A6%E9%9A%9B%E9%81%8B%E4%BD%9C%E6%B5%81%E7%A8%8B">å¯¦éš›é‹ä½œæµç¨‹</a></li>
<li><a href="#%E7%82%BA%E4%BB%80%E9%BA%BC%E8%A6%81%E9%80%99%E6%A8%A3%E8%A8%AD%E8%A8%88">ç‚ºä»€éº¼è¦é€™æ¨£è¨­è¨ˆï¼Ÿ</a></li>
</ul>
<h2 id="ä»€éº¼æ˜¯-ebpf"><a class="header" href="#ä»€éº¼æ˜¯-ebpf">ä»€éº¼æ˜¯ eBPFï¼Ÿ</a></h2>
<p>eBPF (Extended Berkeley Packet Filter) æ˜¯ Linux å…§æ ¸çš„ä¸€å€‹é©å‘½æ€§åŠŸèƒ½ï¼Œå¯ä»¥æƒ³åƒæˆ**ã€Œå…§æ ¸çš„å®‰å…¨æ’ä»¶ç³»çµ±ã€**ã€‚</p>
<h3 id="å‚³çµ±æ–¹å¼-vs-ebpf"><a class="header" href="#å‚³çµ±æ–¹å¼-vs-ebpf">å‚³çµ±æ–¹å¼ vs eBPF</a></h3>
<p><strong>å‚³çµ±ä¿®æ”¹å…§æ ¸è¡Œç‚ºï¼š</strong></p>
<ol>
<li>ä¿®æ”¹å…§æ ¸åŸå§‹ç¢¼</li>
<li>é‡æ–°ç·¨è­¯å…§æ ¸</li>
<li>é‡æ–°å•Ÿå‹•ç³»çµ±</li>
<li>ç¥ˆç¦±ä¸æœƒç•¶æ©Ÿ</li>
</ol>
<p><strong>ä½¿ç”¨ eBPFï¼š</strong></p>
<ul>
<li>âœ… åœ¨ç³»çµ±é‹è¡Œæ™‚å‹•æ…‹è¼‰å…¥ç¨‹å¼</li>
<li>âœ… ä¸éœ€è¦é‡å•Ÿ</li>
<li>âœ… æœ‰é©—è­‰å™¨ä¿è­‰å®‰å…¨</li>
<li>âœ… ä¸æœƒè®“ç³»çµ±å´©æ½°</li>
</ul>
<blockquote>
<p>ğŸ’¡ <strong>ç°¡å–®æ¯”å–»</strong>ï¼šå¦‚æœ Linux å…§æ ¸æ˜¯é›»è…¦çš„ã€Œå¤§è…¦ã€ï¼ŒeBPF å°±åƒæ˜¯å¯ä»¥å®‰å…¨æ¤å…¥å¤§è…¦çš„ã€Œå°åŠ©æ‰‹ç¨‹å¼ã€ï¼Œèƒ½åœ¨æœ€åº•å±¤è§€å¯Ÿå’Œä¿®æ”¹ç³»çµ±è¡Œç‚ºã€‚</p>
</blockquote>
<h2 id="ç‚ºä»€éº¼-ebpf-é€™éº¼å—æ­¡è¿"><a class="header" href="#ç‚ºä»€éº¼-ebpf-é€™éº¼å—æ­¡è¿">ç‚ºä»€éº¼ eBPF é€™éº¼å—æ­¡è¿ï¼Ÿ</a></h2>
<p>eBPF èƒ½åœ¨å…§æ ¸å±¤ï¼ˆæœ€åº•å±¤ï¼‰å·¥ä½œï¼Œå› æ­¤å…·æœ‰æ¥µé«˜çš„æ•ˆç‡å’Œå¼·å¤§çš„åŠŸèƒ½ã€‚</p>
<h3 id="ä¸»è¦å„ªå‹¢"><a class="header" href="#ä¸»è¦å„ªå‹¢">ä¸»è¦å„ªå‹¢</a></h3>
<ol>
<li><strong>è¶…é«˜æ•ˆèƒ½</strong>ï¼šåœ¨å…§æ ¸å±¤è™•ç†ï¼Œé¿å…è³‡æ–™è¤‡è£½</li>
<li><strong>å®‰å…¨æ€§</strong>ï¼šæœ‰é©—è­‰å™¨ç¢ºä¿ä¸æœƒæå£ç³»çµ±</li>
<li><strong>å³æ™‚æ€§</strong>ï¼šä¸ç”¨é‡å•Ÿå°±èƒ½è¼‰å…¥æ–°åŠŸèƒ½</li>
<li><strong>å¯ç¨‹å¼åŒ–</strong>ï¼šèƒ½ä¾éœ€æ±‚å®¢è£½åŒ–è¡Œç‚º</li>
</ol>
<h3 id="æ¡ç”¨ä¼æ¥­"><a class="header" href="#æ¡ç”¨ä¼æ¥­">æ¡ç”¨ä¼æ¥­</a></h3>
<p>Netflixã€Facebookã€Googleã€Cloudflare ç­‰å¤§å‹ä¼æ¥­éƒ½åœ¨ä½¿ç”¨ eBPF è§£æ±ºå„ç¨®å•é¡Œã€‚</p>
<h2 id="ebpf-çš„æ‡‰ç”¨é ˜åŸŸ"><a class="header" href="#ebpf-çš„æ‡‰ç”¨é ˜åŸŸ">eBPF çš„æ‡‰ç”¨é ˜åŸŸ</a></h2>
<h3 id="1-ç¶²è·¯è™•ç†æœ€ç†±é–€"><a class="header" href="#1-ç¶²è·¯è™•ç†æœ€ç†±é–€">1. ç¶²è·¯è™•ç†ï¼ˆæœ€ç†±é–€ï¼‰</a></h3>
<h4 id="é˜²ç«ç‰†ddos-é˜²è­·"><a class="header" href="#é˜²ç«ç‰†ddos-é˜²è­·">é˜²ç«ç‰†/DDoS é˜²è­·</a></h4>
<pre><code class="language-c">// åœ¨ç¶²è·¯å¡æ”¶åˆ°å°åŒ…çš„ç¬é–“å°±èƒ½æ±ºå®šè¦ä¸è¦ä¸Ÿæ‰
int firewall(struct xdp_md *ctx) {
    struct iphdr *ip = parse_ip_header(ctx);
    if (ip-&gt;saddr == BLOCKED_IP) {
        return XDP_DROP;  // ç›´æ¥ä¸Ÿæ‰ï¼Œè¶…å¿«ï¼
    }
    return XDP_PASS;
}
</code></pre>
<h4 id="è² è¼‰å¹³è¡¡"><a class="header" href="#è² è¼‰å¹³è¡¡">è² è¼‰å¹³è¡¡</a></h4>
<ul>
<li>Facebook çš„ <strong>Katran</strong></li>
<li>Cloudflare çš„è² è¼‰å¹³è¡¡å™¨</li>
<li>æ¯ç§’è™•ç†æ•¸ç™¾è¬å€‹è«‹æ±‚</li>
</ul>
<h4 id="å®¹å™¨ç¶²è·¯"><a class="header" href="#å®¹å™¨ç¶²è·¯">å®¹å™¨ç¶²è·¯</a></h4>
<ul>
<li><strong>Cilium</strong>ï¼šKubernetes ç¶²è·¯ç®¡ç†</li>
<li>æ¯”å‚³çµ± iptables å¿«å¾ˆå¤š</li>
</ul>
<h3 id="2-ç³»çµ±ç›£æ§å’Œè¿½è¹¤"><a class="header" href="#2-ç³»çµ±ç›£æ§å’Œè¿½è¹¤">2. ç³»çµ±ç›£æ§å’Œè¿½è¹¤</a></h3>
<h4 id="æ•ˆèƒ½åˆ†æ"><a class="header" href="#æ•ˆèƒ½åˆ†æ">æ•ˆèƒ½åˆ†æ</a></h4>
<pre><code class="language-c">// è¿½è¹¤å‡½å¼åŸ·è¡Œæ™‚é–“
int measure_function(struct pt_regs *ctx) {
    u64 timestamp = bpf_ktime_get_ns();
    bpf_map_update(&amp;start_times, &amp;pid, &amp;timestamp);
    return 0;
}
</code></pre>
<h4 id="å®‰å…¨ç›£æ§"><a class="header" href="#å®‰å…¨ç›£æ§">å®‰å…¨ç›£æ§</a></h4>
<ul>
<li><strong>Falco</strong>ï¼šé›²åŸç”Ÿé‹è¡Œæ™‚å®‰å…¨</li>
<li><strong>Tracee</strong>ï¼šé‹è¡Œæ™‚å®‰å…¨å’Œå–è­‰å·¥å…·</li>
<li>å³æ™‚åµæ¸¬å¯ç–‘è¡Œç‚º</li>
</ul>
<h3 id="3-å¯è§€æ¸¬æ€§"><a class="header" href="#3-å¯è§€æ¸¬æ€§">3. å¯è§€æ¸¬æ€§</a></h3>
<ul>
<li><strong>Pixie</strong>ï¼šKubernetes å¯è§€æ¸¬æ€§</li>
<li><strong>Hubble</strong>ï¼šç¶²è·¯å’Œå®‰å…¨å¯è§€æ¸¬æ€§</li>
<li>ä¸éœ€è¦æ”¹ç¨‹å¼ç¢¼å°±èƒ½æ”¶é›†æŒ‡æ¨™</li>
</ul>
<h2 id="èªè¨€å±¤æ¬¡æ¶æ§‹"><a class="header" href="#èªè¨€å±¤æ¬¡æ¶æ§‹">èªè¨€å±¤æ¬¡æ¶æ§‹</a></h2>
<h3 id="ä¸‰å±¤æ¶æ§‹åœ–"><a class="header" href="#ä¸‰å±¤æ¶æ§‹åœ–">ä¸‰å±¤æ¶æ§‹åœ–</a></h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ç¬¬ä¸‰å±¤ï¼šUser Space               â”‚
â”‚   æ§åˆ¶ç¨‹å¼ï¼ˆPython/Go/Rust/C++ç­‰ï¼‰        â”‚
â”‚   - è¼‰å…¥ eBPF ç¨‹å¼                       â”‚
â”‚   - è®€å–æ”¶é›†çš„è³‡æ–™                        â”‚
â”‚   - é¡¯ç¤ºçµæœçµ¦ä½¿ç”¨è€…                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“ 
              ç³»çµ±å‘¼å« bpf()
                    â†“
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ç¬¬äºŒå±¤ï¼šeBPF ç¨‹å¼                â”‚
â”‚   ç”¨ C/Rust å¯«çš„ç¨‹å¼                     â”‚
â”‚   - åœ¨å…§æ ¸ä¸­åŸ·è¡Œ                         â”‚
â”‚   - æ”¶é›†è³‡æ–™ã€éæ¿¾ã€æ±ºç­–                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
              ç·¨è­¯ï¼ˆLLVM/Clangï¼‰
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ç¬¬ä¸€å±¤ï¼šeBPF å­—ç¯€ç¢¼              â”‚
â”‚   é¡ä¼¼çµ„åˆèªè¨€çš„ä½éšæŒ‡ä»¤                  â”‚
â”‚   å…§æ ¸åªèªè­˜é€™å€‹                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="å„èªè¨€çš„è§’è‰²"><a class="header" href="#å„èªè¨€çš„è§’è‰²">å„èªè¨€çš„è§’è‰²</a></h3>
<div class="table-wrapper"><table><thead><tr><th>èªè¨€</th><th>å¯ä»¥å¯« Kernel eBPF</th><th>å¯ä»¥å¯« User Space æ§åˆ¶ç¨‹å¼</th><th>èªªæ˜</th></tr></thead><tbody>
<tr><td><strong>C</strong></td><td>âœ…</td><td>âœ…</td><td>æœ€åŸç”Ÿçš„æ–¹å¼</td></tr>
<tr><td><strong>Rust</strong></td><td>âœ… (via Aya)</td><td>âœ…</td><td>æ–°èˆˆé¸æ“‡ï¼Œæ›´å®‰å…¨</td></tr>
<tr><td><strong>Go</strong></td><td>âŒ</td><td>âœ…</td><td>åªèƒ½æ§åˆ¶ï¼Œä¸èƒ½é€² kernel</td></tr>
<tr><td><strong>Python</strong></td><td>âŒ</td><td>âœ…</td><td>é€é BCC æ§åˆ¶</td></tr>
<tr><td><strong>JavaScript</strong></td><td>âŒ</td><td>âœ…</td><td>å¯ä»¥æ§åˆ¶ä½†å°‘è¦‹</td></tr>
<tr><td><strong>Java</strong></td><td>âŒ</td><td>âœ…</td><td>å¯ä»¥æ§åˆ¶ä½†å°‘è¦‹</td></tr>
</tbody></table>
</div>
<h2 id="kernel-ebpf-vs-user-space-ç¨‹å¼"><a class="header" href="#kernel-ebpf-vs-user-space-ç¨‹å¼">Kernel eBPF vs User Space ç¨‹å¼</a></h2>
<p>é€™æ˜¯å…©å€‹<strong>å®Œå…¨ä¸åŒ</strong>çš„ç¨‹å¼ï¼</p>
<h3 id="å®Œæ•´ç¯„ä¾‹æª”æ¡ˆç›£æ§å·¥å…·"><a class="header" href="#å®Œæ•´ç¯„ä¾‹æª”æ¡ˆç›£æ§å·¥å…·">å®Œæ•´ç¯„ä¾‹ï¼šæª”æ¡ˆç›£æ§å·¥å…·</a></h3>
<h4 id="part-1-kernel-ebpf-ç¨‹å¼c-èªè¨€"><a class="header" href="#part-1-kernel-ebpf-ç¨‹å¼c-èªè¨€">Part 1: Kernel eBPF ç¨‹å¼ï¼ˆC èªè¨€ï¼‰</a></h4>
<pre><code class="language-c">// trace_open.c - åœ¨ kernel è£¡åŸ·è¡Œ
#include &lt;linux/bpf.h&gt;
#include &lt;linux/ptrace.h&gt;

// å®šç¾©å…±äº«çš„ Map
struct {
    __uint(type, BPF_MAP_TYPE_HASH);
    __uint(max_entries, 1024);
    __type(key, u32);
    __type(value, u64);
} open_count SEC(".maps");

// ç•¶æœ‰ç¨‹å¼å‘¼å« open() æ™‚è§¸ç™¼
SEC("kprobe/sys_open")
int trace_open(struct pt_regs *ctx) {
    u32 pid = bpf_get_current_pid_tgid() &gt;&gt; 32;
    u64 *count, init_val = 1;
    
    count = bpf_map_lookup_elem(&amp;open_count, &amp;pid);
    if (count) {
        (*count)++;
    } else {
        bpf_map_update_elem(&amp;open_count, &amp;pid, &amp;init_val, BPF_ANY);
    }
    
    return 0;
}
</code></pre>
<h4 id="part-2-user-space-æ§åˆ¶ç¨‹å¼å¤šç¨®èªè¨€"><a class="header" href="#part-2-user-space-æ§åˆ¶ç¨‹å¼å¤šç¨®èªè¨€">Part 2: User Space æ§åˆ¶ç¨‹å¼ï¼ˆå¤šç¨®èªè¨€ï¼‰</a></h4>
<p><strong>Python ç‰ˆæœ¬ï¼š</strong></p>
<pre><code class="language-python">#!/usr/bin/env python3
# monitor.py - åœ¨ä½¿ç”¨è€…ç©ºé–“åŸ·è¡Œ
from bcc import BPF
import time

# è¼‰å…¥ eBPF ç¨‹å¼åˆ° kernel
b = BPF(src_file="trace_open.c")

print("ç›£æ§æª”æ¡ˆé–‹å•Ÿä¸­... Ctrl+C çµæŸ")

while True:
    time.sleep(1)
    
    # å¾ kernel çš„ map è®€å–è³‡æ–™
    open_count = b["open_count"]
    
    print("\n=== æª”æ¡ˆé–‹å•Ÿçµ±è¨ˆ ===")
    for pid, count in open_count.items():
        print(f"PID {pid.value}: é–‹å•Ÿäº† {count.value} æ¬¡æª”æ¡ˆ")
    
    open_count.clear()
</code></pre>
<p><strong>Go ç‰ˆæœ¬ï¼š</strong></p>
<pre><code class="language-go">// monitor.go - åœ¨ä½¿ç”¨è€…ç©ºé–“åŸ·è¡Œ
package main

import (
    "fmt"
    "time"
    "github.com/cilium/ebpf"
)

func main() {
    // è¼‰å…¥ç·¨è­¯å¥½çš„ eBPF ç¨‹å¼
    spec, _ := ebpf.LoadCollectionSpec("trace_open.o")
    coll, _ := ebpf.NewCollection(spec)
    
    // å–å¾— map çš„åƒè€ƒ
    openCount := coll.Maps["open_count"]
    
    for {
        time.Sleep(1 * time.Second)
        
        var pid uint32
        var count uint64
        iter := openCount.Iterate()
        
        fmt.Println("\n=== æª”æ¡ˆé–‹å•Ÿçµ±è¨ˆ ===")
        for iter.Next(&amp;pid, &amp;count) {
            fmt.Printf("PID %d: é–‹å•Ÿäº† %d æ¬¡æª”æ¡ˆ\n", pid, count)
        }
    }
}
</code></pre>
<h3 id="é—œéµå·®ç•°æ¯”è¼ƒ"><a class="header" href="#é—œéµå·®ç•°æ¯”è¼ƒ">é—œéµå·®ç•°æ¯”è¼ƒ</a></h3>
<div class="table-wrapper"><table><thead><tr><th>ç‰¹æ€§</th><th><strong>Kernel eBPF ç¨‹å¼</strong></th><th><strong>User Space æ§åˆ¶ç¨‹å¼</strong></th></tr></thead><tbody>
<tr><td><strong>åŸ·è¡Œä½ç½®</strong></td><td>Kernel å…§éƒ¨</td><td>ä¸€èˆ¬ä½¿ç”¨è€…ç©ºé–“</td></tr>
<tr><td><strong>èªè¨€é¸æ“‡</strong></td><td>åªèƒ½ C/Rust</td><td>ä»»ä½•èªè¨€</td></tr>
<tr><td><strong>åŠŸèƒ½</strong></td><td>æ”¶é›†è³‡æ–™ã€éæ¿¾ã€æ±ºç­–</td><td>è¼‰å…¥ã€ç®¡ç†ã€é¡¯ç¤º</td></tr>
<tr><td><strong>é™åˆ¶</strong></td><td>è¶…åš´æ ¼ï¼ˆè¦‹ä¸‹æ–¹ï¼‰</td><td>ä¸€èˆ¬ç¨‹å¼ï¼Œç„¡ç‰¹æ®Šé™åˆ¶</td></tr>
<tr><td><strong>å¤§å°</strong></td><td>å¾ˆå°ï¼ˆKB ç­‰ç´šï¼‰</td><td>å¯ä»¥å¾ˆå¤§</td></tr>
<tr><td><strong>æ¬Šé™</strong></td><td>éœ€è¦ root æˆ– CAP_BPF</td><td>è¼‰å…¥æ™‚éœ€è¦æ¬Šé™</td></tr>
</tbody></table>
</div>
<h3 id="kernel-ebpf-ç¨‹å¼çš„é™åˆ¶"><a class="header" href="#kernel-ebpf-ç¨‹å¼çš„é™åˆ¶">Kernel eBPF ç¨‹å¼çš„é™åˆ¶</a></h3>
<p>âš ï¸ <strong>é‡è¦é™åˆ¶ï¼š</strong></p>
<ul>
<li>âŒ ä¸èƒ½æœ‰ç„¡é™è¿´åœˆ</li>
<li>âŒ ä¸èƒ½å‹•æ…‹åˆ†é…è¨˜æ†¶é«”</li>
<li>âŒ ä¸èƒ½å‘¼å«ä»»æ„å‡½å¼</li>
<li>âŒ ç¨‹å¼å¤§å°æœ‰é™åˆ¶ï¼ˆæœ€å¤§ 1MBï¼‰</li>
<li>âŒ å¿…é ˆåœ¨æœ‰é™æ­¥é©Ÿå…§çµæŸ</li>
<li>âœ… åªèƒ½ç”¨ç‰¹å®šçš„ BPF è¼”åŠ©å‡½å¼</li>
</ul>
<h2 id="å¯¦éš›é‹ä½œæµç¨‹"><a class="header" href="#å¯¦éš›é‹ä½œæµç¨‹">å¯¦éš›é‹ä½œæµç¨‹</a></h2>
<pre class="mermaid">graph TD
    A[User Space ç¨‹å¼å•Ÿå‹•] --&gt; B[è¼‰å…¥ eBPF å­—ç¯€ç¢¼åˆ° kernel]
    B --&gt; C[Kernel é©—è­‰å™¨æª¢æŸ¥å®‰å…¨æ€§]
    C --&gt; D{é©—è­‰é€šé?}
    D --&gt;|æ˜¯| E[eBPF ç¨‹å¼é–‹å§‹åœ¨ kernel åŸ·è¡Œ]
    D --&gt;|å¦| F[æ‹’çµ•è¼‰å…¥]
    E --&gt; G[äº‹ä»¶ç™¼ç”Ÿ&lt;br/&gt;å¦‚: é–‹æª”æ¡ˆã€æ”¶åˆ°å°åŒ…]
    G --&gt; H[eBPF ç¨‹å¼è¢«è§¸ç™¼]
    H --&gt; I[åœ¨ kernel æ”¶é›†/è™•ç†è³‡æ–™]
    I --&gt; J[å­˜åˆ° BPF Map]
    J --&gt; K[User Space ç¨‹å¼è®€å– Map]
    K --&gt; L[è™•ç†ä¸¦é¡¯ç¤ºè³‡æ–™]
</pre>
<h2 id="ç‚ºä»€éº¼è¦é€™æ¨£è¨­è¨ˆ"><a class="header" href="#ç‚ºä»€éº¼è¦é€™æ¨£è¨­è¨ˆ">ç‚ºä»€éº¼è¦é€™æ¨£è¨­è¨ˆï¼Ÿ</a></h2>
<h3 id="1-å®‰å…¨æ€§è€ƒé‡"><a class="header" href="#1-å®‰å…¨æ€§è€ƒé‡">1. å®‰å…¨æ€§è€ƒé‡</a></h3>
<ul>
<li>Kernel å´©æ½° = æ•´å€‹ç³»çµ±æ›æ‰</li>
<li>å¿…é ˆåš´æ ¼é™åˆ¶èƒ½åœ¨ kernel åŸ·è¡Œçš„ç¨‹å¼ç¢¼</li>
<li>é©—è­‰å™¨ç¢ºä¿ eBPF ç¨‹å¼çµ•å°å®‰å…¨</li>
</ul>
<h3 id="2-æ•ˆèƒ½è€ƒé‡"><a class="header" href="#2-æ•ˆèƒ½è€ƒé‡">2. æ•ˆèƒ½è€ƒé‡</a></h3>
<ul>
<li>Kernel ç¨‹å¼å¿…é ˆæ¥µå¿«</li>
<li>ä¸èƒ½æœ‰ GC æš«åœ</li>
<li>ä¸èƒ½æœ‰å‹•æ…‹è¨˜æ†¶é«”åˆ†é…</li>
</ul>
<h3 id="3-åˆ†å·¥æ˜ç¢º"><a class="header" href="#3-åˆ†å·¥æ˜ç¢º">3. åˆ†å·¥æ˜ç¢º</a></h3>
<div class="table-wrapper"><table><thead><tr><th>å…ƒä»¶</th><th>è·è²¬</th><th>æ¯”å–»</th></tr></thead><tbody>
<tr><td><strong>Kernel eBPF</strong></td><td>å¿«é€Ÿã€å³æ™‚çš„è³‡æ–™æ”¶é›†</td><td>ç¾å ´çš„é–“è«œ</td></tr>
<tr><td><strong>User Space</strong></td><td>è³‡æ–™åˆ†æã€è¦–è¦ºåŒ–ã€å„²å­˜</td><td>æŒ‡æ®ä¸­å¿ƒ</td></tr>
</tbody></table>
</div>
<h2 id="ä¸»è¦æ¡†æ¶å’Œå·¥å…·"><a class="header" href="#ä¸»è¦æ¡†æ¶å’Œå·¥å…·">ä¸»è¦æ¡†æ¶å’Œå·¥å…·</a></h2>
<h3 id="bcc-bpf-compiler-collection"><a class="header" href="#bcc-bpf-compiler-collection">BCC (BPF Compiler Collection)</a></h3>
<p>æœ€æµè¡Œçš„æ¡†æ¶ï¼Œæ”¯æ´ Python å’Œ Cï¼š</p>
<pre><code class="language-python">from bcc import BPF

# æ··åˆ Python å’Œ C
b = BPF(text="""
    int hello(void *ctx) {
        bpf_trace_printk("Hello World\\n");
        return 0;
    }
""")
</code></pre>
<h3 id="libbpf"><a class="header" href="#libbpf">libbpf</a></h3>
<p>åŸç”Ÿ C å‡½å¼åº«ï¼Œæœ€æ¥è¿‘åº•å±¤ï¼š</p>
<pre><code class="language-c">struct bpf_object *obj;
obj = bpf_object__open("program.o");
bpf_object__load(obj);
</code></pre>
<h3 id="aya-rust"><a class="header" href="#aya-rust">Aya (Rust)</a></h3>
<p>ç´” Rust å¯¦ç¾ï¼Œå‹åˆ¥å®‰å…¨ï¼š</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use aya::{Bpf, programs::KProbe};

let mut bpf = Bpf::load_file("program.o")?;
let program: &amp;mut KProbe = bpf.program_mut("trace_open")?;
program.attach("sys_open", 0)?;
<span class="boring">}</span></code></pre></pre>
<h2 id="bcc-vs-co-re-æ¡†æ¶è©³ç´°æ¯”è¼ƒ"><a class="header" href="#bcc-vs-co-re-æ¡†æ¶è©³ç´°æ¯”è¼ƒ">BCC vs CO-RE æ¡†æ¶è©³ç´°æ¯”è¼ƒ</a></h2>
<p>é€™æ˜¯ä¸€å€‹å¾ˆå¥½çš„å•é¡Œï¼è®“æˆ‘è§£é‡‹ä¸€ä¸‹ BCC å’Œé€™äº› CO-RE æ¡†æ¶ä¹‹é–“çš„ä¸»è¦å·®ç•°ï¼š</p>
<h3 id="bcc-ç¢ºå¯¦æ˜¯æ¡†æ¶ä½†æœ‰é‡è¦å€åˆ¥"><a class="header" href="#bcc-ç¢ºå¯¦æ˜¯æ¡†æ¶ä½†æœ‰é‡è¦å€åˆ¥">BCC ç¢ºå¯¦æ˜¯æ¡†æ¶ï¼Œä½†æœ‰é‡è¦å€åˆ¥</a></h3>
<h4 id="bcc-bpf-compiler-collection-1"><a class="header" href="#bcc-bpf-compiler-collection-1"><strong>BCC (BPF Compiler Collection)</strong></a></h4>
<p>BCC æ˜¯ä¸€å€‹ eBPF é–‹ç™¼æ¡†æ¶ï¼Œä½†å®ƒæ¡ç”¨çš„æ˜¯<strong>åŸ·è¡Œæ™‚ç·¨è­¯</strong>æ¨¡å¼ï¼š</p>
<p><strong>ç‰¹é»ï¼š</strong></p>
<ul>
<li><strong>åŸ·è¡Œæ™‚ç·¨è­¯</strong>ï¼šåœ¨ç›®æ¨™æ©Ÿå™¨ä¸Šå³æ™‚ç·¨è­¯ eBPF ç¨‹å¼</li>
<li><strong>éœ€è¦æ ¸å¿ƒæ¨™é ­æª”</strong>ï¼šå¿…é ˆåœ¨ç›®æ¨™ç³»çµ±ä¸Šå®‰è£ kernel headers</li>
<li><strong>ä¾è³´è¼ƒé‡</strong>ï¼šéœ€è¦ LLVM/Clang å·¥å…·éˆï¼ˆé€šå¸¸è¶…é 100MBï¼‰</li>
<li><strong>Python/C++ å‰ç«¯</strong>ï¼šä¸»è¦é€é Python æ’°å¯«æ§åˆ¶é‚è¼¯</li>
<li><strong>ä¾¿æ–¼å¿«é€ŸåŸå‹é–‹ç™¼</strong>ï¼šç¨‹å¼ç¢¼ç°¡å–®ï¼Œé©åˆå­¸ç¿’å’Œå¯¦é©—</li>
</ul>
<p><strong>BCC çš„å·¥ä½œæµç¨‹ï¼š</strong></p>
<pre><code>é–‹ç™¼æ©Ÿå™¨                     ç›®æ¨™æ©Ÿå™¨
   â”‚                           â”‚
   â””â”€â”€â”€â”€ Python/C ç¨‹å¼ â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                               â”‚
                               â”œâ”€&gt; è¼‰å…¥æ™‚ç·¨è­¯ eBPF ç¨‹å¼
                               â”œâ”€&gt; éœ€è¦ kernel headers
                               â”œâ”€&gt; éœ€è¦ LLVM/Clang
                               â””â”€&gt; åŸ·è¡Œ
</code></pre>
<h4 id="co-re-æ¡†æ¶libbpf-ç­‰"><a class="header" href="#co-re-æ¡†æ¶libbpf-ç­‰"><strong>CO-RE æ¡†æ¶ï¼ˆlibbpf ç­‰ï¼‰</strong></a></h4>
<p>CO-REï¼ˆCompile Once, Run Everywhereï¼‰æ˜¯ä¸€ç¨®æ–°çš„é–‹ç™¼æ¨¡å¼ï¼š</p>
<p><strong>ç‰¹é»ï¼š</strong></p>
<ul>
<li><strong>é ç·¨è­¯</strong>ï¼šé–‹ç™¼æ™‚ç·¨è­¯ä¸€æ¬¡ï¼Œç”¢ç”Ÿå¯æ”œå¼çš„äºŒé€²ä½æª”æ¡ˆ</li>
<li><strong>ç„¡éœ€æ ¸å¿ƒæ¨™é ­æª”</strong>ï¼šåŸ·è¡Œæ™‚ä¸éœ€è¦ kernel headers</li>
<li><strong>è¼•é‡ç´šéƒ¨ç½²</strong>ï¼šåªéœ€è¦å¾ˆå°çš„åŸ·è¡Œæ™‚å‡½å¼åº«ï¼ˆå¹¾ MBï¼‰</li>
<li><strong>BTF ä¾è³´</strong>ï¼šåˆ©ç”¨æ ¸å¿ƒçš„ BTFï¼ˆBPF Type Formatï¼‰è³‡è¨Šå¯¦ç¾å¯æ”œæ€§</li>
<li><strong>ç”Ÿç”¢ç’°å¢ƒå‹å–„</strong>ï¼šé©åˆå¤§è¦æ¨¡éƒ¨ç½²</li>
</ul>
<p><strong>CO-RE çš„å·¥ä½œæµç¨‹ï¼š</strong></p>
<pre><code>é–‹ç™¼æ©Ÿå™¨                     ç›®æ¨™æ©Ÿå™¨
   â”‚                           â”‚
   â”œâ”€&gt; ç·¨è­¯ eBPF ç¨‹å¼          â”‚
   â”œâ”€&gt; ç”¢ç”Ÿ .o æª”æ¡ˆ            â”‚
   â””â”€â”€â”€â”€ äºŒé€²ä½æª”æ¡ˆ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                               â”‚
                               â”œâ”€&gt; ç›´æ¥è¼‰å…¥
                               â”œâ”€&gt; ä½¿ç”¨ BTF é‡å®šä½
                               â”œâ”€&gt; åªéœ€å°å‹ libbpf
                               â””â”€&gt; åŸ·è¡Œ
</code></pre>
<h3 id="ä¸»è¦å·®ç•°å°æ¯”"><a class="header" href="#ä¸»è¦å·®ç•°å°æ¯”">ä¸»è¦å·®ç•°å°æ¯”</a></h3>
<div class="table-wrapper"><table><thead><tr><th>ç‰¹æ€§</th><th>BCC</th><th>CO-RE (libbpfç­‰)</th></tr></thead><tbody>
<tr><td><strong>ç·¨è­¯æ™‚æ©Ÿ</strong></td><td>åŸ·è¡Œæ™‚ç·¨è­¯</td><td>é–‹ç™¼æ™‚é ç·¨è­¯</td></tr>
<tr><td><strong>éƒ¨ç½²ä¾è³´</strong></td><td>éœ€è¦ kernel headers + LLVM</td><td>åªéœ€å°å‹åŸ·è¡Œæ™‚å‡½å¼åº«</td></tr>
<tr><td><strong>å¯æ”œæ€§</strong></td><td>å·®ï¼ˆä¾è³´ç›®æ¨™ç³»çµ±ç’°å¢ƒï¼‰</td><td>å¥½ï¼ˆä¸€æ¬¡ç·¨è­¯ï¼Œåˆ°è™•åŸ·è¡Œï¼‰</td></tr>
<tr><td><strong>å•Ÿå‹•é€Ÿåº¦</strong></td><td>æ…¢ï¼ˆéœ€è¦ç·¨è­¯ï¼‰</td><td>å¿«ï¼ˆç›´æ¥è¼‰å…¥ï¼‰</td></tr>
<tr><td><strong>è³‡æºä½”ç”¨</strong></td><td>å¤§ï¼ˆ100MB+ï¼‰</td><td>å°ï¼ˆå¹¾MBï¼‰</td></tr>
<tr><td><strong>ç”Ÿç”¢éƒ¨ç½²</strong></td><td>ä¸ç†æƒ³</td><td>ç†æƒ³</td></tr>
<tr><td><strong>é–‹ç™¼é›£åº¦</strong></td><td>ç°¡å–®</td><td>ç›¸å°è¤‡é›œ</td></tr>
<tr><td><strong>æ ¸å¿ƒç‰ˆæœ¬è¦æ±‚</strong></td><td>è¼ƒä½ï¼ˆ3.15+ï¼‰</td><td>è¼ƒé«˜ï¼ˆ5.2+ å»ºè­°ï¼‰</td></tr>
</tbody></table>
</div>
<h3 id="å¯¦éš›ç¨‹å¼ç¢¼æ¯”è¼ƒ"><a class="header" href="#å¯¦éš›ç¨‹å¼ç¢¼æ¯”è¼ƒ">å¯¦éš›ç¨‹å¼ç¢¼æ¯”è¼ƒ</a></h3>
<p><strong>BCC ç¯„ä¾‹ï¼š</strong></p>
<pre><code class="language-python">from bcc import BPF

# eBPF ç¨‹å¼ç›´æ¥åµŒå…¥ Python å­—ä¸²ä¸­
prog = """
int trace_open(struct pt_regs *ctx) {
    bpf_trace_printk("File opened\\n");
    return 0;
}
"""

# åŸ·è¡Œæ™‚ç·¨è­¯
b = BPF(text=prog)
b.attach_kprobe(event="sys_open", fn_name="trace_open")
</code></pre>
<p><strong>CO-RE (libbpf) ç¯„ä¾‹ï¼š</strong></p>
<pre><code class="language-c">// trace_open.bpf.c - é å…ˆç·¨è­¯
#include &lt;vmlinux.h&gt;
#include &lt;bpf/bpf_helpers.h&gt;

SEC("kprobe/sys_open")
int trace_open(struct pt_regs *ctx) {
    bpf_printk("File opened\n");
    return 0;
}

// ç·¨è­¯å‘½ä»¤ï¼š
// clang -O2 -target bpf -c trace_open.bpf.c -o trace_open.bpf.o
</code></pre>
<pre><code class="language-c">// loader.c - è¼‰å…¥ç¨‹å¼
#include &lt;bpf/libbpf.h&gt;

int main() {
    struct bpf_object *obj;
    
    // ç›´æ¥è¼‰å…¥é ç·¨è­¯çš„ .o æª”æ¡ˆ
    obj = bpf_object__open_file("trace_open.bpf.o", NULL);
    bpf_object__load(obj);
    // ...
}
</code></pre>
<h3 id="å„æ¡†æ¶çš„å®šä½"><a class="header" href="#å„æ¡†æ¶çš„å®šä½">å„æ¡†æ¶çš„å®šä½</a></h3>
<ul>
<li><strong>libbpf</strong>ï¼šå®˜æ–¹ C å‡½å¼åº«ï¼ŒCO-RE çš„åŸºç¤</li>
<li><strong>Cilium/ebpf</strong>ï¼šGo èªè¨€çš„ CO-RE æ¡†æ¶</li>
<li><strong>libbpf-rs</strong>ï¼šRust èªè¨€çš„ libbpf ç¶å®š</li>
<li><strong>eunomia-bpf</strong>ï¼šç°¡åŒ–çš„ eBPF é–‹ç™¼æ¡†æ¶ï¼Œæ”¯æ´å¤šèªè¨€</li>
<li><strong>Aya</strong>ï¼šç´” Rust å¯¦ç¾ï¼Œæ”¯æ´ CO-RE</li>
</ul>
<h3 id="é¸æ“‡å»ºè­°"><a class="header" href="#é¸æ“‡å»ºè­°">é¸æ“‡å»ºè­°</a></h3>
<p><strong>ä½¿ç”¨ BCC çš„å ´æ™¯ï¼š</strong></p>
<ul>
<li>ğŸ“ å­¸ç¿’å’Œå¯¦é©— eBPF</li>
<li>ğŸ”§ å¿«é€ŸåŸå‹é–‹ç™¼</li>
<li>ğŸ› é–‹ç™¼ç’°å¢ƒä¸­çš„èª¿è©¦å·¥å…·</li>
<li>ğŸ“Š ä¸€æ¬¡æ€§çš„ç³»çµ±åˆ†æä»»å‹™</li>
</ul>
<p><strong>ä½¿ç”¨ CO-RE çš„å ´æ™¯ï¼š</strong></p>
<ul>
<li>ğŸ­ ç”Ÿç”¢ç’°å¢ƒéƒ¨ç½²</li>
<li>ğŸ“¦ å®¹å™¨/é›²åŸç”Ÿç’°å¢ƒ</li>
<li>ğŸ”’ å®‰å…¨ç”¢å“é–‹ç™¼</li>
<li>ğŸ“± åµŒå…¥å¼ç³»çµ±</li>
<li>ğŸš€ éœ€è¦å¿«é€Ÿå•Ÿå‹•çš„å ´æ™¯</li>
</ul>
<h3 id="é·ç§»è·¯å¾‘"><a class="header" href="#é·ç§»è·¯å¾‘">é·ç§»è·¯å¾‘</a></h3>
<p>å¦‚æœä½ å·²ç¶“ä½¿ç”¨ BCCï¼Œæƒ³è¦é·ç§»åˆ° CO-REï¼š</p>
<ol>
<li><strong>è©•ä¼°æ ¸å¿ƒç‰ˆæœ¬</strong>ï¼šç¢ºä¿ç›®æ¨™ç³»çµ±æ”¯æ´ BTFï¼ˆ5.2+ï¼‰</li>
<li><strong>é¸æ“‡æ¡†æ¶</strong>ï¼šæ ¹æ“šä½ çš„èªè¨€åå¥½é¸æ“‡ libbpf/Cilium/Aya</li>
<li><strong>é‡å¯« eBPF ç¨‹å¼</strong>ï¼šå°‡ BCC çš„å…§åµŒ C ç¨‹å¼ç¢¼ç¨ç«‹å‡ºä¾†</li>
<li><strong>èª¿æ•´è¼‰å…¥é‚è¼¯</strong>ï¼šä½¿ç”¨æ–°æ¡†æ¶çš„ API è¼‰å…¥é ç·¨è­¯ç¨‹å¼</li>
<li><strong>æ¸¬è©¦å¯æ”œæ€§</strong>ï¼šåœ¨ä¸åŒæ ¸å¿ƒç‰ˆæœ¬ä¸Šæ¸¬è©¦</li>
</ol>
<p>ç°¡å–®ä¾†èªªï¼ŒBCC åƒæ˜¯ã€Œç›´è­¯å¼èªè¨€ã€ï¼Œè€Œ CO-RE åƒæ˜¯ã€Œç·¨è­¯å¼èªè¨€ã€ã€‚å…©è€…éƒ½æ˜¯æ¡†æ¶ï¼Œä½†è¨­è¨ˆç†å¿µå’Œä½¿ç”¨å ´æ™¯æœ‰å¾ˆå¤§å·®ç•°ã€‚é¸æ“‡å“ªå€‹å–æ±ºæ–¼ä½ çš„å…·é«”éœ€æ±‚ï¼šå¦‚æœæ˜¯å­¸ç¿’æˆ–å¿«é€Ÿå¯¦é©—ï¼ŒBCC æ˜¯å¾ˆå¥½çš„èµ·é»ï¼›å¦‚æœæ˜¯ç”Ÿç”¢éƒ¨ç½²ï¼ŒCO-RE æ˜¯æ›´å¥½çš„é¸æ“‡ã€‚</p>
<h2 id="ç¸½çµ"><a class="header" href="#ç¸½çµ">ç¸½çµ</a></h2>
<p>eBPF æ˜¯ä¸€é …é©å‘½æ€§çš„æŠ€è¡“ï¼Œå®ƒè®“æˆ‘å€‘èƒ½å¤ ï¼š</p>
<ol>
<li><strong>å®‰å…¨åœ°</strong>æ“´å±•å…§æ ¸åŠŸèƒ½</li>
<li><strong>é«˜æ•ˆåœ°</strong>è™•ç†ç¶²è·¯å’Œç³»çµ±äº‹ä»¶</li>
<li><strong>éˆæ´»åœ°</strong>è§€å¯Ÿå’Œä¿®æ”¹ç³»çµ±è¡Œç‚º</li>
</ol>
<p>é€éåš´æ ¼çš„é™åˆ¶å’Œé©—è­‰æ©Ÿåˆ¶ï¼ŒeBPF åœ¨æä¾›å¼·å¤§åŠŸèƒ½çš„åŒæ™‚ä¿è­‰äº†ç³»çµ±å®‰å…¨æ€§ï¼Œé€™å°±æ˜¯ç‚ºä»€éº¼å®ƒæˆç‚ºç¾ä»£ Linux ç³»çµ±ä¸­ä¸å¯æˆ–ç¼ºçš„æŠ€è¡“ã€‚</p>
<hr />
<p>ğŸ“š <strong>å»¶ä¼¸é–±è®€ï¼š</strong></p>
<ul>
<li><a href="https://ebpf.io/">ebpf.io</a> - eBPF å®˜æ–¹ç¶²ç«™</li>
<li><a href="http://docs.cilium.io/en/latest/bpf/">Cilium BPF Reference Guide</a> - æ·±å…¥çš„ eBPF æ–‡æª”</li>
<li><a href="https://www.brendangregg.com/ebpf.html">Brendan Gregg's eBPF Page</a> - æ•ˆèƒ½åˆ†æå¤§å¸«çš„ eBPF è³‡æº</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../linux_system/ebpf-complete-guide.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../linux_system/libbpf-explained.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../linux_system/ebpf-complete-guide.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../linux_system/libbpf-explained.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="../ace.js"></script>
        <script src="../mode-rust.js"></script>
        <script src="../editor.js"></script>
        <script src="../theme-dawn.js"></script>
        <script src="../theme-tomorrow_night.js"></script>

        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../mermaid.min.js"></script>
        <script src="../mermaid-init.js"></script>



    </div>
    </body>
</html>
