<!DOCTYPE HTML>
<html lang="zh" class="rust sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Ruler Documentation - Jason Notes</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "rust";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Jason Notes</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/shihyu/jason_note" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="ruler---統一-ai-編程工具規則管理系統"><a class="header" href="#ruler---統一-ai-編程工具規則管理系統">Ruler - 統一 AI 編程工具規則管理系統</a></h1>
<h2 id="目錄"><a class="header" href="#目錄">目錄</a></h2>
<ul>
<li><a href="#%E5%B0%88%E6%A1%88%E6%A6%82%E8%BF%B0">專案概述</a></li>
<li><a href="#%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD">核心功能</a></li>
<li><a href="#%E5%BF%AB%E9%80%9F%E9%96%8B%E5%A7%8B">快速開始</a></li>
<li><a href="#%E6%AA%94%E6%A1%88%E7%B5%90%E6%A7%8B">檔案結構</a></li>
<li><a href="#%E9%85%8D%E7%BD%AE%E8%A9%B3%E8%A7%A3">配置詳解</a></li>
<li><a href="#%E9%80%B2%E9%9A%8E%E5%8A%9F%E8%83%BD">進階功能</a></li>
<li><a href="#%E6%9C%80%E4%BD%B3%E5%AF%A6%E8%B8%90">最佳實踐</a></li>
<li><a href="#%E6%94%AF%E6%8F%B4%E7%9A%84-ai-%E5%B7%A5%E5%85%B7">支援的 AI 工具</a></li>
</ul>
<h2 id="專案概述"><a class="header" href="#專案概述">專案概述</a></h2>
<p><strong>Ruler</strong> 的設計哲學是「<strong>apply the same rules to all coding agents</strong>」，它不僅提供統一的規則管理，更重要的是確保這些規則能夠有效地傳達給各種 AI 編程工具，並透過自動化機制保證規則的執行一致性。</p>
<h3 id="解決的核心問題"><a class="header" href="#解決的核心問題">解決的核心問題</a></h3>
<p>在多 AI 工具的開發環境中，團隊面臨的挑戰包括：</p>
<ul>
<li><strong>不一致的指導</strong>：不同 AI 工具間的規則不統一</li>
<li><strong>重複維護成本</strong>：需要維護多個配置檔案</li>
<li><strong>上下文漂移</strong>：隨著專案需求演變，規則容易不同步</li>
<li><strong>新工具導入困難</strong>：每次引入新 AI 工具都需要重新配置</li>
<li><strong>複雜專案結構</strong>：不同元件需要不同的上下文特定指令</li>
</ul>
<h3 id="ruler-的解決方案"><a class="header" href="#ruler-的解決方案">Ruler 的解決方案</a></h3>
<p>Ruler 透過以下機制解決這些問題：</p>
<ol>
<li><strong>集中化規則管理</strong>：使用專門的 <code>.ruler/</code> 目錄儲存所有 AI 指令</li>
<li><strong>巢狀規則載入</strong>：支援複雜專案結構的上下文特定指令</li>
<li><strong>自動分發機制</strong>：自動將規則套用到支援的 AI 代理工具配置檔案</li>
<li><strong>精確代理配置</strong>：透過 <code>ruler.toml</code> 細調哪些代理受影響及其特定輸出路徑</li>
<li><strong>MCP 伺服器傳播</strong>：管理和分發 Model Context Protocol (MCP) 伺服器設定</li>
</ol>
<h2 id="核心功能"><a class="header" href="#核心功能">核心功能</a></h2>
<h3 id="1-統一規則管理"><a class="header" href="#1-統一規則管理">1. 統一規則管理</a></h3>
<ul>
<li>單一來源的真實性（Single Source of Truth）</li>
<li>跨多個 AI 工具的一致性</li>
<li>自動化規則分發</li>
</ul>
<h3 id="2-巢狀規則載入"><a class="header" href="#2-巢狀規則載入">2. 巢狀規則載入</a></h3>
<ul>
<li>支援 Monorepo 架構</li>
<li>上下文感知的規則應用</li>
<li>階層式規則繼承</li>
</ul>
<h3 id="3-mcp-伺服器整合"><a class="header" href="#3-mcp-伺服器整合">3. MCP 伺服器整合</a></h3>
<ul>
<li>Model Context Protocol 支援</li>
<li>統一的伺服器配置管理</li>
<li>跨工具的上下文共享</li>
</ul>
<h3 id="4-版本控制整合"><a class="header" href="#4-版本控制整合">4. 版本控制整合</a></h3>
<ul>
<li>自動 <code>.gitignore</code> 管理</li>
<li>備份與回復機制</li>
<li>安全的實驗環境</li>
</ul>
<h2 id="ruler-的運作原理"><a class="header" href="#ruler-的運作原理">Ruler 的運作原理</a></h2>
<h3 id="規則檔案的標準化輸出"><a class="header" href="#規則檔案的標準化輸出">規則檔案的標準化輸出</a></h3>
<p>當你執行 <code>ruler apply</code> 時，ruler 會：</p>
<ol>
<li><strong>讀取</strong> <code>.ruler/</code> 目錄下的所有規則檔案</li>
<li><strong>自動生成</strong>每個 AI 工具專屬的配置檔案</li>
<li><strong>寫入</strong>到各 AI 工具預期的位置</li>
</ol>
<pre><code class="language-bash"># 執行 ruler apply 後的檔案生成流程
.ruler/AGENTS.md  ──────┐
.ruler/coding_style.md  ├──&gt; 自動轉換並生成
.ruler/api_rules.md     │
                        ↓
├── CLAUDE.md                    # Claude Code 會讀取這個
├── .cursor/rules/ruler_cursor_instructions.mdc  # Cursor 會讀取這個
├── .github/copilot-instructions.md  # GitHub Copilot 會讀取這個
├── .codex/rules.md              # Codex 會讀取這個
└── .clinerules                  # Cline 會讀取這個
</code></pre>
<h3 id="ai-工具的內建機制"><a class="header" href="#ai-工具的內建機制">AI 工具的內建機制</a></h3>
<p>每個 AI 工具都有自己的<strong>規則檔案約定</strong>：</p>
<div class="table-wrapper"><table><thead><tr><th>AI 工具</th><th>預期的規則檔案位置</th><th>工具如何發現規則</th></tr></thead><tbody>
<tr><td><strong>Claude Code</strong></td><td><code>CLAUDE.md</code> (根目錄)</td><td>Claude Code 啟動時自動掃描專案根目錄尋找 <code>CLAUDE.md</code></td></tr>
<tr><td><strong>Cursor</strong></td><td><code>.cursor/rules/*.mdc</code></td><td>Cursor IDE 會自動載入 <code>.cursor/rules/</code> 目錄下的所有 <code>.mdc</code> 檔案</td></tr>
<tr><td><strong>GitHub Copilot</strong></td><td><code>.github/copilot-instructions.md</code></td><td>Copilot 擴充功能會自動讀取這個路徑</td></tr>
<tr><td><strong>Windsurf</strong></td><td><code>.windsurf/rules/*.md</code></td><td>Windsurf 會掃描其專屬目錄</td></tr>
<tr><td><strong>Cline</strong></td><td><code>.clinerules</code></td><td>Cline 會在專案根目錄尋找這個檔案</td></tr>
<tr><td><strong>Aider</strong></td><td><code>AGENTS.md</code>, <code>.aider.conf.yml</code></td><td>Aider 會讀取這兩個配置檔案</td></tr>
<tr><td><strong>Codex</strong></td><td><code>.codex/rules.md</code></td><td>Codex 會在專案中掃描 <code>.codex/</code> 目錄下的規則檔案</td></tr>
</tbody></table>
</div>
<h3 id="運作流程圖"><a class="header" href="#運作流程圖">運作流程圖</a></h3>
<pre><code>開發者編寫規則 → ruler apply → 生成各工具配置 → AI 工具自動載入
     ↓                ↓              ↓                ↓
.ruler/AGENTS.md   處理與轉換    CLAUDE.md等      即時生效
</code></pre>
<h3 id="為什麼-ai-工具會遵守這些規則"><a class="header" href="#為什麼-ai-工具會遵守這些規則">為什麼 AI 工具會遵守這些規則？</a></h3>
<ol>
<li>
<p><strong>約定優於配置 (Convention over Configuration)</strong></p>
<ul>
<li>每個 AI 工具都有預定義的檔案路徑</li>
<li>它們會自動尋找並載入這些檔案</li>
</ul>
</li>
<li>
<p><strong>自動發現機制</strong></p>
<ul>
<li>AI 工具在啟動或每次互動時會掃描特定位置</li>
<li>發現規則檔案後自動載入並應用</li>
</ul>
</li>
<li>
<p><strong>即時生效</strong></p>
<ul>
<li>大多數工具在每次互動時重新讀取規則</li>
<li>某些工具可能需要重新啟動才能載入新規則</li>
</ul>
</li>
</ol>
<h3 id="mcp-model-context-protocol-的角色"><a class="header" href="#mcp-model-context-protocol-的角色">MCP (Model Context Protocol) 的角色</a></h3>
<p>MCP 檔案提供額外的上下文配置，定義 AI 工具可以訪問的外部服務和資源：</p>
<ul>
<li><strong><code>.mcp.json</code></strong> - Claude Code 的 MCP 伺服器配置</li>
<li><strong><code>.cursor/mcp.json</code></strong> - Cursor 的 MCP 伺服器配置</li>
<li><strong><code>.vscode/mcp.json</code></strong> - GitHub Copilot 的 MCP 配置</li>
</ul>
<p>這些配置允許 AI 工具訪問檔案系統、Git 倉庫、資料庫等外部資源。</p>
<h2 id="快速開始"><a class="header" href="#快速開始">快速開始</a></h2>
<h3 id="安裝"><a class="header" href="#安裝">安裝</a></h3>
<pre><code class="language-bash"># 全域安裝（推薦用於 CLI）
npm install -g @intellectronica/ruler

# 或使用 npx（一次性命令）
npx @intellectronica/ruler apply
</code></pre>
<h3 id="初始化專案"><a class="header" href="#初始化專案">初始化專案</a></h3>
<pre><code class="language-bash"># 導航到專案根目錄
cd your-project

# 初始化 ruler
ruler init

# 建立全域配置（可選）
ruler init --global
</code></pre>
<h3 id="套用規則"><a class="header" href="#套用規則">套用規則</a></h3>
<pre><code class="language-bash"># 套用規則到所有配置的代理工具
ruler apply

# 只套用到特定代理工具
ruler apply --agents copilot,claude,codex

# 使用巢狀規則載入
ruler apply --nested

# 預覽變更而不實際寫入檔案
ruler apply --dry-run
</code></pre>
<h2 id="檔案結構"><a class="header" href="#檔案結構">檔案結構</a></h2>
<h3 id="基本目錄結構"><a class="header" href="#基本目錄結構">基本目錄結構</a></h3>
<pre><code>.ruler/
├── AGENTS.md           # 主要規則檔案
├── ruler.toml          # 主配置檔案
└── coding_style.md     # 額外的規則檔案
</code></pre>
<h3 id="規則檔案優先順序"><a class="header" href="#規則檔案優先順序">規則檔案優先順序</a></h3>
<ol>
<li><strong>儲存庫根目錄的 <code>AGENTS.md</code></strong>（最高優先級，會被前置）</li>
<li><strong><code>.ruler/AGENTS.md</code></strong>（新的預設起始檔案）</li>
<li><strong>傳統的 <code>.ruler/instructions.md</code></strong>（僅當 <code>.ruler/AGENTS.md</code> 不存在時）</li>
<li><strong>其餘在 <code>.ruler/</code> 下的 <code>*.md</code> 檔案</strong>（按排序順序）</li>
</ol>
<p>每個檔案的內容都會加上 <code>--- Source: &lt;relative_path_to_md_file&gt; ---</code> 標記以便追蹤。</p>
<h3 id="巢狀規則結構範例"><a class="header" href="#巢狀規則結構範例">巢狀規則結構範例</a></h3>
<pre><code>project/
├── .ruler/                 # 全域專案規則
│   ├── AGENTS.md
│   └── coding_style.md
├── src/
│   └── .ruler/             # 元件特定規則
│       └── api_guidelines.md
├── tests/
│   └── .ruler/             # 測試特定規則
│       └── testing_conventions.md
└── docs/
    └── .ruler/             # 文檔規則
        └── writing_style.md
</code></pre>
<h2 id="配置詳解"><a class="header" href="#配置詳解">配置詳解</a></h2>
<h3 id="rulertoml-配置檔案"><a class="header" href="#rulertoml-配置檔案">ruler.toml 配置檔案</a></h3>
<pre><code class="language-toml"># 預設執行的代理工具
default_agents = ["copilot", "claude", "aider", "codex"]

# 全域 MCP 伺服器配置
[mcp]
enabled = true
merge_strategy = "merge"

# MCP 伺服器定義
[mcp_servers.filesystem]
command = "npx"
args = ["-y", "@modelcontextprotocol/server-filesystem", "/path/to/project"]

[mcp_servers.git]
command = "npx"
args = ["-y", "@modelcontextprotocol/server-git", "--repository", "."]

# 自動 .gitignore 配置
[gitignore]
enabled = true

# 代理工具特定配置
[agents.copilot]
enabled = true
output_path = ".github/copilot-instructions.md"

[agents.claude]
enabled = true
output_path = "CLAUDE.md"

[agents.cursor]
enabled = true
output_path = ".cursor/rules/ruler_cursor_instructions.mdc"

[agents.codex]
enabled = true
output_path = ".codex/rules.md"
mcp_config_path = ".codex/mcp.json"
</code></pre>
<h3 id="mcp-伺服器配置"><a class="header" href="#mcp-伺服器配置">MCP 伺服器配置</a></h3>
<h4 id="本地stdio-伺服器"><a class="header" href="#本地stdio-伺服器">本地/stdio 伺服器</a></h4>
<pre><code class="language-toml">[mcp_servers.local_server]
command = "node"
args = ["server.js"]

[mcp_servers.local_server.env]
DEBUG = "1"
API_KEY = "your-api-key"
</code></pre>
<h4 id="遠端伺服器"><a class="header" href="#遠端伺服器">遠端伺服器</a></h4>
<pre><code class="language-toml">[mcp_servers.remote_server]
url = "https://api.example.com"

[mcp_servers.remote_server.headers]
Authorization = "Bearer token"
"X-API-Version" = "v1"
</code></pre>
<h2 id="進階功能"><a class="header" href="#進階功能">進階功能</a></h2>
<h3 id="codex-整合配置"><a class="header" href="#codex-整合配置">Codex 整合配置</a></h3>
<h4 id="codex-特定設定"><a class="header" href="#codex-特定設定">Codex 特定設定</a></h4>
<p>Codex 是一個先進的 AI 編程助手，支援深度程式碼理解和生成。透過 Ruler 可以為 Codex 配置特定的規則和 MCP 伺服器。</p>
<h5 id="基本-codex-配置-rulercodex_configmd"><a class="header" href="#基本-codex-配置-rulercodex_configmd">基本 Codex 配置 (.ruler/codex_config.md)</a></h5>
<pre><code class="language-markdown"># Codex 開發規範

## 程式碼生成原則
- 優先生成可測試和可維護的程式碼
- 遵循 SOLID 原則
- 使用適當的設計模式
- 生成程式碼時包含必要的註解

## 效能優化
- 避免不必要的記憶體分配
- 使用適當的資料結構
- 考慮時間和空間複雜度

## API 設計
- 保持介面簡潔明瞭
- 提供清晰的錯誤訊息
- 實作適當的驗證邏輯
</code></pre>
<h5 id="codex-mcp-伺服器配置"><a class="header" href="#codex-mcp-伺服器配置">Codex MCP 伺服器配置</a></h5>
<p>在 <code>ruler.toml</code> 中加入 Codex 特定的 MCP 伺服器：</p>
<pre><code class="language-toml">[agents.codex]
enabled = true
output_path = ".codex/rules.md"
mcp_config_path = ".codex/mcp.json"
# Codex 特定選項
use_context_aware_generation = true
max_context_length = 8000
include_test_generation = true

[mcp_servers.codex_analyzer]
command = "npx"
args = ["-y", "@modelcontextprotocol/server-code-analyzer"]
# Codex 專用的程式碼分析伺服器

[mcp_servers.codex_linter]
command = "npx"
args = ["-y", "@modelcontextprotocol/server-eslint", "--config", ".eslintrc.json"]
# 整合 linter 以確保生成的程式碼品質
</code></pre>
<h5 id="codex-巢狀規則範例"><a class="header" href="#codex-巢狀規則範例">Codex 巢狀規則範例</a></h5>
<pre><code class="language-bash"># 為不同模組建立 Codex 特定規則
mkdir -p backend/.codex
cat &gt; backend/.codex/backend_rules.md &lt;&lt; 'EOF'
# 後端 Codex 規範

## 資料庫互動
- 使用 ORM 而非原生 SQL
- 實作交易處理
- 加入適當的索引提示

## API 端點生成
- 自動生成 OpenAPI 文檔
- 包含請求驗證邏輯
- 實作錯誤處理中介軟體
EOF

mkdir -p frontend/.codex
cat &gt; frontend/.codex/frontend_rules.md &lt;&lt; 'EOF'
# 前端 Codex 規範

## 組件生成
- 生成 TypeScript 類型定義
- 包含 Props 驗證
- 實作無障礙功能 (a11y)

## 狀態管理
- 使用 Context API 或 Redux
- 避免 prop drilling
- 實作適當的 memorization
EOF
</code></pre>
<h3 id="回復機制"><a class="header" href="#回復機制">回復機制</a></h3>
<pre><code class="language-bash"># 回復所有 ruler 變更
ruler revert

# 預覽會被回復的內容
ruler revert --dry-run

# 只回復特定代理工具
ruler revert --agents claude,copilot

# 回復後保留備份檔案
ruler revert --keep-backups
</code></pre>
<h3 id="自動-gitignore-管理"><a class="header" href="#自動-gitignore-管理">自動 .gitignore 管理</a></h3>
<p>Ruler 自動管理 <code>.gitignore</code> 檔案，確保生成的代理工具配置檔案不會被意外提交：</p>
<pre><code class="language-gitignore"># Your existing rules
node_modules/
*.log

# START Ruler Generated Files
.aider.conf.yml
.clinerules
.codex/rules.md
.cursor/rules/ruler_cursor_instructions.mdc
.github/copilot-instructions.md
.windsurf/rules/ruler_windsurf_instructions.md
AGENTS.md
CLAUDE.md
# END Ruler Generated Files

dist/
</code></pre>
<h3 id="命令列選項"><a class="header" href="#命令列選項">命令列選項</a></h3>
<div class="table-wrapper"><table><thead><tr><th>選項</th><th>說明</th></tr></thead><tbody>
<tr><td><code>--project-root &lt;path&gt;</code></td><td>專案根目錄路徑</td></tr>
<tr><td><code>--agents &lt;agent1,agent2&gt;</code></td><td>指定要套用的代理工具</td></tr>
<tr><td><code>--config &lt;path&gt;</code></td><td>自訂 ruler.toml 配置檔路徑</td></tr>
<tr><td><code>--nested</code></td><td>啟用巢狀規則載入</td></tr>
<tr><td><code>--dry-run</code></td><td>預覽變更而不寫入檔案</td></tr>
<tr><td><code>--verbose</code></td><td>顯示詳細執行過程</td></tr>
<tr><td><code>--no-gitignore</code></td><td>停用 .gitignore 自動更新</td></tr>
</tbody></table>
</div>
<h2 id="最佳實踐"><a class="header" href="#最佳實踐">最佳實踐</a></h2>
<h3 id="團隊協作工作流程"><a class="header" href="#團隊協作工作流程">團隊協作工作流程</a></h3>
<h4 id="1-建立團隊規範"><a class="header" href="#1-建立團隊規範">1. 建立團隊規範</a></h4>
<pre><code class="language-bash"># 建立團隊共用的規則檔案
mkdir -p .ruler
cat &gt; .ruler/AGENTS.md &lt;&lt; 'EOF'
# 團隊開發規範

## 程式碼品質標準
- 所有函數都必須有文檔字串
- 使用類型提示提高程式碼可讀性
- 遵循專案的命名約定

## 測試要求
- 新功能必須包含測試
- 測試覆蓋率維持在 80% 以上
- 使用描述性的測試名稱
EOF

# 套用到所有代理工具
ruler apply
</code></pre>
<h4 id="2-版本控制整合"><a class="header" href="#2-版本控制整合">2. 版本控制整合</a></h4>
<pre><code class="language-bash"># 將 .ruler 目錄提交到儲存庫
git add .ruler/
git commit -m "feat: add team AI coding standards with ruler"

# 團隊成員拉取變更後套用配置
git pull
ruler apply
</code></pre>
<h4 id="3-packagejson-腳本整合"><a class="header" href="#3-packagejson-腳本整合">3. package.json 腳本整合</a></h4>
<pre><code class="language-json">{
  "scripts": {
    "ruler:apply": "ruler apply",
    "dev": "npm run ruler:apply &amp;&amp; your_dev_command",
    "precommit": "npm run ruler:apply"
  }
}
</code></pre>
<h3 id="monorepo-的巢狀規則策略"><a class="header" href="#monorepo-的巢狀規則策略">Monorepo 的巢狀規則策略</a></h3>
<pre><code class="language-bash"># 建立服務特定的規則
mkdir -p services/api/.ruler
cat &gt; services/api/.ruler/api_standards.md &lt;&lt; 'EOF'
# API 服務開發規範

## 資料庫操作
- 使用連線池管理資料庫連線
- 實作適當的查詢超時
- 記錄慢查詢用於效能監控
EOF

mkdir -p services/frontend/.ruler
cat &gt; services/frontend/.ruler/frontend_standards.md &lt;&lt; 'EOF'
# 前端開發規範

## React 最佳實踐
- 使用函數式元件和 Hooks
- 實作適當的錯誤邊界
- 優化組件重新渲染
EOF

# 套用巢狀規則
ruler apply --nested --verbose
</code></pre>
<h3 id="規則檔案範例"><a class="header" href="#規則檔案範例">規則檔案範例</a></h3>
<h4 id="基本規則檔案-ruleragentsmd"><a class="header" href="#基本規則檔案-ruleragentsmd">基本規則檔案 (.ruler/AGENTS.md)</a></h4>
<pre><code class="language-markdown"># 專案開發規範

## 程式碼風格
- 遵循 PEP 8 規範（Python 專案）
- 使用類型提示標註所有函數簽名和複雜變數
- 保持函數簡短並專注於單一任務

## 錯誤處理
- 使用特定的異常類型而不是通用的 `Exception`
- 有效記錄錯誤並提供上下文資訊

## 安全性
- 始終驗證和清理使用者輸入
- 注意潛在的注入漏洞
</code></pre>
<h4 id="api-規則檔案-rulerapi_conventionsmd"><a class="header" href="#api-規則檔案-rulerapi_conventionsmd">API 規則檔案 (.ruler/api_conventions.md)</a></h4>
<pre><code class="language-markdown"># API 設計約定

## RESTful API 設計
- 使用適當的 HTTP 動詞（GET, POST, PUT, DELETE）
- 回應狀態碼必須正確且一致
- API 端點命名使用複數名詞

## 資料驗證
- 所有輸入都必須使用 zod 進行驗證
- 錯誤回應格式必須統一
- 實作適當的速率限制

## 文件要求
- 每個 API 端點都必須有 OpenAPI 規範
- 包含請求/回應範例
- 標註必要的認證要求
</code></pre>
<h4 id="測試規則檔案-rulertesting_conventionsmd"><a class="header" href="#測試規則檔案-rulertesting_conventionsmd">測試規則檔案 (.ruler/testing_conventions.md)</a></h4>
<pre><code class="language-markdown"># 測試開發規範

## 測試結構
- 遵循 AAA 模式（Arrange, Act, Assert）
- 測試函數名稱必須描述性強
- 每個測試只驗證一個行為

## 測試覆蓋率
- 單元測試覆蓋率不低於 85%
- 關鍵業務邏輯必須 100% 覆蓋
- 包含邊界條件測試

## Mock 使用
- 優先使用測試替身而非真實服務
- Mock 物件的行為必須與真實物件一致
- 避免過度 Mock 導致測試失去意義
</code></pre>
<h2 id="支援的-ai-工具"><a class="header" href="#支援的-ai-工具">支援的 AI 工具</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Agent</th><th>規則檔案</th><th>MCP 配置</th></tr></thead><tbody>
<tr><td>GitHub Copilot</td><td><code>.github/copilot-instructions.md</code></td><td><code>.vscode/mcp.json</code></td></tr>
<tr><td>Claude Code</td><td><code>CLAUDE.md</code></td><td><code>.mcp.json</code></td></tr>
<tr><td>Cursor</td><td><code>.cursor/rules/ruler_cursor_instructions.mdc</code></td><td><code>.cursor/mcp.json</code></td></tr>
<tr><td>Windsurf</td><td><code>.windsurf/rules/ruler_windsurf_instructions.md</code></td><td>-</td></tr>
<tr><td>Cline</td><td><code>.clinerules</code></td><td>-</td></tr>
<tr><td>Aider</td><td><code>AGENTS.md</code>, <code>.aider.conf.yml</code></td><td><code>.mcp.json</code></td></tr>
<tr><td>Amazon Q CLI</td><td><code>.amazonq/rules/ruler_q_rules.md</code></td><td><code>.amazonq/mcp.json</code></td></tr>
<tr><td>Zed</td><td><code>AGENTS.md</code></td><td><code>.zed/settings.json</code></td></tr>
<tr><td>Codex</td><td><code>.codex/rules.md</code></td><td><code>.codex/mcp.json</code></td></tr>
</tbody></table>
</div>
<h2 id="結論"><a class="header" href="#結論">結論</a></h2>
<p>Ruler 是一個強大的工具，專為管理多個 AI 編程助手的規則和配置而設計。透過集中化管理、巢狀規則載入和自動化分發機制，它大大簡化了團隊在使用多個 AI 工具時的配置管理工作，確保了開發標準的一致性和可維護性。</p>
<p>無論是小型專案還是大型 Monorepo，Ruler 都能提供靈活且強大的規則管理解決方案，讓團隊能夠專注於開發工作，而不是花時間在重複的配置管理上。</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../tools/llvm_guide.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../c++/cpp.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../tools/llvm_guide.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../c++/cpp.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="../ace.js"></script>
        <script src="../mode-rust.js"></script>
        <script src="../editor.js"></script>
        <script src="../theme-dawn.js"></script>
        <script src="../theme-tomorrow_night.js"></script>

        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../mermaid.min.js"></script>
        <script src="../mermaid-init.js"></script>



    </div>
    </body>
</html>
