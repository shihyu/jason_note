<!DOCTYPE HTML>
<html lang="zh" class="rust sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>GDB åˆ†æ .so/.a æª”æ¡ˆå®Œæ•´æŒ‡å— - Jason Notes</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "rust";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>â†</kbd> or <kbd>â†’</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Jason Notes</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/shihyu/jason_note" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="gdb-åˆ†æ-soa-æª”æ¡ˆå®Œæ•´æŒ‡å—"><a class="header" href="#gdb-åˆ†æ-soa-æª”æ¡ˆå®Œæ•´æŒ‡å—">GDB åˆ†æ .so/.a æª”æ¡ˆå®Œæ•´æŒ‡å—</a></h1>
<h2 id="åŸºç¤å‘½ä»¤"><a class="header" href="#åŸºç¤å‘½ä»¤">åŸºç¤å‘½ä»¤</a></h2>
<h3 id="1-æŸ¥çœ‹å‡½æ•¸ç¬¦è™Ÿ"><a class="header" href="#1-æŸ¥çœ‹å‡½æ•¸ç¬¦è™Ÿ">1. æŸ¥çœ‹å‡½æ•¸ç¬¦è™Ÿ</a></h3>
<pre><code class="language-bash"># åˆ—å‡ºæ‰€æœ‰å‡½æ•¸
gdb lib.so -batch -ex "info functions"

# éæ¿¾ç‰¹å®šå‡½æ•¸
gdb lib.so -batch -ex "info functions init"

# ä½¿ç”¨æ­£å‰‡è¡¨é”å¼
gdb lib.so -batch -ex "info functions ^lib_.*_init$"

# æŸ¥çœ‹ C++ å‡½æ•¸ï¼ˆåŒ…å«å®Œæ•´ç°½åï¼‰
gdb lib.so -batch -ex "info functions" -ex "set print asm-demangle on"
</code></pre>
<h3 id="2-æŸ¥çœ‹è®Šæ•¸ç¬¦è™Ÿ"><a class="header" href="#2-æŸ¥çœ‹è®Šæ•¸ç¬¦è™Ÿ">2. æŸ¥çœ‹è®Šæ•¸ç¬¦è™Ÿ</a></h3>
<pre><code class="language-bash"># åˆ—å‡ºæ‰€æœ‰å…¨åŸŸè®Šæ•¸
gdb lib.so -batch -ex "info variables"

# éæ¿¾ç‰¹å®šè®Šæ•¸
gdb lib.so -batch -ex "info variables config"

# æŸ¥çœ‹éœæ…‹è®Šæ•¸
gdb lib.so -batch -ex "info variables ^static_"
</code></pre>
<h3 id="3-æŸ¥çœ‹é¡å‹å®šç¾©"><a class="header" href="#3-æŸ¥çœ‹é¡å‹å®šç¾©">3. æŸ¥çœ‹é¡å‹å®šç¾©</a></h3>
<pre><code class="language-bash"># åˆ—å‡ºæ‰€æœ‰é¡å‹
gdb lib.so -batch -ex "info types"

# æŸ¥çœ‹ç‰¹å®šé¡å‹
gdb lib.so -batch -ex "info types MyClass"

# æŸ¥çœ‹ STL é¡å‹
gdb lib.so -batch -ex "info types std::"
</code></pre>
<h2 id="é€²éšåˆ†ææŠ€å·§"><a class="header" href="#é€²éšåˆ†ææŠ€å·§">é€²éšåˆ†ææŠ€å·§</a></h2>
<h3 id="4-åçµ„è­¯å‡½æ•¸"><a class="header" href="#4-åçµ„è­¯å‡½æ•¸">4. åçµ„è­¯å‡½æ•¸</a></h3>
<pre><code class="language-bash"># åçµ„è­¯ç‰¹å®šå‡½æ•¸
gdb lib.so -batch -ex "disassemble function_name"

# åçµ„è­¯åœ°å€ç¯„åœ
gdb lib.so -batch -ex "disassemble 0x1000,0x1100"

# Intel èªæ³•ï¼ˆæ›´æ˜“è®€ï¼‰
gdb lib.so -batch -ex "set disassembly-flavor intel" -ex "disassemble main"

# é¡¯ç¤ºåŸå§‹ç¢¼å’Œçµ„è­¯æ··åˆ
gdb lib.so -batch -ex "disassemble /m function_name"
</code></pre>
<h3 id="5-æŸ¥çœ‹æ®µsectionsè³‡è¨Š"><a class="header" href="#5-æŸ¥çœ‹æ®µsectionsè³‡è¨Š">5. æŸ¥çœ‹æ®µï¼ˆSectionsï¼‰è³‡è¨Š</a></h3>
<pre><code class="language-bash"># åˆ—å‡ºæ‰€æœ‰æ®µ
gdb lib.so -batch -ex "maintenance info sections"

# æŸ¥çœ‹ç‰¹å®šæ®µ
gdb lib.so -batch -ex "maintenance info sections .text"

# æŸ¥çœ‹æ®µçš„è¨˜æ†¶é«”æ˜ å°„
gdb lib.so -batch -ex "info files"
</code></pre>
<h3 id="6-æŸ¥çœ‹ä¾è³´é—œä¿‚"><a class="header" href="#6-æŸ¥çœ‹ä¾è³´é—œä¿‚">6. æŸ¥çœ‹ä¾è³´é—œä¿‚</a></h3>
<pre><code class="language-bash"># æŸ¥çœ‹å‹•æ…‹é€£çµçš„å‡½å¼åº«
gdb lib.so -batch -ex "info sharedlibrary"

# æŸ¥çœ‹ PLT (Procedure Linkage Table)
gdb lib.so -batch -ex "info functions @plt"

# æŸ¥çœ‹ GOT (Global Offset Table)
gdb lib.so -batch -ex "maintenance info sections .got"
</code></pre>
<h2 id="ç¬¦è™Ÿåˆ†æ"><a class="header" href="#ç¬¦è™Ÿåˆ†æ">ç¬¦è™Ÿåˆ†æ</a></h2>
<h3 id="7-ç¬¦è™Ÿè¡¨æ“ä½œ"><a class="header" href="#7-ç¬¦è™Ÿè¡¨æ“ä½œ">7. ç¬¦è™Ÿè¡¨æ“ä½œ</a></h3>
<pre><code class="language-bash"># æŸ¥çœ‹æ‰€æœ‰ç¬¦è™Ÿ
gdb lib.so -batch -ex "info all-symbols"

# æŸ¥çœ‹ç‰¹å®šç¬¦è™Ÿçš„è©³ç´°è³‡è¨Š
gdb lib.so -batch -ex "info symbol 0x12345678"

# æŸ¥çœ‹ç¬¦è™Ÿçš„åœ°å€
gdb lib.so -batch -ex "info address function_name"

# åˆ—å‡ºåŸå§‹æª”
gdb lib.so -batch -ex "info sources"
</code></pre>
<h3 id="8-c-ç‰¹å®šåŠŸèƒ½"><a class="header" href="#8-c-ç‰¹å®šåŠŸèƒ½">8. C++ ç‰¹å®šåŠŸèƒ½</a></h3>
<pre><code class="language-bash"># æŸ¥çœ‹ C++ é¡åˆ¥
gdb lib.so -batch -ex "info classes"

# æŸ¥çœ‹è™›æ“¬å‡½æ•¸è¡¨
gdb lib.so -batch -ex "info vtbl ClassName"

# æŸ¥çœ‹ namespace
gdb lib.so -batch -ex "info namespace"

# Demangle C++ ç¬¦è™Ÿ
gdb lib.so -batch -ex "set print demangle on" -ex "info functions"
</code></pre>
<h2 id="è¨˜æ†¶é«”å’Œè³‡æ–™åˆ†æ"><a class="header" href="#è¨˜æ†¶é«”å’Œè³‡æ–™åˆ†æ">è¨˜æ†¶é«”å’Œè³‡æ–™åˆ†æ</a></h2>
<h3 id="9-æª¢æŸ¥è³‡æ–™çµæ§‹"><a class="header" href="#9-æª¢æŸ¥è³‡æ–™çµæ§‹">9. æª¢æŸ¥è³‡æ–™çµæ§‹</a></h3>
<pre><code class="language-bash"># æŸ¥çœ‹çµæ§‹é«”å®šç¾©
gdb lib.so -batch -ex "ptype struct MyStruct"

# æŸ¥çœ‹é¡åˆ¥å®šç¾©
gdb lib.so -batch -ex "ptype class MyClass"

# æŸ¥çœ‹æšèˆ‰
gdb lib.so -batch -ex "ptype enum MyEnum"

# æŸ¥çœ‹ typedef
gdb lib.so -batch -ex "info types typedef"
</code></pre>
<h3 id="10-å°å‡ºç¬¦è™Ÿè³‡è¨Š"><a class="header" href="#10-å°å‡ºç¬¦è™Ÿè³‡è¨Š">10. å°å‡ºç¬¦è™Ÿè³‡è¨Š</a></h3>
<pre><code class="language-bash"># ç”¢ç”Ÿç¬¦è™Ÿæª”æ¡ˆ
gdb lib.so -batch -ex "maint print symbols symbols.txt"

# ç”¢ç”Ÿéƒ¨åˆ†ç¬¦è™Ÿè¡¨
gdb lib.so -batch -ex "maint print psymbols psymbols.txt"

# ç”¢ç”Ÿæœ€å°ç¬¦è™Ÿè¡¨
gdb lib.so -batch -ex "maint print msymbols msymbols.txt"
</code></pre>
<h2 id="å¯¦ç”¨çµ„åˆæŠ€å·§"><a class="header" href="#å¯¦ç”¨çµ„åˆæŠ€å·§">å¯¦ç”¨çµ„åˆæŠ€å·§</a></h2>
<h3 id="11-åˆ†æå‡½æ•¸å‘¼å«"><a class="header" href="#11-åˆ†æå‡½æ•¸å‘¼å«">11. åˆ†æå‡½æ•¸å‘¼å«</a></h3>
<pre><code class="language-bash"># æ‰¾å‡ºæ‰€æœ‰å‘¼å« malloc çš„åœ°æ–¹
gdb lib.so -batch -ex "disassemble" | grep -B2 "call.*malloc"

# åˆ—å‡ºæ‰€æœ‰ exported å‡½æ•¸ï¼ˆå‹•æ…‹ç¬¦è™Ÿï¼‰
gdb lib.so -batch -ex "info functions" | grep -E "^[0-9a-fx]+ +[^&lt;]"

# çµ±è¨ˆå‡½æ•¸æ•¸é‡
gdb lib.so -batch -ex "info functions" | grep -c "^0x"
</code></pre>
<h3 id="12-å®‰å…¨å¯©è¨ˆ"><a class="header" href="#12-å®‰å…¨å¯©è¨ˆ">12. å®‰å…¨å¯©è¨ˆ</a></h3>
<pre><code class="language-bash"># å°‹æ‰¾å±éšªå‡½æ•¸
gdb lib.so -batch -ex "info functions" | grep -E "(strcpy|gets|sprintf|system)"

# æª¢æŸ¥ RELRO (Relocation Read-Only)
gdb lib.so -batch -ex "info files" | grep -E "(GNU_RELRO|\.got)"

# æª¢æŸ¥ stack canary
gdb lib.so -batch -ex "info functions" | grep "__stack_chk"
</code></pre>
<h2 id="shell-å‡½æ•¸ç¯„ä¾‹"><a class="header" href="#shell-å‡½æ•¸ç¯„ä¾‹">Shell å‡½æ•¸ç¯„ä¾‹</a></h2>
<h3 id="åŸºç¤ç‰ˆæœ¬"><a class="header" href="#åŸºç¤ç‰ˆæœ¬">åŸºç¤ç‰ˆæœ¬</a></h3>
<pre><code class="language-bash"># ~/.bashrc
soinfo() {
    local file="$1"
    local cmd="${2:-functions}"
    
    case "$cmd" in
        func|functions)
            gdb "$file" -batch -ex "info functions" ;;
        var|variables)
            gdb "$file" -batch -ex "info variables" ;;
        type|types)
            gdb "$file" -batch -ex "info types" ;;
        dis|disas)
            gdb "$file" -batch -ex "disassemble $3" ;;
        *)
            echo "Usage: soinfo &lt;file&gt; [func|var|type|dis] [args]"
            ;;
    esac
}
</code></pre>
<h3 id="é€²éšç‰ˆæœ¬"><a class="header" href="#é€²éšç‰ˆæœ¬">é€²éšç‰ˆæœ¬</a></h3>
<pre><code class="language-bash"># ~/.bashrc
soanalyze() {
    local file="$1"
    local analysis="$2"
    
    if [[ ! -f "$file" ]]; then
        echo "File not found: $file"
        return 1
    fi
    
    case "$analysis" in
        exports)
            echo "=== Exported Functions ==="
            gdb "$file" -batch -ex "info functions" | \
                grep -E "^0x[0-9a-f]+ +[A-Za-z_]"
            ;;
        cpp)
            echo "=== C++ Symbols ==="
            gdb "$file" -batch -ex "set print demangle on" \
                -ex "info functions" | grep -E "::|&lt;|&gt;"
            ;;
        security)
            echo "=== Security Check ==="
            echo "Dangerous functions:"
            gdb "$file" -batch -ex "info functions" | \
                grep -E "(strcpy|gets|sprintf|system)"
            echo -e "\nStack protection:"
            gdb "$file" -batch -ex "info functions" | \
                grep -c "__stack_chk" || echo "No stack canary found"
            ;;
        stats)
            echo "=== Library Statistics ==="
            echo "Functions: $(gdb "$file" -batch -ex "info functions" | grep -c "^0x")"
            echo "Variables: $(gdb "$file" -batch -ex "info variables" | grep -c "^0x")"
            echo "Types: $(gdb "$file" -batch -ex "info types" | grep -c "^File\|^type")"
            ;;
        *)
            echo "Usage: soanalyze &lt;file&gt; [exports|cpp|security|stats]"
            ;;
    esac
}
</code></pre>
<h3 id="çµåˆ-nm-å’Œ-gdb-çš„æ™ºæ…§å‡½æ•¸"><a class="header" href="#çµåˆ-nm-å’Œ-gdb-çš„æ™ºæ…§å‡½æ•¸">çµåˆ nm å’Œ GDB çš„æ™ºæ…§å‡½æ•¸</a></h3>
<pre><code class="language-bash"># ~/.bashrc

# å¿«é€Ÿç¬¦è™ŸæŸ¥çœ‹ï¼ˆç”¨ nmï¼‰
qsym() {
    nm -DC "$1" | grep -E " [TDG] " | less
}

# è©³ç´°åˆ†æï¼ˆç”¨ GDBï¼‰
dsym() {
    gdb "$1" -batch -ex "info functions" -ex "info variables" | less
}

# æ™ºæ…§é¸æ“‡å·¥å…·
sym() {
    local file="$1"
    local pattern="$2"
    
    if [[ -z "$pattern" ]]; then
        # æ²’æœ‰ patternï¼Œç”¨ nmï¼ˆå¿«ï¼‰
        nm -DC "$file"
    else
        # æœ‰ patternï¼Œç”¨ GDBï¼ˆåŠŸèƒ½å¼·ï¼‰
        gdb "$file" -batch -ex "info functions $pattern"
    fi
}

# æ¯”è¼ƒ nm å’Œ GDB è¼¸å‡º
symcompare() {
    local file="$1"
    local func="${2:-main}"
    
    echo "=== nm output ==="
    nm -DC "$file" | grep "$func"
    
    echo -e "\n=== GDB output ==="
    gdb "$file" -batch -ex "info functions $func" 2&gt;/dev/null | grep -v "^$"
}

# å¿«é€Ÿåˆ†æå‡½å¼åº«ï¼ˆçµåˆä½¿ç”¨ï¼‰
libanalyze() {
    local lib="$1"
    
    echo "=== Quick Symbol Check (nm) ==="
    echo "Exported functions: $(nm -D "$lib" 2&gt;/dev/null | grep -c " T ")"
    echo "Undefined symbols: $(nm -u "$lib" 2&gt;/dev/null | wc -l)"
    
    echo -e "\n=== Top 5 Functions (nm) ==="
    nm -DC "$lib" 2&gt;/dev/null | grep " T " | head -5
    
    echo -e "\n=== Detailed Analysis (GDB) ==="
    # åªå°ç¬¬ä¸€å€‹å‡½æ•¸åšè©³ç´°åˆ†æ
    local first_func=$(nm -DC "$lib" 2&gt;/dev/null | grep " T " | head -1 | awk '{print $3}')
    if [[ -n "$first_func" ]]; then
        echo "Details of $first_func:"
        gdb "$lib" -batch -ex "info functions ^${first_func}$" 2&gt;/dev/null | grep -v "^$"
    fi
}
</code></pre>
<h3 id="æœå°‹å‡½æ•¸"><a class="header" href="#æœå°‹å‡½æ•¸">æœå°‹å‡½æ•¸</a></h3>
<pre><code class="language-bash"># ~/.bashrc
sofind() {
    local pattern="$1"
    shift
    
    for file in "$@"; do
        echo "=== $file ==="
        gdb "$file" -batch -ex "info functions $pattern" 2&gt;/dev/null | \
            grep -E "^0x[0-9a-f]+"
    done
}

# ä½¿ç”¨æ–¹å¼
# sofind "init" *.so
</code></pre>
<h2 id="æ‰¹æ¬¡è™•ç†æŠ€å·§"><a class="header" href="#æ‰¹æ¬¡è™•ç†æŠ€å·§">æ‰¹æ¬¡è™•ç†æŠ€å·§</a></h2>
<h3 id="13-åˆ†æå¤šå€‹æª”æ¡ˆ"><a class="header" href="#13-åˆ†æå¤šå€‹æª”æ¡ˆ">13. åˆ†æå¤šå€‹æª”æ¡ˆ</a></h3>
<pre><code class="language-bash"># æ‰¹æ¬¡æª¢æŸ¥æ‰€æœ‰ .so çš„å‡½æ•¸
for lib in *.so; do
    echo "=== $lib ==="
    gdb "$lib" -batch -ex "info functions" | head -10
done

# æ‰¾å‡ºåŒ…å«ç‰¹å®šå‡½æ•¸çš„å‡½å¼åº«
for lib in /usr/lib/*.so; do
    if gdb "$lib" -batch -ex "info functions pthread_create" 2&gt;/dev/null | grep -q pthread_create; then
        echo "$lib contains pthread_create"
    fi
done
</code></pre>
<h3 id="14-ç”¢ç”Ÿå ±å‘Š"><a class="header" href="#14-ç”¢ç”Ÿå ±å‘Š">14. ç”¢ç”Ÿå ±å‘Š</a></h3>
<pre><code class="language-bash">#!/bin/bash
# analyze_lib.sh
generate_report() {
    local lib="$1"
    local output="${lib%.so}_report.txt"
    
    {
        echo "Library Analysis Report: $lib"
        echo "Generated: $(date)"
        echo "================================"
        
        echo -e "\n## Functions"
        gdb "$lib" -batch -ex "info functions" | head -20
        
        echo -e "\n## Global Variables"
        gdb "$lib" -batch -ex "info variables" | head -20
        
        echo -e "\n## Dependencies"
        ldd "$lib"
        
        echo -e "\n## Security Features"
        checksec --file="$lib" 2&gt;/dev/null || echo "checksec not installed"
        
    } &gt; "$output"
    
    echo "Report saved to: $output"
}
</code></pre>
<h2 id="é™¤éŒ¯æŠ€å·§"><a class="header" href="#é™¤éŒ¯æŠ€å·§">é™¤éŒ¯æŠ€å·§</a></h2>
<h3 id="15-è¨­å®šæ–·é»å’Œè¿½è¹¤"><a class="header" href="#15-è¨­å®šæ–·é»å’Œè¿½è¹¤">15. è¨­å®šæ–·é»å’Œè¿½è¹¤</a></h3>
<pre><code class="language-bash"># åœ¨å‡½å¼åº«è¼‰å…¥æ™‚è¨­å®šæ–·é»
gdb ./main_program -batch \
    -ex "set breakpoint pending on" \
    -ex "break lib.so:function_name" \
    -ex "run" \
    -ex "backtrace"

# è¿½è¹¤å‡½æ•¸å‘¼å«
gdb ./program -batch \
    -ex "set pagination off" \
    -ex "break function_name" \
    -ex "commands" \
    -ex "silent" \
    -ex "backtrace 1" \
    -ex "continue" \
    -ex "end" \
    -ex "run"
</code></pre>
<h2 id="nm-vs-gdb-è©³ç´°æ¯”è¼ƒ"><a class="header" href="#nm-vs-gdb-è©³ç´°æ¯”è¼ƒ">nm vs GDB è©³ç´°æ¯”è¼ƒ</a></h2>
<h3 id="æ ¸å¿ƒå·®ç•°"><a class="header" href="#æ ¸å¿ƒå·®ç•°">æ ¸å¿ƒå·®ç•°</a></h3>
<pre><code class="language-bash"># nm - ç°¡å–®å¿«é€Ÿçš„ç¬¦è™ŸæŸ¥çœ‹å™¨
nm lib.so              # åˆ—å‡ºæ‰€æœ‰ç¬¦è™Ÿ
nm -D lib.so           # åªçœ‹å‹•æ…‹ç¬¦è™Ÿ
nm -C lib.so           # Demangle C++ ç¬¦è™Ÿ

# GDB - åŠŸèƒ½å¼·å¤§çš„åˆ†æå™¨
gdb lib.so -batch -ex "info functions"     # ä¸åªæ˜¯ç¬¦è™Ÿ
gdb lib.so -batch -ex "disassemble func"   # é‚„èƒ½åçµ„è­¯
gdb lib.so -batch -ex "ptype struct"       # æŸ¥çœ‹è³‡æ–™çµæ§‹
</code></pre>
<h3 id="åŠŸèƒ½å°æ¯”è¡¨"><a class="header" href="#åŠŸèƒ½å°æ¯”è¡¨">åŠŸèƒ½å°æ¯”è¡¨</a></h3>
<div class="table-wrapper"><table><thead><tr><th>åŠŸèƒ½</th><th>nm</th><th>GDB</th><th>èªªæ˜</th></tr></thead><tbody>
<tr><td><strong>æŸ¥çœ‹ç¬¦è™Ÿ</strong></td><td>âœ… å¿«é€Ÿ</td><td>âœ… è©³ç´°</td><td>nm æ›´å¿«ï¼ŒGDB è³‡è¨Šæ›´å¤š</td></tr>
<tr><td><strong>éæ¿¾åŠŸèƒ½</strong></td><td>éœ€è¦ grep</td><td>âœ… å…§å»ºæ­£å‰‡</td><td>GDB å¯ç›´æ¥éæ¿¾</td></tr>
<tr><td><strong>åçµ„è­¯</strong></td><td>âŒ</td><td>âœ…</td><td>åªæœ‰ GDB èƒ½åçµ„è­¯</td></tr>
<tr><td><strong>æŸ¥çœ‹è³‡æ–™çµæ§‹</strong></td><td>âŒ</td><td>âœ…</td><td>GDB èƒ½é¡¯ç¤º struct/class å®šç¾©</td></tr>
<tr><td><strong>é™¤éŒ¯è³‡è¨Š</strong></td><td>éƒ¨åˆ†</td><td>âœ… å®Œæ•´</td><td>GDB èƒ½è®€å–å®Œæ•´é™¤éŒ¯è³‡è¨Š</td></tr>
<tr><td><strong>åŸ·è¡Œæ™‚åˆ†æ</strong></td><td>âŒ</td><td>âœ…</td><td>GDB èƒ½å‹•æ…‹é™¤éŒ¯</td></tr>
<tr><td><strong>é€Ÿåº¦</strong></td><td>âœ… æ¥µå¿«</td><td>è¼ƒæ…¢</td><td>nm å°ˆé–€è¨­è¨ˆç”¨ä¾†å¿«é€ŸæŸ¥çœ‹</td></tr>
<tr><td><strong>è¼¸å‡ºæ ¼å¼</strong></td><td>ç°¡æ½”</td><td>è©³ç´°</td><td>nm è¼¸å‡ºæ›´é©åˆè…³æœ¬è™•ç†</td></tr>
</tbody></table>
</div>
<h3 id="å¯¦éš›ç¯„ä¾‹æ¯”è¼ƒ"><a class="header" href="#å¯¦éš›ç¯„ä¾‹æ¯”è¼ƒ">å¯¦éš›ç¯„ä¾‹æ¯”è¼ƒ</a></h3>
<h4 id="æŸ¥çœ‹å‡½æ•¸ç¬¦è™Ÿ"><a class="header" href="#æŸ¥çœ‹å‡½æ•¸ç¬¦è™Ÿ">æŸ¥çœ‹å‡½æ•¸ç¬¦è™Ÿ</a></h4>
<pre><code class="language-bash"># nm - ç°¡æ½”è¼¸å‡º
$ nm -D lib.so | grep " T "
0000000000001140 T init_library
0000000000001260 T process_data

# GDB - è©³ç´°è³‡è¨Š
$ gdb lib.so -batch -ex "info functions init"
0x0000000000001140  init_library(int, char**)
0x0000000000001260  init_config(void)
</code></pre>
<h4 id="c-ç¬¦è™Ÿè™•ç†"><a class="header" href="#c-ç¬¦è™Ÿè™•ç†">C++ ç¬¦è™Ÿè™•ç†</a></h4>
<pre><code class="language-bash"># nm - éœ€è¦ -C ä¾† demangle
$ nm lib.so
00001234 T _ZN7MyClass10myFunctionEv  # é›£è®€

$ nm -C lib.so  
00001234 T MyClass::myFunction()      # æ˜“è®€

# GDB - è‡ªå‹•è™•ç†ï¼Œé‚„èƒ½çœ‹åƒæ•¸é¡å‹
$ gdb lib.so -batch -ex "info functions MyClass"
0x00001234  MyClass::myFunction()
0x00001456  MyClass::MyClass(int, std::string const&amp;)
</code></pre>
<h4 id="ç¬¦è™Ÿé¡å‹è­˜åˆ¥"><a class="header" href="#ç¬¦è™Ÿé¡å‹è­˜åˆ¥">ç¬¦è™Ÿé¡å‹è­˜åˆ¥</a></h4>
<pre><code class="language-bash"># nm - ç”¨å­—æ¯è¡¨ç¤ºé¡å‹
$ nm lib.so
0000000000001140 T init_library    # T = Text (code)
0000000000004020 D global_var      # D = Data
0000000000004040 B uninit_var      # B = BSS
                 U printf           # U = Undefined

# GDB - åˆ†é¡é¡¯ç¤º
$ gdb lib.so -batch -ex "info functions"   # åªçœ‹å‡½æ•¸
$ gdb lib.so -batch -ex "info variables"   # åªçœ‹è®Šæ•¸
</code></pre>
<h3 id="nm-ç¬¦è™Ÿé¡å‹ä»£ç¢¼è¡¨"><a class="header" href="#nm-ç¬¦è™Ÿé¡å‹ä»£ç¢¼è¡¨">nm ç¬¦è™Ÿé¡å‹ä»£ç¢¼è¡¨</a></h3>
<div class="table-wrapper"><table><thead><tr><th>ä»£ç¢¼</th><th>æ„ç¾©</th><th>èªªæ˜</th></tr></thead><tbody>
<tr><td><strong>T/t</strong></td><td>Text (code)</td><td>ç¨‹å¼ç¢¼æ®µçš„ç¬¦è™Ÿ (å¤§å¯«=å…¨åŸŸï¼Œå°å¯«=å±€éƒ¨)</td></tr>
<tr><td><strong>D/d</strong></td><td>Data</td><td>å·²åˆå§‹åŒ–è³‡æ–™æ®µ</td></tr>
<tr><td><strong>B/b</strong></td><td>BSS</td><td>æœªåˆå§‹åŒ–è³‡æ–™æ®µ</td></tr>
<tr><td><strong>R/r</strong></td><td>Read-only</td><td>å”¯è®€è³‡æ–™æ®µ</td></tr>
<tr><td><strong>W/w</strong></td><td>Weak</td><td>å¼±ç¬¦è™Ÿ</td></tr>
<tr><td><strong>U</strong></td><td>Undefined</td><td>æœªå®šç¾©ç¬¦è™Ÿï¼ˆéœ€è¦å¤–éƒ¨é€£çµï¼‰</td></tr>
<tr><td><strong>A</strong></td><td>Absolute</td><td>çµ•å°ç¬¦è™Ÿ</td></tr>
<tr><td><strong>C</strong></td><td>Common</td><td>å…±åŒç¬¦è™Ÿ</td></tr>
<tr><td><strong>N</strong></td><td>Debug</td><td>é™¤éŒ¯ç¬¦è™Ÿ</td></tr>
</tbody></table>
</div>
<h3 id="æ•ˆèƒ½æ¯”è¼ƒ"><a class="header" href="#æ•ˆèƒ½æ¯”è¼ƒ">æ•ˆèƒ½æ¯”è¼ƒ</a></h3>
<pre><code class="language-bash"># æ¸¬è©¦å¤§å‹å‡½å¼åº« (å¦‚ libc.so)
$ time nm -D /lib/x86_64-linux-gnu/libc.so.6 &gt; /dev/null
real    0m0.012s

$ time gdb /lib/x86_64-linux-gnu/libc.so.6 -batch -ex "info functions" &gt; /dev/null  
real    0m0.283s

# nm å¿«ç´„ 20 å€ï¼
</code></pre>
<h3 id="ä»€éº¼æ™‚å€™ç”¨å“ªå€‹"><a class="header" href="#ä»€éº¼æ™‚å€™ç”¨å“ªå€‹">ä»€éº¼æ™‚å€™ç”¨å“ªå€‹ï¼Ÿ</a></h3>
<h4 id="ä½¿ç”¨-nm-çš„å ´æ™¯"><a class="header" href="#ä½¿ç”¨-nm-çš„å ´æ™¯">ä½¿ç”¨ nm çš„å ´æ™¯</a></h4>
<pre><code class="language-bash"># 1. å¿«é€Ÿæª¢æŸ¥ç¬¦è™Ÿæ˜¯å¦å­˜åœ¨
nm -D lib.so | grep function_name

# 2. æ‰¹é‡è™•ç†å¤šå€‹æª”æ¡ˆ
for lib in *.so; do
    nm -D "$lib" | grep -q "init" &amp;&amp; echo "$lib has init"
done

# 3. ç”¢ç”Ÿç¬¦è™Ÿåˆ—è¡¨
nm -D lib.so &gt; symbols.txt

# 4. æª¢æŸ¥æœªå®šç¾©ç¬¦è™Ÿ
nm -u lib.so

# 5. è…³æœ¬è‡ªå‹•åŒ–
nm lib.so | awk '$2=="T" {print $3}' | sort
</code></pre>
<h4 id="ä½¿ç”¨-gdb-çš„å ´æ™¯"><a class="header" href="#ä½¿ç”¨-gdb-çš„å ´æ™¯">ä½¿ç”¨ GDB çš„å ´æ™¯</a></h4>
<pre><code class="language-bash"># 1. éœ€è¦çœ‹å‡½æ•¸åƒæ•¸å’Œè¿”å›é¡å‹
gdb lib.so -batch -ex "info functions process"

# 2. æŸ¥çœ‹è³‡æ–™çµæ§‹å®šç¾©
gdb lib.so -batch -ex "ptype struct config_data"

# 3. åçµ„è­¯åˆ†æ
gdb lib.so -batch -ex "disassemble critical_function"

# 4. è¤‡é›œçš„æ­£å‰‡éæ¿¾
gdb lib.so -batch -ex "info functions ^lib_.*_init$"

# 5. éœ€è¦é™¤éŒ¯è³‡è¨Š
gdb lib.so -batch -ex "info sources"
</code></pre>
<h2 id="å…¶ä»–ç›¸é—œå·¥å…·æ¯”è¼ƒ"><a class="header" href="#å…¶ä»–ç›¸é—œå·¥å…·æ¯”è¼ƒ">å…¶ä»–ç›¸é—œå·¥å…·æ¯”è¼ƒ</a></h2>
<div class="table-wrapper"><table><thead><tr><th>å·¥å…·</th><th>å„ªé»</th><th>ä½¿ç”¨å ´æ™¯</th><th>é€Ÿåº¦</th></tr></thead><tbody>
<tr><td><code>nm</code></td><td>å¿«é€Ÿã€ç°¡å–®</td><td>å¿«é€ŸæŸ¥çœ‹ç¬¦è™Ÿ</td><td>âš¡ æ¥µå¿«</td></tr>
<tr><td><code>objdump</code></td><td>åŠŸèƒ½å…¨é¢</td><td>æŸ¥çœ‹æ®µã€åçµ„è­¯</td><td>ğŸš€ å¿«</td></tr>
<tr><td><code>readelf</code></td><td>ELF æ ¼å¼å°ˆç”¨</td><td>è©³ç´° ELF åˆ†æ</td><td>ğŸš€ å¿«</td></tr>
<tr><td><code>ldd</code></td><td>ä¾è³´é—œä¿‚</td><td>æŸ¥çœ‹å‹•æ…‹é€£çµ</td><td>âš¡ æ¥µå¿«</td></tr>
<tr><td><code>strings</code></td><td>æå–å­—ä¸²</td><td>æŸ¥æ‰¾ç¡¬ç·¨ç¢¼å­—ä¸²</td><td>âš¡ æ¥µå¿«</td></tr>
<tr><td><code>gdb</code></td><td>æœ€å¼·å¤§</td><td>æ·±åº¦åˆ†æã€é™¤éŒ¯</td><td>ğŸ¢ è¼ƒæ…¢</td></tr>
</tbody></table>
</div>
<h2 id="å¸¸è¦‹å•é¡Œè§£æ±º"><a class="header" href="#å¸¸è¦‹å•é¡Œè§£æ±º">å¸¸è¦‹å•é¡Œè§£æ±º</a></h2>
<h3 id="ç¬¦è™Ÿè¢«å‰é›¢stripped"><a class="header" href="#ç¬¦è™Ÿè¢«å‰é›¢stripped">ç¬¦è™Ÿè¢«å‰é›¢ï¼ˆstrippedï¼‰</a></h3>
<pre><code class="language-bash"># æª¢æŸ¥æ˜¯å¦è¢«å‰é›¢
file lib.so

# å˜—è©¦å¾é™¤éŒ¯ç¬¦è™ŸåŒ…è¼‰å…¥
gdb lib.so -batch -ex "symbol-file lib.so.debug" -ex "info functions"
</code></pre>
<h3 id="æª¢æŸ¥-3264-ä½å…ƒ"><a class="header" href="#æª¢æŸ¥-3264-ä½å…ƒ">æª¢æŸ¥ 32/64 ä½å…ƒ</a></h3>
<pre><code class="language-bash">gdb lib.so -batch -ex "show architecture"
</code></pre>
<h3 id="æŸ¥çœ‹ç·¨è­¯å™¨å„ªåŒ–ç­‰ç´š"><a class="header" href="#æŸ¥çœ‹ç·¨è­¯å™¨å„ªåŒ–ç­‰ç´š">æŸ¥çœ‹ç·¨è­¯å™¨å„ªåŒ–ç­‰ç´š</a></h3>
<pre><code class="language-bash"># é€šéåçµ„è­¯æ¨æ¸¬
gdb lib.so -batch -ex "disassemble main" | grep -E "(nop|lea.*\[.*\+0\])"
</code></pre>
<h2 id="å¿«é€Ÿæ±ºç­–æŒ‡å—"><a class="header" href="#å¿«é€Ÿæ±ºç­–æŒ‡å—">å¿«é€Ÿæ±ºç­–æŒ‡å—</a></h2>
<h3 id="é¸æ“‡å·¥å…·çš„æ±ºç­–æ¨¹"><a class="header" href="#é¸æ“‡å·¥å…·çš„æ±ºç­–æ¨¹">é¸æ“‡å·¥å…·çš„æ±ºç­–æ¨¹</a></h3>
<pre><code>éœ€è¦åˆ†æ .so/.a æª”æ¡ˆï¼Ÿ
â”œâ”€â”€ åªè¦çœ‹ç¬¦è™Ÿåç¨±ï¼Ÿ â†’ ç”¨ nm
â”œâ”€â”€ éœ€è¦çœ‹å‡½æ•¸åƒæ•¸ï¼Ÿ â†’ ç”¨ GDB
â”œâ”€â”€ éœ€è¦åçµ„è­¯ï¼Ÿ â†’ ç”¨ GDB æˆ– objdump
â”œâ”€â”€ éœ€è¦çœ‹è³‡æ–™çµæ§‹ï¼Ÿ â†’ ç”¨ GDB
â”œâ”€â”€ æ‰¹é‡è™•ç†å¤šæª”æ¡ˆï¼Ÿ â†’ ç”¨ nm + è…³æœ¬
â””â”€â”€ æ·±åº¦é™¤éŒ¯åˆ†æï¼Ÿ â†’ ç”¨ GDB
</code></pre>
<h3 id="ç¸½çµæ¯”è¼ƒ"><a class="header" href="#ç¸½çµæ¯”è¼ƒ">ç¸½çµæ¯”è¼ƒ</a></h3>
<div class="table-wrapper"><table><thead><tr><th>éœ€æ±‚</th><th>æœ€ä½³å·¥å…·</th><th>æŒ‡ä»¤ç¯„ä¾‹</th></tr></thead><tbody>
<tr><td><strong>å¿«é€ŸæŸ¥çœ‹ç¬¦è™Ÿ</strong></td><td>nm</td><td><code>nm -DC lib.so | grep func</code></td></tr>
<tr><td><strong>æª¢æŸ¥æœªå®šç¾©ç¬¦è™Ÿ</strong></td><td>nm</td><td><code>nm -u lib.so</code></td></tr>
<tr><td><strong>æŸ¥çœ‹å‡½æ•¸ç°½å</strong></td><td>GDB</td><td><code>gdb lib.so -batch -ex "info functions"</code></td></tr>
<tr><td><strong>åçµ„è­¯å‡½æ•¸</strong></td><td>GDB</td><td><code>gdb lib.so -batch -ex "disas func"</code></td></tr>
<tr><td><strong>æŸ¥çœ‹çµæ§‹å®šç¾©</strong></td><td>GDB</td><td><code>gdb lib.so -batch -ex "ptype struct"</code></td></tr>
<tr><td><strong>æ‰¹é‡æª¢æŸ¥</strong></td><td>nm</td><td><code>for f in *.so; do nm -D $f; done</code></td></tr>
<tr><td><strong>C++ ç¬¦è™Ÿ</strong></td><td>å…©è€…çš†å¯</td><td><code>nm -C</code> æˆ– GDB è‡ªå‹•è™•ç†</td></tr>
<tr><td><strong>æ•ˆèƒ½å„ªå…ˆ</strong></td><td>nm</td><td>nm æ¯” GDB å¿« 20+ å€</td></tr>
<tr><td><strong>è³‡è¨Šå®Œæ•´</strong></td><td>GDB</td><td>GDB æä¾›æœ€è©³ç´°è³‡è¨Š</td></tr>
</tbody></table>
</div>
<h3 id="ä¸€å¥è©±ç¸½çµ"><a class="header" href="#ä¸€å¥è©±ç¸½çµ">ä¸€å¥è©±ç¸½çµ</a></h3>
<ul>
<li><strong>nm</strong> = ç‘å£«åˆ€ï¼ˆè¼•å·§å¿«é€Ÿï¼Œé©åˆæ—¥å¸¸æŸ¥çœ‹ï¼‰</li>
<li><strong>GDB</strong> = å·¥å…·ç®±ï¼ˆåŠŸèƒ½é½Šå…¨ï¼Œé©åˆæ·±åº¦åˆ†æï¼‰</li>
<li><strong>æœ€ä½³å¯¦è¸</strong> = å…ˆç”¨ nm å¿«é€Ÿç¯©é¸ï¼Œå†ç”¨ GDB æ·±å…¥åˆ†æ</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../gdb/GDB_DEBUG_GUIDE.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../vim/vim.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../gdb/GDB_DEBUG_GUIDE.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../vim/vim.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="../ace.js"></script>
        <script src="../mode-rust.js"></script>
        <script src="../editor.js"></script>
        <script src="../theme-dawn.js"></script>
        <script src="../theme-tomorrow_night.js"></script>

        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../mermaid.min.js"></script>
        <script src="../mermaid-init.js"></script>



    </div>
    </body>
</html>
