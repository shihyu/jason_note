<!DOCTYPE HTML>
<html lang="zh" class="rust sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>è‡ªå‹•ç¹¼çºŒåŸ·è¡Œ - Jason&#x27;s Notes</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "rust";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>â†</kbd> or <kbd>â†’</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Jason&#x27;s Notes</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/shihyu/jason_note" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="gdb-script-æ–·é»æ‰“å°å¾Œè‡ªå‹•ç¹¼çºŒçš„æŠ€å·§è§£æ"><a class="header" href="#gdb-script-æ–·é»æ‰“å°å¾Œè‡ªå‹•ç¹¼çºŒçš„æŠ€å·§è§£æ">GDB Script æ–·é»æ‰“å°å¾Œè‡ªå‹•ç¹¼çºŒçš„æŠ€å·§è§£æ</a></h1>
<h2 id="-æ ¸å¿ƒæŠ€å·§"><a class="header" href="#-æ ¸å¿ƒæŠ€å·§">ğŸ¯ æ ¸å¿ƒæŠ€å·§</a></h2>
<p>é€™å€‹è…³æœ¬å¯¦ç¾ã€Œæ–·é»å‘½ä¸­â†’æ‰“å°è¨Šæ¯â†’è‡ªå‹•ç¹¼çºŒã€çš„é—œéµæŠ€å·§åœ¨æ–¼ï¼š</p>
<h3 id="1-æ–·é»å‘½ä»¤é…ç½®-breakpoint-commands"><a class="header" href="#1-æ–·é»å‘½ä»¤é…ç½®-breakpoint-commands">1. <strong>æ–·é»å‘½ä»¤é…ç½® (Breakpoint Commands)</strong></a></h3>
<pre><code class="language-python"># é—œéµä»£ç¢¼åœ¨é€™è£¡
def configure_breakpoints():
    for bp in gdb.breakpoints():
        if bp.number &gt; 1:
            # é€™è¡Œæ˜¯æ ¸å¿ƒï¼ç‚ºæ¯å€‹æ–·é»è¨­ç½®è‡ªå‹•åŸ·è¡Œçš„å‘½ä»¤
            bp.commands = "silent\nshow_full_location\ncontinue"
            # æˆ–ç°¡åŒ–ç‰ˆæœ¬
            # bp.commands = "continue"
</code></pre>
<h2 id="-æŠ€è¡“åŸç†è©³è§£"><a class="header" href="#-æŠ€è¡“åŸç†è©³è§£">ğŸ“– æŠ€è¡“åŸç†è©³è§£</a></h2>
<h3 id="æ–·é»å‘½ä»¤çš„åŸ·è¡Œæµç¨‹"><a class="header" href="#æ–·é»å‘½ä»¤çš„åŸ·è¡Œæµç¨‹">æ–·é»å‘½ä»¤çš„åŸ·è¡Œæµç¨‹</a></h3>
<p>ç•¶æ–·é»è¢«å‘½ä¸­æ™‚ï¼ŒGDB æœƒï¼š</p>
<ol>
<li><strong>æš«åœç¨‹å¼åŸ·è¡Œ</strong></li>
<li><strong>åŸ·è¡Œé è¨­çš„å‘½ä»¤åºåˆ—</strong></li>
<li><strong>æ ¹æ“šå‘½ä»¤æ±ºå®šä¸‹ä¸€æ­¥å‹•ä½œ</strong></li>
</ol>
<pre><code class="language-gdb"># å‘½ä»¤åºåˆ—è§£æ
silent              # 1. æŠ‘åˆ¶é è¨­çš„æ–·é»å‘½ä¸­è¨Šæ¯
show_full_location  # 2. åŸ·è¡Œè‡ªå®šç¾©å‡½æ•¸ï¼Œæ‰“å°èª¿è©¦è³‡è¨Š
continue           # 3. è‡ªå‹•ç¹¼çºŒåŸ·è¡Œç¨‹å¼
</code></pre>
<h3 id="é—œéµå‘½ä»¤èªªæ˜"><a class="header" href="#é—œéµå‘½ä»¤èªªæ˜">é—œéµå‘½ä»¤èªªæ˜</a></h3>
<div class="table-wrapper"><table><thead><tr><th>å‘½ä»¤</th><th>ä½œç”¨</th><th>æ•ˆæœ</th></tr></thead><tbody>
<tr><td><code>silent</code></td><td>éœé»˜æ¨¡å¼</td><td>ä¸é¡¯ç¤ºã€ŒBreakpoint X hitã€è¨Šæ¯</td></tr>
<tr><td><code>continue</code></td><td>ç¹¼çºŒåŸ·è¡Œ</td><td>ç¨‹å¼è‡ªå‹•ç¹¼çºŒï¼Œä¸ç­‰å¾…ç”¨æˆ¶è¼¸å…¥</td></tr>
<tr><td>è‡ªå®šç¾©å‡½æ•¸</td><td>åŸ·è¡Œç‰¹å®šæ“ä½œ</td><td>åœ¨ç¹¼çºŒå‰åŸ·è¡Œä»»ä½•éœ€è¦çš„å‹•ä½œ</td></tr>
</tbody></table>
</div>
<h2 id="-å¯¦ç¾æ–¹å¼æ¯”è¼ƒ"><a class="header" href="#-å¯¦ç¾æ–¹å¼æ¯”è¼ƒ">ğŸ”§ å¯¦ç¾æ–¹å¼æ¯”è¼ƒ</a></h2>
<h3 id="æ–¹å¼ä¸€ä½¿ç”¨-gdb-commandså‚³çµ±æ–¹å¼"><a class="header" href="#æ–¹å¼ä¸€ä½¿ç”¨-gdb-commandså‚³çµ±æ–¹å¼">æ–¹å¼ä¸€ï¼šä½¿ç”¨ GDB Commandsï¼ˆå‚³çµ±æ–¹å¼ï¼‰</a></h3>
<pre><code class="language-gdb"># ç‚ºç‰¹å®šæ–·é»è¨­ç½®å‘½ä»¤
break main
commands 2  # 2 æ˜¯æ–·é»ç·¨è™Ÿ
  silent
  printf "Hit main function\n"
  backtrace 1
  continue
end
</code></pre>
<h3 id="æ–¹å¼äºŒä½¿ç”¨-python-apiè…³æœ¬æ¡ç”¨çš„æ–¹å¼"><a class="header" href="#æ–¹å¼äºŒä½¿ç”¨-python-apiè…³æœ¬æ¡ç”¨çš„æ–¹å¼">æ–¹å¼äºŒï¼šä½¿ç”¨ Python APIï¼ˆè…³æœ¬æ¡ç”¨çš„æ–¹å¼ï¼‰</a></h3>
<pre><code class="language-python">import gdb

# æ›´éˆæ´»çš„æ–¹å¼
for bp in gdb.breakpoints():
    bp.commands = """
        silent
        python print(f"âš¡ Hit: {gdb.selected_frame().name()}")
        continue
    """
</code></pre>
<h3 id="æ–¹å¼ä¸‰å®šç¾©æ–·é»é¡é€²éšæ–¹å¼"><a class="header" href="#æ–¹å¼ä¸‰å®šç¾©æ–·é»é¡é€²éšæ–¹å¼">æ–¹å¼ä¸‰ï¼šå®šç¾©æ–·é»é¡ï¼ˆé€²éšæ–¹å¼ï¼‰</a></h3>
<pre><code class="language-python">class AutoContinueBreakpoint(gdb.Breakpoint):
    def __init__(self, spec):
        super().__init__(spec, gdb.BP_BREAKPOINT)
        
    def stop(self):
        # è¿”å› False è¡¨ç¤ºä¸åœæ­¢ï¼Œè‡ªå‹•ç¹¼çºŒ
        frame = gdb.selected_frame()
        print(f"ğŸ“ Passing through: {frame.name()}")
        return False  # é€™æ˜¯é—œéµï¼False = ç¹¼çºŒåŸ·è¡Œ
</code></pre>
<h2 id="-æ ¸å¿ƒæŠ€å·§ç¸½çµ"><a class="header" href="#-æ ¸å¿ƒæŠ€å·§ç¸½çµ">ğŸ’¡ æ ¸å¿ƒæŠ€å·§ç¸½çµ</a></h2>
<h3 id="1-æ‰¹é‡é…ç½®çš„å„ªå‹¢"><a class="header" href="#1-æ‰¹é‡é…ç½®çš„å„ªå‹¢">1. <strong>æ‰¹é‡é…ç½®çš„å„ªå‹¢</strong></a></h3>
<pre><code class="language-python"># è…³æœ¬çš„è°æ˜ä¹‹è™•ï¼šä¸€æ¬¡é…ç½®æ‰€æœ‰æ–·é»
configured_count = 0
for bp in gdb.breakpoints():
    if bp.number &gt; 1:  # è·³é catchpoint
        bp.commands = "continue"
        configured_count += 1
</code></pre>
<h3 id="2-å‹•æ…‹è¼‰å…¥æ™‚æ©Ÿ"><a class="header" href="#2-å‹•æ…‹è¼‰å…¥æ™‚æ©Ÿ">2. <strong>å‹•æ…‹è¼‰å…¥æ™‚æ©Ÿ</strong></a></h3>
<pre><code class="language-gdb"># ç­‰å¾…å‹•æ…‹åº«è¼‰å…¥å¾Œæ‰è¨­ç½®æ–·é»
catch load libintiface_engine_flutter_bridge.so
commands 1
    source breakpoints.txt  # è¼‰å…¥æ–·é»
    python configure_breakpoints()  # æ‰¹é‡é…ç½®
    continue
end
</code></pre>
<h2 id="-å¯¦ç”¨ç¯„ä¾‹"><a class="header" href="#-å¯¦ç”¨ç¯„ä¾‹">ğŸ¨ å¯¦ç”¨ç¯„ä¾‹</a></h2>
<h3 id="ç°¡å–®çš„è¿½è¹¤è…³æœ¬"><a class="header" href="#ç°¡å–®çš„è¿½è¹¤è…³æœ¬">ç°¡å–®çš„è¿½è¹¤è…³æœ¬</a></h3>
<pre><code class="language-gdb"># trace.gdb - æœ€ç°¡è¿½è¹¤è…³æœ¬
define setup_trace
    # è¨­ç½®æ–·é»
    break process_message
    break handle_error
    
    # é…ç½®è‡ªå‹•ç¹¼çºŒ
    python
for bp in gdb.breakpoints():
    bp.commands = """
        silent
        echo ===
        where 1
        continue
    """
    end
end

# ä½¿ç”¨
setup_trace
run
</code></pre>
<h3 id="å¸¶æ¢ä»¶çš„æ™ºèƒ½æ–·é»"><a class="header" href="#å¸¶æ¢ä»¶çš„æ™ºèƒ½æ–·é»">å¸¶æ¢ä»¶çš„æ™ºèƒ½æ–·é»</a></h3>
<pre><code class="language-python">class ConditionalTracer(gdb.Breakpoint):
    def __init__(self, spec, condition_func):
        super().__init__(spec)
        self.condition_func = condition_func
        
    def stop(self):
        # æ ¹æ“šæ¢ä»¶æ±ºå®šæ˜¯å¦æ‰“å°
        if self.condition_func():
            print(f"âš ï¸ Condition met at {self.location}")
            # å¯ä»¥é¸æ“‡åœæ­¢æˆ–ç¹¼çºŒ
            return False  # æ‰“å°å¾Œç¹¼çºŒ
        return False  # ç›´æ¥ç¹¼çºŒ

# ä½¿ç”¨ç¯„ä¾‹
def check_error():
    # æª¢æŸ¥æ˜¯å¦æœ‰éŒ¯èª¤
    return gdb.parse_and_eval("error_code") != 0

bp = ConditionalTracer("process_data", check_error)
</code></pre>
<h3 id="è¨ˆæ•¸å‹æ–·é»"><a class="header" href="#è¨ˆæ•¸å‹æ–·é»">è¨ˆæ•¸å‹æ–·é»</a></h3>
<pre><code class="language-python">class CountingBreakpoint(gdb.Breakpoint):
    def __init__(self, spec, threshold=10):
        super().__init__(spec)
        self.count = 0
        self.threshold = threshold
        
    def stop(self):
        self.count += 1
        if self.count % self.threshold == 0:
            print(f"ğŸ“Š {self.location} hit {self.count} times")
        return False  # æ°¸é ä¸åœæ­¢

# æ¯10æ¬¡æ‰“å°ä¸€æ¬¡çµ±è¨ˆ
bp = CountingBreakpoint("hot_function", 10)
</code></pre>
<h2 id="-æ•ˆèƒ½è€ƒé‡"><a class="header" href="#-æ•ˆèƒ½è€ƒé‡">âš¡ æ•ˆèƒ½è€ƒé‡</a></h2>
<h3 id="æ–·é»é–‹éŠ·æ¯”è¼ƒ"><a class="header" href="#æ–·é»é–‹éŠ·æ¯”è¼ƒ">æ–·é»é–‹éŠ·æ¯”è¼ƒ</a></h3>
<pre><code class="language-python"># æœ€å°é–‹éŠ·ç‰ˆæœ¬
bp.commands = "continue"

# ä¸­ç­‰é–‹éŠ·ç‰ˆæœ¬
bp.commands = """
    silent
    printf "."
    continue
"""

# é«˜é–‹éŠ·ç‰ˆæœ¬
bp.commands = """
    silent
    python complex_analysis()
    backtrace
    info locals
    continue
"""
</code></pre>
<h3 id="é¸æ“‡æ€§è¿½è¹¤å„ªåŒ–"><a class="header" href="#é¸æ“‡æ€§è¿½è¹¤å„ªåŒ–">é¸æ“‡æ€§è¿½è¹¤å„ªåŒ–</a></h3>
<pre><code class="language-python">class OptimizedTracer(gdb.Breakpoint):
    def __init__(self, spec):
        super().__init__(spec)
        self.sample_rate = 100  # æ¯100æ¬¡æ¡æ¨£ä¸€æ¬¡
        self.counter = 0
        
    def stop(self):
        self.counter += 1
        if self.counter % self.sample_rate == 0:
            self.detailed_analysis()
        return False
    
    def detailed_analysis(self):
        # åªåœ¨æ¡æ¨£æ™‚åŸ·è¡Œæ˜‚è²´æ“ä½œ
        frame = gdb.selected_frame()
        print(f"ğŸ“ˆ Sample #{self.counter}: {frame.name()}")
</code></pre>
<h2 id="-é€²éšèª¿è©¦æŠ€å·§"><a class="header" href="#-é€²éšèª¿è©¦æŠ€å·§">ğŸ› ï¸ é€²éšèª¿è©¦æŠ€å·§</a></h2>
<h3 id="1-å‹•æ…‹é–‹é—œè¿½è¹¤"><a class="header" href="#1-å‹•æ…‹é–‹é—œè¿½è¹¤">1. å‹•æ…‹é–‹é—œè¿½è¹¤</a></h3>
<pre><code class="language-python"># å…¨å±€æ§åˆ¶
class TraceControl:
    enabled = True
    verbose = False
    filters = []

class SmartBreakpoint(gdb.Breakpoint):
    def stop(self):
        if not TraceControl.enabled:
            return False
            
        frame_name = gdb.selected_frame().name()
        
        # æ‡‰ç”¨éæ¿¾å™¨
        if TraceControl.filters:
            if not any(f in frame_name for f in TraceControl.filters):
                return False
        
        # è©³ç´°æˆ–ç°¡å–®è¼¸å‡º
        if TraceControl.verbose:
            self.detailed_trace()
        else:
            print(".", end="", flush=True)
            
        return False

# é‹è¡Œæ™‚æ§åˆ¶
(gdb) python TraceControl.enabled = False
(gdb) python TraceControl.filters = ["engine", "core"]
(gdb) python TraceControl.verbose = True
</code></pre>
<h3 id="2-æ™‚é–“æˆ³è¿½è¹¤"><a class="header" href="#2-æ™‚é–“æˆ³è¿½è¹¤">2. æ™‚é–“æˆ³è¿½è¹¤</a></h3>
<pre><code class="language-python">import time

class TimedBreakpoint(gdb.Breakpoint):
    def __init__(self, spec):
        super().__init__(spec)
        self.last_hit = None
        
    def stop(self):
        now = time.time()
        if self.last_hit:
            delta = now - self.last_hit
            if delta &gt; 0.1:  # åªè¨˜éŒ„è¶…é100msçš„é–“éš”
                print(f"â±ï¸ {self.location}: {delta:.3f}s since last hit")
        self.last_hit = now
        return False
</code></pre>
<h3 id="3-å †ç–Šæ·±åº¦è¿½è¹¤"><a class="header" href="#3-å †ç–Šæ·±åº¦è¿½è¹¤">3. å †ç–Šæ·±åº¦è¿½è¹¤</a></h3>
<pre><code class="language-python">class StackDepthTracer(gdb.Breakpoint):
    def __init__(self, spec):
        super().__init__(spec)
        self.max_depth = 0
        
    def stop(self):
        depth = len(gdb.newest_frame().older())
        if depth &gt; self.max_depth:
            self.max_depth = depth
            print(f"ğŸ“ New max stack depth: {depth} at {self.location}")
        return False
</code></pre>
<h2 id="-å®Œæ•´å·¥ä½œæµç¨‹åœ–"><a class="header" href="#-å®Œæ•´å·¥ä½œæµç¨‹åœ–">ğŸ“Š å®Œæ•´å·¥ä½œæµç¨‹åœ–</a></h2>
<pre><code>ç¨‹å¼å•Ÿå‹•
    â†“
å‹•æ…‹åº«è¼‰å…¥æª¢æ¸¬ (catch load)
    â†“
è§¸ç™¼è¼‰å…¥äº‹ä»¶
    â†“
åŸ·è¡Œè¼‰å…¥å‘½ä»¤åºåˆ—
    â”œâ”€â†’ è¼‰å…¥æ–·é»æª”æ¡ˆ (source breakpoints.txt)
    â”œâ”€â†’ æ‰¹é‡é…ç½®æ–·é» (Python configure_breakpoints)
    â””â”€â†’ ç¹¼çºŒåŸ·è¡Œ (continue)
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ç¨‹å¼   â”‚
    â”‚ åŸ·è¡Œ   â”‚â†â”€â”€â”€â”€â”€â”€â”
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
         â†“           â”‚
    é‡åˆ°æ–·é»         â”‚
         â†“           â”‚
    GDB æš«åœ         â”‚
         â†“           â”‚
    åŸ·è¡Œ bp.commands â”‚
         â”œâ”€â†’ silent  â”‚
         â”œâ”€â†’ è‡ªå®šç¾©  â”‚
         â””â”€â†’ continueâ”˜
</code></pre>
<h2 id="-é™¤éŒ¯æ–·é»å‘½ä»¤"><a class="header" href="#-é™¤éŒ¯æ–·é»å‘½ä»¤">ğŸ” é™¤éŒ¯æ–·é»å‘½ä»¤</a></h2>
<h3 id="æ¸¬è©¦å–®ä¸€æ–·é»"><a class="header" href="#æ¸¬è©¦å–®ä¸€æ–·é»">æ¸¬è©¦å–®ä¸€æ–·é»</a></h3>
<pre><code class="language-gdb"># æ‰‹å‹•æ¸¬è©¦
(gdb) break test_function
Breakpoint 2 at 0x4005c0: file test.c, line 10.

(gdb) commands 2
Type commands for breakpoint(s) 2, one per line.
End with a line saying just "end".
&gt; silent
&gt; printf "Test: hit breakpoint\n"
&gt; continue
&gt; end

(gdb) run
Test: hit breakpoint
[ç¨‹å¼ç¹¼çºŒåŸ·è¡Œ...]
</code></pre>
<h3 id="æª¢æŸ¥æ–·é»é…ç½®"><a class="header" href="#æª¢æŸ¥æ–·é»é…ç½®">æª¢æŸ¥æ–·é»é…ç½®</a></h3>
<pre><code class="language-python"># é¡¯ç¤ºæ‰€æœ‰æ–·é»çš„å‘½ä»¤
python
for bp in gdb.breakpoints():
    print(f"Breakpoint {bp.number}:")
    print(f"  Location: {bp.location}")
    print(f"  Commands: {bp.commands}")
    print(f"  Enabled: {bp.enabled}")
end
</code></pre>
<h2 id="-æœ€ä½³å¯¦è¸"><a class="header" href="#-æœ€ä½³å¯¦è¸">ğŸ“ æœ€ä½³å¯¦è¸</a></h2>
<h3 id="1-åˆ†å±¤è¿½è¹¤ç­–ç•¥"><a class="header" href="#1-åˆ†å±¤è¿½è¹¤ç­–ç•¥">1. <strong>åˆ†å±¤è¿½è¹¤ç­–ç•¥</strong></a></h3>
<pre><code class="language-python"># ä¸åŒå±¤ç´šçš„è¿½è¹¤
class LayeredTracer:
    CRITICAL = 1
    INFO = 2
    DEBUG = 3
    
    level = INFO
    
    @classmethod
    def trace(cls, level, message):
        if level &lt;= cls.level:
            print(message)

class SmartBreakpoint(gdb.Breakpoint):
    def __init__(self, spec, level=LayeredTracer.INFO):
        super().__init__(spec)
        self.level = level
        
    def stop(self):
        LayeredTracer.trace(
            self.level,
            f"[{self.level}] {self.location}"
        )
        return False
</code></pre>
<h3 id="2-éŒ¯èª¤æ¢å¾©æ©Ÿåˆ¶"><a class="header" href="#2-éŒ¯èª¤æ¢å¾©æ©Ÿåˆ¶">2. <strong>éŒ¯èª¤æ¢å¾©æ©Ÿåˆ¶</strong></a></h3>
<pre><code class="language-python">class SafeBreakpoint(gdb.Breakpoint):
    def stop(self):
        try:
            # åŸ·è¡Œå¯èƒ½å‡ºéŒ¯çš„æ“ä½œ
            self.analyze()
        except Exception as e:
            print(f"âŒ Error in breakpoint: {e}")
        finally:
            # ç¢ºä¿ç¨‹å¼ç¹¼çºŒåŸ·è¡Œ
            return False
</code></pre>
<h3 id="3-è³‡æºç®¡ç†"><a class="header" href="#3-è³‡æºç®¡ç†">3. <strong>è³‡æºç®¡ç†</strong></a></h3>
<pre><code class="language-python">class ResourceAwareBreakpoint(gdb.Breakpoint):
    def __init__(self, spec, max_logs=1000):
        super().__init__(spec)
        self.logs = []
        self.max_logs = max_logs
        
    def stop(self):
        # é˜²æ­¢è¨˜æ†¶é«”ç„¡é™å¢é•·
        if len(self.logs) &gt;= self.max_logs:
            self.logs.pop(0)
        
        self.logs.append({
            'time': time.time(),
            'frame': gdb.selected_frame().name()
        })
        
        return False
</code></pre>
<h2 id="-è¼¸å‡ºåˆ°æª”æ¡ˆ"><a class="header" href="#-è¼¸å‡ºåˆ°æª”æ¡ˆ">ğŸ’¾ è¼¸å‡ºåˆ°æª”æ¡ˆ</a></h2>
<pre><code class="language-python">class FileTracer(gdb.Breakpoint):
    def __init__(self, spec, filename="/tmp/trace.log"):
        super().__init__(spec)
        self.file = open(filename, "a")
        
    def stop(self):
        timestamp = time.strftime("%Y-%m-%d %H:%M:%S")
        frame = gdb.selected_frame()
        self.file.write(f"{timestamp} - {frame.name()}\n")
        self.file.flush()  # ç¢ºä¿å³æ™‚å¯«å…¥
        return False
        
    def __del__(self):
        if hasattr(self, 'file'):
            self.file.close()
</code></pre>
<h2 id="-ç›¸é—œè³‡æº"><a class="header" href="#-ç›¸é—œè³‡æº">ğŸ“š ç›¸é—œè³‡æº</a></h2>
<ul>
<li><a href="https://sourceware.org/gdb/current/onlinedocs/gdb/Python-API.html">GDB Python API æ–‡æª”</a></li>
<li><a href="https://sourceware.org/gdb/current/onlinedocs/gdb/Break-Commands.html">GDB æ–·é»å‘½ä»¤æ–‡æª”</a></li>
<li><a href="https://interrupt.memfault.com/blog/advanced-gdb">é«˜ç´š GDB è…³æœ¬æŠ€è¡“</a></li>
</ul>
<h2 id="-é—œéµè¦é»ç¸½çµ"><a class="header" href="#-é—œéµè¦é»ç¸½çµ">ğŸ¯ é—œéµè¦é»ç¸½çµ</a></h2>
<ol>
<li><strong>æ ¸å¿ƒæ©Ÿåˆ¶</strong>ï¼šä½¿ç”¨ <code>bp.commands = "continue"</code> å¯¦ç¾è‡ªå‹•ç¹¼çºŒ</li>
<li><strong>éˆæ´»æ€§</strong>ï¼šPython API æä¾›æ¯”å‚³çµ± GDB å‘½ä»¤æ›´å¼·å¤§çš„æ§åˆ¶</li>
<li><strong>æ•ˆèƒ½</strong>ï¼šæ³¨æ„æ–·é»å‘½ä»¤çš„é–‹éŠ·ï¼Œé«˜é »æ–·é»ä½¿ç”¨ç°¡å–®å‘½ä»¤</li>
<li><strong>å¯é æ€§</strong>ï¼šä½¿ç”¨ç•°å¸¸è™•ç†ç¢ºä¿èª¿è©¦ä¸å½±éŸ¿ç¨‹å¼åŸ·è¡Œ</li>
<li><strong>å¯æ“´å±•</strong>ï¼šé€éé¡ç¹¼æ‰¿å’Œçµ„åˆå¯¦ç¾è¤‡é›œçš„è¿½è¹¤é‚è¼¯</li>
</ol>
<p>é€™å€‹æŠ€å·§å°‡ GDB å¾äº’å‹•å¼èª¿è©¦å™¨è½‰è®Šç‚ºå¼·å¤§çš„è‡ªå‹•åŒ–è¿½è¹¤å’Œåˆ†æå·¥å…·ï¼</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../gdb/gdb_watchpoints_guide.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../gdb/gdb_ex_complete_guide.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../gdb/gdb_watchpoints_guide.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../gdb/gdb_ex_complete_guide.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="../ace.js"></script>
        <script src="../mode-rust.js"></script>
        <script src="../editor.js"></script>
        <script src="../theme-dawn.js"></script>
        <script src="../theme-tomorrow_night.js"></script>

        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../mermaid.min.js"></script>
        <script src="../mermaid-init.js"></script>



    </div>
    </body>
</html>
