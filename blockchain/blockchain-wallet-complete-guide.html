<!DOCTYPE HTML>
<html lang="zh" class="rust sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>å€å¡ŠéˆéŒ¢åŒ…å®Œæ•´çŸ¥è­˜é«”ç³» - Jason&#x27;s Notes</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "rust";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>â†</kbd> or <kbd>â†’</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Jason&#x27;s Notes</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/shihyu/jason_note" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="å€å¡ŠéˆéŒ¢åŒ…å®Œæ•´çŸ¥è­˜é«”ç³»"><a class="header" href="#å€å¡ŠéˆéŒ¢åŒ…å®Œæ•´çŸ¥è­˜é«”ç³»">å€å¡ŠéˆéŒ¢åŒ…å®Œæ•´çŸ¥è­˜é«”ç³»</a></h1>
<blockquote>
<p>ğŸ“š å¾åŸºç¤åŸç†åˆ°é«˜ç´šæ‡‰ç”¨çš„å®Œæ•´æŒ‡å—</p>
<p>ä½œè€…æ•´ç†æ—¥æœŸï¼š2024-11-13</p>
<p>æœ¬æ–‡æª”æ•´åˆç™½æ¿è¨è«–å…§å®¹ï¼Œæ¶µè“‹å€å¡ŠéˆéŒ¢åŒ…é–‹ç™¼çš„æ‰€æœ‰æ ¸å¿ƒçŸ¥è­˜</p>
</blockquote>
<hr />
<h2 id="-ç›®éŒ„"><a class="header" href="#-ç›®éŒ„">ğŸ“‘ ç›®éŒ„</a></h2>
<ul>
<li><a href="#1-%E5%8D%80%E5%A1%8A%E9%8F%88%E5%9F%BA%E7%A4%8E%E5%8E%9F%E7%90%86">1. å€å¡ŠéˆåŸºç¤åŸç†</a></li>
<li><a href="#2-%E5%8D%80%E5%A1%8A%E7%B5%90%E6%A7%8B%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90">2. å€å¡Šçµæ§‹æ·±åº¦è§£æ</a></li>
<li><a href="#3-transaction-hash-%E8%88%87-block-number">3. Transaction Hash èˆ‡ Block Number</a></li>
<li><a href="#4-%E5%A4%9A%E5%B1%A4%E8%AA%BF%E7%94%A8%E6%A9%9F%E5%88%B6">4. å¤šå±¤èª¿ç”¨æ©Ÿåˆ¶</a></li>
<li><a href="#5-%E5%AF%86%E9%91%B0%E7%AE%A1%E7%90%86%E8%88%87%E5%9C%B0%E5%9D%80%E7%94%9F%E6%88%90">5. å¯†é‘°ç®¡ç†èˆ‡åœ°å€ç”Ÿæˆ</a></li>
<li><a href="#6-%E4%BA%A4%E6%98%93%E7%94%9F%E5%91%BD%E9%80%B1%E6%9C%9F">6. äº¤æ˜“ç”Ÿå‘½é€±æœŸ</a></li>
<li><a href="#7-%E5%A4%9A%E7%B0%BD%E9%8C%A2%E5%8C%85-multi-signature">7. å¤šç°½éŒ¢åŒ… (Multi-Signature)</a></li>
<li><a href="#8-%E6%99%BA%E8%83%BD%E5%90%88%E7%B4%84%E9%8C%A2%E5%8C%85-vs-eoa">8. æ™ºèƒ½åˆç´„éŒ¢åŒ… vs EOA</a></li>
<li><a href="#9-%E4%BB%A3%E5%B9%A3%E6%A8%99%E6%BA%96-erc-207211155">9. ä»£å¹£æ¨™æº– (ERC-20/721/1155)</a></li>
<li><a href="#10-gas-%E6%A9%9F%E5%88%B6%E8%88%87%E5%84%AA%E5%8C%96">10. Gas æ©Ÿåˆ¶èˆ‡å„ªåŒ–</a></li>
<li><a href="#11-%E9%8C%A2%E5%8C%85%E9%80%A3%E6%8E%A5%E5%8D%94%E8%AD%B0">11. éŒ¢åŒ…é€£æ¥å”è­°</a></li>
<li><a href="#12-%E5%AE%89%E5%85%A8%E6%9C%80%E4%BD%B3%E5%AF%A6%E8%B8%90">12. å®‰å…¨æœ€ä½³å¯¦è¸</a></li>
<li><a href="#13-%E9%AB%98%E7%B4%9A%E5%8A%9F%E8%83%BD">13. é«˜ç´šåŠŸèƒ½</a></li>
<li><a href="#14-%E5%8D%80%E5%A1%8A%E9%8F%88%E6%9E%B6%E6%A7%8B%E5%9C%96">14. å€å¡Šéˆæ¶æ§‹åœ–</a></li>
</ul>
<hr />
<h2 id="1-å€å¡ŠéˆåŸºç¤åŸç†"><a class="header" href="#1-å€å¡ŠéˆåŸºç¤åŸç†">1. å€å¡ŠéˆåŸºç¤åŸç†</a></h2>
<h3 id="11-æ ¸å¿ƒæ¦‚å¿µ"><a class="header" href="#11-æ ¸å¿ƒæ¦‚å¿µ">1.1 æ ¸å¿ƒæ¦‚å¿µ</a></h3>
<p>å€å¡Šéˆæ˜¯ä¸€å€‹å»ä¸­å¿ƒåŒ–çš„åˆ†æ•£å¼å¸³æœ¬ç³»çµ±ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹é»ï¼š</p>
<pre><code>å€å¡Šéˆç‰¹æ€§ï¼š
â”œâ”€ ä¸å¯ç¯¡æ”¹ï¼šä¿®æ”¹æ­·å²æ•¸æ“šæœƒç ´å£æ•´æ¢éˆ
â”œâ”€ å»ä¸­å¿ƒåŒ–ï¼šç„¡å–®é»æ§åˆ¶
â”œâ”€ é€æ˜å¯è¿½æº¯ï¼šæ‰€æœ‰äº¤æ˜“å…¬é–‹å¯æŸ¥
â””â”€ å…±è­˜æ©Ÿåˆ¶ï¼šé€šéç®—æ³•é”æˆä¸€è‡´
</code></pre>
<h3 id="12-hash-å‡½æ•¸"><a class="header" href="#12-hash-å‡½æ•¸">1.2 Hash å‡½æ•¸</a></h3>
<pre><code class="language-javascript">// Keccak-256 (ä»¥å¤ªåŠä½¿ç”¨)
è¼¸å…¥: "Hello World"
è¼¸å‡º: "a591a6d40bf420404a011733cfb7b190d62c65bf0bcda32b57b277d9ad9f146e"

ç‰¹æ€§ï¼š
âœ“ ç¢ºå®šæ€§ï¼šç›¸åŒè¼¸å…¥ â†’ ç›¸åŒè¼¸å‡º
âœ“ å–®å‘æ€§ï¼šç„¡æ³•å¾ hash åæ¨åŸæ–‡
âœ“ é›ªå´©æ•ˆæ‡‰ï¼šè¼¸å…¥å¾®å°æ”¹è®Š â†’ hash å®Œå…¨ä¸åŒ
âœ“ é˜²ç¢°æ’ï¼šå¹¾ä¹ä¸å¯èƒ½æ‰¾åˆ°å…©å€‹ç›¸åŒ hash (2^256 ç¨®å¯èƒ½)

æ‡‰ç”¨å ´æ™¯ï¼š
- äº¤æ˜“ Hash (Transaction Hash)
- å€å¡Š Hash (Block Hash)
- åœ°å€ç”Ÿæˆ (å…¬é‘° â†’ Hash â†’ åœ°å€)
- æ•¸æ“šé©—è­‰èˆ‡å®Œæ•´æ€§æª¢æŸ¥
</code></pre>
<h3 id="13-p2p-ç¶²çµ¡"><a class="header" href="#13-p2p-ç¶²çµ¡">1.3 P2P ç¶²çµ¡</a></h3>
<pre><code>å»ä¸­å¿ƒåŒ–ç¶²çµ¡æ¶æ§‹ï¼š

ç¯€é» A â†â†’ ç¯€é» B â†â†’ ç¯€é» C
  â†•         â†•         â†•
ç¯€é» D â†â†’ ç¯€é» E â†â†’ ç¯€é» F
  â†•         â†•         â†•
ç¯€é» G â†â†’ ç¯€é» H â†â†’ ç¯€é» I

ç‰¹é»ï¼š
âœ“ æ²’æœ‰ä¸­å¿ƒæœå‹™å™¨
âœ“ ç¯€é»åœ°ä½å¹³ç­‰
âœ“ å»£æ’­æ©Ÿåˆ¶ï¼šäº¤æ˜“é€æ­¥æ“´æ•£åˆ°å…¨ç¶²
âœ“ å®¹éŒ¯æ€§é«˜ï¼šéƒ¨åˆ†ç¯€é»å¤±æ•ˆä¸å½±éŸ¿ç¶²çµ¡
âœ“ æŠ—å¯©æŸ¥ï¼šç„¡å–®é»å¯ä»¥æ§åˆ¶æˆ–é—œé–‰ç¶²çµ¡
</code></pre>
<h3 id="14-å…±è­˜æ©Ÿåˆ¶å°æ¯”"><a class="header" href="#14-å…±è­˜æ©Ÿåˆ¶å°æ¯”">1.4 å…±è­˜æ©Ÿåˆ¶å°æ¯”</a></h3>
<h4 id="pow-proof-of-work---æ¯”ç‰¹å¹£"><a class="header" href="#pow-proof-of-work---æ¯”ç‰¹å¹£">PoW (Proof of Work) - æ¯”ç‰¹å¹£</a></h4>
<pre><code>å·¥ä½œåŸç†ï¼š
ç¤¦å·¥ç«¶çˆ­å°‹æ‰¾ç¬¦åˆé›£åº¦çš„ Nonce

Block Header:
  - Previous Block Hash
  - Merkle Root  
  - Timestamp
  - Nonce â† ä¸æ–·å˜—è©¦ç›´åˆ°æ‰¾åˆ°ç¬¦åˆæ¢ä»¶çš„å€¼

Hash(Block Header) &lt; Target é›£åº¦
â†“
æ‰¾åˆ°äº†ï¼ç²å¾—å€å¡Šçå‹µ

å‡ºå¡Šæ™‚é–“ï¼š~10 åˆ†é˜/å€å¡Šï¼ˆæ¯”ç‰¹å¹£ï¼‰
èƒ½è€—ï¼šæ¥µé«˜ï¼ˆç›¸ç•¶æ–¼ä¸€å€‹å°åœ‹å®¶çš„ç”¨é›»é‡ï¼‰
å®‰å…¨æ€§ï¼šæ¥µé«˜ï¼ˆéœ€è¦æŒæ§51%ç®—åŠ›æ‰èƒ½æ”»æ“Šï¼‰

å„ªé»ï¼š
âœ“ ä¹…ç¶“é©—è­‰çš„å®‰å…¨æ€§
âœ“ å®Œå…¨å»ä¸­å¿ƒåŒ–
âœ“ æŠ—æ”»æ“Šèƒ½åŠ›å¼·

ç¼ºé»ï¼š
âœ— èƒ½æºæ¶ˆè€—å·¨å¤§
âœ— äº¤æ˜“é€Ÿåº¦æ…¢ï¼ˆ7 TPSï¼‰
âœ— ç¤¦æ©Ÿè»å‚™ç«¶è³½
</code></pre>
<h4 id="pos-proof-of-stake---ä»¥å¤ªåŠ"><a class="header" href="#pos-proof-of-stake---ä»¥å¤ªåŠ">PoS (Proof of Stake) - ä»¥å¤ªåŠ</a></h4>
<pre><code>å·¥ä½œåŸç†ï¼š
é©—è­‰è€…è³ªæŠ¼ 32 ETH
â†“
è¢«éš¨æ©Ÿé¸ä¸­æè­°å€å¡Š
â†“
å…¶ä»–é©—è­‰è€…æŠ•ç¥¨ç¢ºèª
â†“
ç²å¾—çå‹µï¼ˆæ–°ç™¼è¡Œä»£å¹£ + äº¤æ˜“æ‰‹çºŒè²»ï¼‰

å¦‚æœä½œæƒ¡ â†’ è³ªæŠ¼çš„ ETH è¢«ç½°æ²’ (Slashing)

å‡ºå¡Šæ™‚é–“ï¼š~12 ç§’/å€å¡Šï¼ˆä»¥å¤ªåŠï¼‰
èƒ½è€—ï¼šæ¥µä½ï¼ˆé™ä½ 99.95%ï¼‰
å®‰å…¨æ€§ï¼šç¶“æ¿Ÿåšå¼ˆä¿è­‰

å„ªé»ï¼š
âœ“ ç¯€èƒ½ç’°ä¿
âœ“ äº¤æ˜“é€Ÿåº¦å¿«ï¼ˆ15-30 TPSï¼‰
âœ“ æ›´ä½çš„é€²å…¥é–€æª»
âœ“ æ›´å¥½çš„å¯æ“´å±•æ€§

ç¼ºé»ï¼š
âš ï¸ å¯Œè€…æ„ˆå¯Œï¼ˆè³ªæŠ¼å¤šçš„äººæ›´å®¹æ˜“è¢«é¸ä¸­ï¼‰
âš ï¸ é•·æœŸå®‰å…¨æ€§ä»å¾…è§€å¯Ÿ
âš ï¸ ç›¸å°è¼ƒæ–°çš„æ©Ÿåˆ¶
</code></pre>
<hr />
<h2 id="2-å€å¡Šçµæ§‹æ·±åº¦è§£æ"><a class="header" href="#2-å€å¡Šçµæ§‹æ·±åº¦è§£æ">2. å€å¡Šçµæ§‹æ·±åº¦è§£æ</a></h2>
<h3 id="21-å®Œæ•´å€å¡Šçµæ§‹"><a class="header" href="#21-å®Œæ•´å€å¡Šçµæ§‹">2.1 å®Œæ•´å€å¡Šçµæ§‹</a></h3>
<pre><code>â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    Block #18,500,000                           â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                â•‘
â•‘  ã€å€å¡Šé ­ Block Headerã€‘- å›ºå®šå¤§å°ï¼Œç´„ 508 bytes              â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚ Previous Block Hash (å‰ä¸€å€‹å€å¡Šçš„Hash) - 32 bytes      â”‚  â•‘
â•‘  â”‚ 0x8a7d2f3e9b1c5d4a6f8e2c1b9a7d5e3f2c1a9b8d7e6f5c4d3  â”‚  â•‘
â•‘  â”‚ â†“ éˆæ¥åˆ°å‰ä¸€å€‹å€å¡Šï¼Œå½¢æˆä¸å¯ç¯¡æ”¹çš„éˆæ¢                   â”‚  â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â•‘
â•‘  â”‚ Block Number (å€å¡Šç·¨è™Ÿ) - 8 bytes                       â”‚  â•‘
â•‘  â”‚ 18,500,000                                             â”‚  â•‘
â•‘  â”‚ â†“ é€™å€‹å€å¡Šåœ¨æ•´æ¢éˆä¸Šçš„ä½ç½®ï¼ˆå¾ 0 é–‹å§‹è¨ˆæ•¸ï¼‰              â”‚  â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â•‘
â•‘  â”‚ Timestamp (æ™‚é–“æˆ³) - 8 bytes                            â”‚  â•‘
â•‘  â”‚ 1699876845 (2023-11-13 10:47:25 UTC)                  â”‚  â•‘
â•‘  â”‚ â†“ Unix æ™‚é–“æˆ³ï¼Œå€å¡Šè¢«å‰µå»ºçš„æ™‚é–“                          â”‚  â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â•‘
â•‘  â”‚ State Root (ç‹€æ…‹æ¨¹æ ¹) - 32 bytes                        â”‚  â•‘
â•‘  â”‚ 0x4f9a3b2e8d1c7f6a5e9d3c2b8a7f6e5d4c3b2a1f9e8d7c6b5  â”‚  â•‘
â•‘  â”‚ â†“ æ‰€æœ‰å¸³æˆ¶ç‹€æ…‹çš„ Merkle Patricia Tree æ ¹ç¯€é»             â”‚  â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â•‘
â•‘  â”‚ Transactions Root (äº¤æ˜“æ¨¹æ ¹) - 32 bytes                 â”‚  â•‘
â•‘  â”‚ 0x9f3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6  â”‚  â•‘
â•‘  â”‚ â†“ æ‰€æœ‰äº¤æ˜“çš„ Merkle Tree æ ¹ç¯€é»ï¼ˆç”¨æ–¼å¿«é€Ÿé©—è­‰ï¼‰          â”‚  â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â•‘
â•‘  â”‚ Receipts Root (æ”¶æ“šæ¨¹æ ¹) - 32 bytes                     â”‚  â•‘
â•‘  â”‚ 0x2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6  â”‚  â•‘
â•‘  â”‚ â†“ æ‰€æœ‰äº¤æ˜“æ”¶æ“šçš„ Merkle Tree æ ¹ç¯€é»                      â”‚  â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â•‘
â•‘  â”‚ Gas Limit (Gas ä¸Šé™) - 8 bytes                          â”‚  â•‘
â•‘  â”‚ 30,000,000                                             â”‚  â•‘
â•‘  â”‚ â†“ é€™å€‹å€å¡Šå…è¨±çš„æœ€å¤§ Gas æ¶ˆè€—                            â”‚  â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â•‘
â•‘  â”‚ Gas Used (å·²ä½¿ç”¨ Gas) - 8 bytes                         â”‚  â•‘
â•‘  â”‚ 14,789,234 (49.3% ä½¿ç”¨ç‡)                              â”‚  â•‘
â•‘  â”‚ â†“ é€™å€‹å€å¡Šå¯¦éš›æ¶ˆè€—çš„ Gas                                 â”‚  â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â•‘
â•‘  â”‚ Miner/Validator (å‡ºå¡Šè€…) - 20 bytes                     â”‚  â•‘
â•‘  â”‚ 0x1f9840a85d5aF5bf1D1762F925BDADdC4201F984              â”‚  â•‘
â•‘  â”‚ â†“ ç”¢ç”Ÿé€™å€‹å€å¡Šçš„ç¤¦å·¥/é©—è­‰è€…åœ°å€                          â”‚  â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â•‘
â•‘  â”‚ Base Fee Per Gas (EIP-1559) - 8 bytes                  â”‚  â•‘
â•‘  â”‚ 25 Gwei                                                â”‚  â•‘
â•‘  â”‚ â†“ åŸºç¤ Gas è²»ç”¨ï¼ˆå‹•æ…‹èª¿æ•´ï¼‰                              â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                â•‘
â•‘  ã€å€å¡Šé«” Block Bodyã€‘- å¯è®Šå¤§å°                               â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚ Transaction Count: 268 ç­†äº¤æ˜“                           â”‚  â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â•‘
â•‘  â”‚ Transaction #1                                          â”‚  â•‘
â•‘  â”‚ â”œâ”€ Hash: 0xabc123def456...                             â”‚  â•‘
â•‘  â”‚ â”œâ”€ From: 0x742d35Cc...                                 â”‚  â•‘
â•‘  â”‚ â”œâ”€ To: 0x8f3a2b1c...                                   â”‚  â•‘
â•‘  â”‚ â”œâ”€ Value: 1.5 ETH                                      â”‚  â•‘
â•‘  â”‚ â”œâ”€ Gas: 21,000                                         â”‚  â•‘
â•‘  â”‚ â””â”€ Signature: (v, r, s)                                â”‚  â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â•‘
â•‘  â”‚ ... (ç¸½å…± 268 ç­†äº¤æ˜“)                                    â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                â•‘
â•‘  ã€æ­¤å€å¡Šçš„ Hashã€‘                                              â•‘
â•‘  0x4d7a9e6f5c3b2a1f8e7d6c5b4a3f2e1d9c8b7a6f5e4d3c2b1a9f8e  â•‘
â•‘  â†“ ä¸‹ä¸€å€‹å€å¡Šæœƒå¼•ç”¨é€™å€‹ Hash                                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
</code></pre>
<h3 id="22-merkle-tree-çµæ§‹"><a class="header" href="#22-merkle-tree-çµæ§‹">2.2 Merkle Tree çµæ§‹</a></h3>
<p>Merkle Tree æ˜¯å€å¡Šéˆä¸­ç”¨æ–¼é«˜æ•ˆé©—è­‰æ•¸æ“šçš„é—œéµæ•¸æ“šçµæ§‹ã€‚</p>
<p><strong>ç‚ºä»€éº¼éœ€è¦ Merkle Treeï¼Ÿ</strong></p>
<ul>
<li>å¿«é€Ÿé©—è­‰ï¼šä¸éœ€è¦ä¸‹è¼‰æ•´å€‹å€å¡Šå°±èƒ½é©—è­‰æŸç­†äº¤æ˜“æ˜¯å¦å­˜åœ¨</li>
<li>è¼•ç¯€é»æ”¯æŒï¼šæ‰‹æ©ŸéŒ¢åŒ…å¯ä»¥ä½¿ç”¨ SPVï¼ˆç°¡åŒ–æ”¯ä»˜é©—è­‰ï¼‰</li>
<li>ç¯€çœå¸¶å¯¬ï¼šåªéœ€å‚³è¼¸å¿…è¦çš„è­‰æ˜è·¯å¾‘</li>
</ul>
<pre><code>Merkle Tree çµæ§‹ç¤ºæ„åœ–ï¼š

                    Root Hash (Merkle Root)
                    0x9f3b4c5d...
                   /              \
                  /                \
        Hash(0-1)                  Hash(2-3)
        0x1a2b...                  0x3c4d...
       /        \                 /        \
      /          \               /          \
  Hash(Tx0)   Hash(Tx1)     Hash(Tx2)   Hash(Tx3)
  0xabc...    0xdef...      0x123...    0x456...
     |           |             |           |
   Tx #0       Tx #1         Tx #2       Tx #3

é©—è­‰éç¨‹ï¼ˆè¼•é‡ç´šï¼‰ï¼š
æƒ³é©—è­‰ Tx #2 æ˜¯å¦åœ¨å€å¡Šä¸­ï¼š
1. åªéœ€è¦ï¼šHash(Tx2), Hash(Tx3), Hash(0-1), Root Hash
2. è¨ˆç®—ï¼šHash(2-3) = Hash(Hash(Tx2) + Hash(Tx3))
3. è¨ˆç®—ï¼šRoot = Hash(Hash(0-1) + Hash(2-3))
4. å°æ¯”è¨ˆç®—å‡ºçš„ Root èˆ‡å€å¡Šé ­ä¸­çš„ Root
5. ç›¸åŒ â†’ äº¤æ˜“ç¢ºå¯¦å­˜åœ¨ âœ“

å„ªé»ï¼š
âœ“ é©—è­‰åªéœ€ O(log n) å€‹ hash
âœ“ ä¸éœ€è¦ä¸‹è¼‰æ‰€æœ‰äº¤æ˜“
âœ“ æ”¯æŒè¼•å®¢æˆ¶ç«¯
</code></pre>
<hr />
<h2 id="3-transaction-hash-èˆ‡-block-number"><a class="header" href="#3-transaction-hash-èˆ‡-block-number">3. Transaction Hash èˆ‡ Block Number</a></h2>
<h3 id="31-transaction-hash-ç”Ÿæˆéç¨‹"><a class="header" href="#31-transaction-hash-ç”Ÿæˆéç¨‹">3.1 Transaction Hash ç”Ÿæˆéç¨‹</a></h3>
<p>Transaction Hash æ˜¯äº¤æ˜“çš„å”¯ä¸€æ¨™è­˜ç¬¦ï¼Œé€šéåŠ å¯†å“ˆå¸Œå‡½æ•¸ç”Ÿæˆã€‚</p>
<pre><code class="language-javascript">// ===== å®Œæ•´çš„äº¤æ˜“ Hash ç”Ÿæˆéç¨‹ =====

// æ­¥é©Ÿ 1: æ§‹å»ºäº¤æ˜“å°è±¡
const transaction = {
  nonce: 5,                                    // äº¤æ˜“åºè™Ÿ
  gasPrice: '50000000000',                     // 50 Gwei
  gasLimit: 21000,                             // Gas ä¸Šé™
  to: '0x742d35Cc6634C0532925a3b844Bc454e4438f44e',
  value: '1000000000000000000',                // 1 ETH (wei)
  data: '0x',                                  // ç©ºæ•¸æ“š
  v: 27,                                       // ç°½ååƒæ•¸
  r: '0x1234567890abcdef...',                  // ç°½ååƒæ•¸ r
  s: '0xfedcba0987654321...'                   // ç°½ååƒæ•¸ s
}

// æ­¥é©Ÿ 2: RLP ç·¨ç¢¼ï¼ˆRecursive Length Prefixï¼‰
const rlpEncoded = RLP.encode([
  transaction.nonce,
  transaction.gasPrice,
  transaction.gasLimit,
  transaction.to,
  transaction.value,
  transaction.data,
  transaction.v,
  transaction.r,
  transaction.s
])

// æ­¥é©Ÿ 3: Keccak-256 å“ˆå¸Œ
const txHash = keccak256(rlpEncoded)

// çµæœ
console.log(txHash)
// è¼¸å‡º: 0xabc123def456789abc123def456789abc123def456789abc123def456789abc1

// ===== Transaction Hash çš„ç‰¹æ€§ =====

ç‰¹æ€§ 1: å”¯ä¸€æ€§
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ¯ç­†äº¤æ˜“éƒ½æœ‰ç¨ä¸€ç„¡äºŒçš„ Hash
å°±åƒèº«åˆ†è­‰è™Ÿç¢¼ï¼Œä¸æœƒé‡è¤‡

ç¯„ä¾‹ï¼š
Tx 1: 0xa1b2c3... (Alice è½‰ 1 ETH çµ¦ Bobï¼Œnonce=5)
Tx 2: 0xd4e5f6... (Alice è½‰ 1 ETH çµ¦ Bobï¼Œnonce=6)
å³ä½¿é‡‘é¡ã€æ”¶æ¬¾äººç›¸åŒï¼Œnonce ä¸åŒ â†’ Hash ä¸åŒ


ç‰¹æ€§ 2: ä¸å¯ç¯¡æ”¹
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ä»»ä½•åƒæ•¸æ”¹è®Š â†’ Hash å®Œå…¨ä¸åŒ

åŸå§‹: nonce=5, value=1 ETH
Hash: 0xa1b2c3d4e5f6...

ç¯¡æ”¹: nonce=5, value=2 ETH  â† åªæ”¹ä¸€å€‹æ•¸å­—
Hash: 0x9z8y7x6w5v4u...    â† Hash å®Œå…¨ä¸åŒï¼


ç‰¹æ€§ 3: å–®å‘æ€§
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Hash â†’ âœ“ å¯ä»¥é©—è­‰äº¤æ˜“
Hash â†’ âœ— ç„¡æ³•åæ¨å‡ºåŸå§‹æ•¸æ“š

å·²çŸ¥ Hash: 0xa1b2c3...
èƒ½åš: é©—è­‰é€™ç­†äº¤æ˜“æ˜¯å¦è¢«ç¯¡æ”¹
ä¸èƒ½åš: å¾ Hash åæ¨å‡ºè½‰äº†å¤šå°‘éŒ¢


ç‰¹æ€§ 4: é˜²ç¢°æ’
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
2^256 ç¨®å¯èƒ½ = å¹¾ä¹ä¸å¯èƒ½æœ‰å…©ç­†ä¸åŒäº¤æ˜“ç”¢ç”Ÿç›¸åŒ Hash

é€™å€‹æ•¸å­—æœ‰å¤šå¤§ï¼Ÿ
115,792,089,237,316,195,423,570,985,008,687,907,853,
269,984,665,640,564,039,457,584,007,913,129,639,936

æ¯”å®‡å®™ä¸­çš„åŸå­æ•¸é‡é‚„è¦å¤šï¼
</code></pre>
<h3 id="32-transaction-hash-æ‡‰ç”¨å ´æ™¯"><a class="header" href="#32-transaction-hash-æ‡‰ç”¨å ´æ™¯">3.2 Transaction Hash æ‡‰ç”¨å ´æ™¯</a></h3>
<pre><code class="language-javascript">// ===== å ´æ™¯ 1: äº¤æ˜“è¿½è¹¤ç³»çµ± =====
class TransactionTracker {
  async trackTransaction(txHash) {
    // 1. æŸ¥è©¢äº¤æ˜“ç‹€æ…‹
    const receipt = await web3.eth.getTransactionReceipt(txHash)
    
    if (!receipt) {
      return {
        status: 'PENDING',
        message: 'äº¤æ˜“åœ¨ Mempool ä¸­ï¼Œç­‰å¾…è¢«æ‰“åŒ…',
        estimatedTime: 'é è¨ˆ 12-30 ç§’'
      }
    }
    
    // 2. è¨ˆç®—ç¢ºèªæ•¸
    const currentBlock = await web3.eth.getBlockNumber()
    const confirmations = currentBlock - receipt.blockNumber
    
    // 3. è©•ä¼°å®‰å…¨ç­‰ç´š
    let riskLevel, recommendation
    if (confirmations === 0) {
      riskLevel = 'VERY_HIGH'
      recommendation = 'å‰›è¢«æ‰“åŒ…ï¼Œæ¥µæ˜“è¢«é‡çµ„'
    } else if (confirmations &lt; 6) {
      riskLevel = 'HIGH'
      recommendation = `å·²ç¢ºèª ${confirmations} æ¬¡ï¼Œå»ºè­°ç­‰å¾…æ›´å¤šç¢ºèª`
    } else if (confirmations &lt; 12) {
      riskLevel = 'MEDIUM'
      recommendation = 'ä¸­ç­‰å®‰å…¨ï¼Œå¤§å¤šæ•¸å ´æ™¯å¯æ¥å—'
    } else {
      riskLevel = 'LOW'
      recommendation = 'é«˜åº¦å®‰å…¨ï¼Œå¹¾ä¹ä¸å¯èƒ½è¢«é‡çµ„'
    }
    
    return {
      status: receipt.status ? 'SUCCESS' : 'FAILED',
      blockNumber: receipt.blockNumber,
      confirmations: confirmations,
      riskLevel: riskLevel,
      recommendation: recommendation,
      gasUsed: receipt.gasUsed,
      effectiveGasPrice: receipt.effectiveGasPrice,
      totalCost: (receipt.gasUsed * receipt.effectiveGasPrice) / 1e18,
      logs: receipt.logs,
      timestamp: await this.getBlockTimestamp(receipt.blockNumber)
    }
  }
  
  async getBlockTimestamp(blockNumber) {
    const block = await web3.eth.getBlock(blockNumber)
    return new Date(block.timestamp * 1000).toISOString()
  }
  
  // å¯¦æ™‚ç›£è½äº¤æ˜“ç‹€æ…‹è®ŠåŒ–
  watchTransaction(txHash, callback) {
    const interval = setInterval(async () =&gt; {
      const status = await this.trackTransaction(txHash)
      callback(status)
      
      // å¦‚æœäº¤æ˜“å·²ç¢ºèªæˆ–å¤±æ•—ï¼Œåœæ­¢ç›£è½
      if (status.status !== 'PENDING') {
        clearInterval(interval)
      }
    }, 3000) // æ¯ 3 ç§’æª¢æŸ¥ä¸€æ¬¡
    
    return interval // è¿”å› interval ID ä»¥ä¾¿å–æ¶ˆ
  }
}

// ä½¿ç”¨ç¯„ä¾‹
const tracker = new TransactionTracker()

// æ–¹å¼ 1: ä¸€æ¬¡æ€§æŸ¥è©¢
const status = await tracker.trackTransaction('0xabc123...')
console.log(status)

// æ–¹å¼ 2: å¯¦æ™‚ç›£è½
tracker.watchTransaction('0xabc123...', (status) =&gt; {
  console.log('äº¤æ˜“ç‹€æ…‹æ›´æ–°:', status)
  if (status.status === 'SUCCESS') {
    console.log('âœ“ äº¤æ˜“æˆåŠŸï¼')
  }
})


// ===== å ´æ™¯ 2: äº¤æ˜“è­‰æ˜ç”Ÿæˆå™¨ =====
class TransactionProofGenerator {
  async generateProof(txHash) {
    const receipt = await web3.eth.getTransactionReceipt(txHash)
    if (!receipt) {
      throw new Error('äº¤æ˜“æœªæ‰¾åˆ°æˆ–æœªç¢ºèª')
    }
    
    const tx = await web3.eth.getTransaction(txHash)
    const block = await web3.eth.getBlock(receipt.blockNumber)
    const currentBlock = await web3.eth.getBlockNumber()
    
    return {
      // äº¤æ˜“åŸºæœ¬ä¿¡æ¯
      transactionHash: txHash,
      from: receipt.from,
      to: receipt.to,
      value: web3.utils.fromWei(tx.value, 'ether') + ' ETH',
      
      // å€å¡Šä¿¡æ¯
      blockNumber: receipt.blockNumber,
      blockHash: block.hash,
      blockTimestamp: new Date(block.timestamp * 1000).toISOString(),
      
      // ç¢ºèªä¿¡æ¯
      confirmations: currentBlock - receipt.blockNumber,
      
      // Gas ä¿¡æ¯
      gasUsed: receipt.gasUsed,
      gasPrice: web3.utils.fromWei(tx.gasPrice, 'gwei') + ' Gwei',
      totalFee: web3.utils.fromWei(
        (receipt.gasUsed * tx.gasPrice).toString(), 
        'ether'
      ) + ' ETH',
      
      // é©—è­‰éˆæ¥
      etherscanLink: `https://etherscan.io/tx/${txHash}`,
      
      // è­‰æ˜è²æ˜
      proof: `
        â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
        â•‘            å€å¡Šéˆäº¤æ˜“è­‰æ˜ (Blockchain Proof)          â•‘
        â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
        â•‘                                                       â•‘
        â•‘  æ­¤äº¤æ˜“å·²è¢«æ°¸ä¹…è¨˜éŒ„åœ¨ä»¥å¤ªåŠå€å¡Šéˆä¸Š                    â•‘
        â•‘                                                       â•‘
        â•‘  äº¤æ˜“ Hash: ${txHash.slice(0, 20)}...                 â•‘
        â•‘  å€å¡Šç·¨è™Ÿ: #${receipt.blockNumber}                    â•‘
        â•‘  å€å¡Š Hash: ${block.hash.slice(0, 20)}...             â•‘
        â•‘  æ™‚é–“: ${new Date(block.timestamp * 1000).toISOString()}  â•‘
        â•‘                                                       â•‘
        â•‘  ä»»ä½•äººéƒ½å¯ä»¥åœ¨å€å¡Šéˆç€è¦½å™¨ä¸Šé©—è­‰æ­¤ä¿¡æ¯ï¼š              â•‘
        â•‘  ${`https://etherscan.io/tx/${txHash}`}               â•‘
        â•‘                                                       â•‘
        â•‘  å€å¡Šéˆä¿è­‰ï¼š                                          â•‘
        â•‘  âœ“ é€™ç­†äº¤æ˜“å·²è¢«æ°¸ä¹…è¨˜éŒ„                               â•‘
        â•‘  âœ“ äº¤æ˜“å…§å®¹ç„¡æ³•è¢«ç¯¡æ”¹                                 â•‘
        â•‘  âœ“ ä»»ä½•äººéƒ½å¯ä»¥é©—è­‰                                   â•‘
        â•‘  âœ“ å·²ç²å¾— ${currentBlock - receipt.blockNumber} å€‹ç¢ºèª  â•‘
        â•‘                                                       â•‘
        â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      `
    }
  }
}


// ===== å ´æ™¯ 3: äº¤æ˜“åŠ é€Ÿ (Replace-by-Fee) =====
class TransactionAccelerator {
  async speedUpTransaction(originalTxHash, increaseFactor = 1.2) {
    // 1. ç²å–åŸå§‹äº¤æ˜“
    const originalTx = await web3.eth.getTransaction(originalTxHash)
    
    if (!originalTx) {
      throw new Error('äº¤æ˜“ä¸å­˜åœ¨')
    }
    
    // 2. æª¢æŸ¥æ˜¯å¦å·²ç¢ºèª
    const receipt = await web3.eth.getTransactionReceipt(originalTxHash)
    if (receipt &amp;&amp; receipt.blockNumber) {
      throw new Error('äº¤æ˜“å·²ç¢ºèªï¼Œç„¡æ³•åŠ é€Ÿ')
    }
    
    // 3. æ§‹å»ºæ–°äº¤æ˜“ï¼ˆç›¸åŒ nonceï¼Œæ›´é«˜ gas priceï¼‰
    const newTx = {
      from: originalTx.from,
      to: originalTx.to,
      value: originalTx.value,
      data: originalTx.data,
      nonce: originalTx.nonce,  // â† ç›¸åŒ nonceï¼
      gas: originalTx.gas
    }
    
    // 4. æé«˜ Gas Price
    if (originalTx.maxFeePerGas) {
      // EIP-1559 äº¤æ˜“
      newTx.maxFeePerGas = BigInt(originalTx.maxFeePerGas) * 
                           BigInt(Math.floor(increaseFactor * 100)) / 100n
      newTx.maxPriorityFeePerGas = BigInt(originalTx.maxPriorityFeePerGas) * 
                                   BigInt(Math.floor(increaseFactor * 150)) / 100n
    } else {
      // Legacy äº¤æ˜“
      newTx.gasPrice = BigInt(originalTx.gasPrice) * 
                       BigInt(Math.floor(increaseFactor * 100)) / 100n
    }
    
    // 5. ç™¼é€æ–°äº¤æ˜“
    const newTxHash = await web3.eth.sendTransaction(newTx)
    
    return {
      originalTxHash: originalTxHash,
      newTxHash: newTxHash,
      message: 'åŠ é€Ÿäº¤æ˜“å·²ç™¼é€',
      note: 'å…©å€‹äº¤æ˜“åªæœƒæœ‰ä¸€å€‹è¢«ç¢ºèªï¼ˆGas Price æ›´é«˜çš„å„ªå…ˆï¼‰',
      gasPriceIncrease: `${((increaseFactor - 1) * 100).toFixed(0)}%`
    }
  }
  
  async cancelTransaction(originalTxHash, gasPriceMultiplier = 1.5) {
    const originalTx = await web3.eth.getTransaction(originalTxHash)
    
    // ç™¼é€ 0 ETH çµ¦è‡ªå·±ï¼Œä½†ä½¿ç”¨ç›¸åŒ nonce å’Œæ›´é«˜ gas price
    const cancelTx = {
      from: originalTx.from,
      to: originalTx.from,      // â† ç™¼é€çµ¦è‡ªå·±
      value: '0x0',              // â† 0 ETH
      nonce: originalTx.nonce,   // â† ç›¸åŒ nonce
      gas: 21000                 // æœ€å° gas
    }
    
    if (originalTx.maxFeePerGas) {
      cancelTx.maxFeePerGas = BigInt(originalTx.maxFeePerGas) * 
                              BigInt(Math.floor(gasPriceMultiplier * 100)) / 100n
      cancelTx.maxPriorityFeePerGas = BigInt(originalTx.maxPriorityFeePerGas) * 
                                      BigInt(Math.floor(gasPriceMultiplier * 100)) / 100n
    } else {
      cancelTx.gasPrice = BigInt(originalTx.gasPrice) * 
                          BigInt(Math.floor(gasPriceMultiplier * 100)) / 100n
    }
    
    const cancelTxHash = await web3.eth.sendTransaction(cancelTx)
    
    return {
      originalTxHash: originalTxHash,
      cancelTxHash: cancelTxHash,
      message: 'å–æ¶ˆäº¤æ˜“å·²ç™¼é€',
      note: 'å¦‚æœå–æ¶ˆäº¤æ˜“å…ˆè¢«ç¢ºèªï¼ŒåŸäº¤æ˜“æœƒå¤±æ•—'
    }
  }
}
</code></pre>
<h3 id="33-block-number-æ·±åº¦æ‡‰ç”¨"><a class="header" href="#33-block-number-æ·±åº¦æ‡‰ç”¨">3.3 Block Number æ·±åº¦æ‡‰ç”¨</a></h3>
<pre><code class="language-javascript">// ===== Block Number çš„é—œéµä½œç”¨ =====

/* 
Block Number æ˜¯å€å¡Šåœ¨éˆä¸Šçš„ä½ç½®ç·¨è™Ÿ
å¾å‰µä¸–å€å¡Š (Block #0) é–‹å§‹éå¢
æ¯å€‹æ–°å€å¡Šçš„ç·¨è™Ÿ = å‰ä¸€å€‹å€å¡Šç·¨è™Ÿ + 1
*/

// ===== æ‡‰ç”¨ 1: ç¢ºèªæ•¸ç­–ç•¥ =====
const CONFIRMATION_REQUIREMENTS = {
  // ä¸åŒå ´æ™¯çš„ç¢ºèªæ•¸è¦æ±‚
  
  MICRO_PAYMENT: 1,        // å°é¡æ”¯ä»˜ï¼š~12 ç§’
  // é¢¨éšªï¼šä½é¡æå¤±å¯æ¥å—
  // é©ç”¨ï¼šå’–å•¡åº—ã€å°é¡è½‰å¸³
  
  STANDARD: 6,             // æ¨™æº–äº¤æ˜“ï¼š~72 ç§’ (1.2 åˆ†é˜)
  // é¢¨éšªï¼šéå¸¸ä½
  // é©ç”¨ï¼šä¸€èˆ¬é›»å•†ã€æœå‹™ä»˜æ¬¾
  
  EXCHANGE_DEPOSIT: 12,    // äº¤æ˜“æ‰€å……å€¼ï¼š~144 ç§’ (2.4 åˆ†é˜)
  // é¢¨éšªï¼šæ¥µä½
  // é©ç”¨ï¼šä¸­å¿ƒåŒ–äº¤æ˜“æ‰€å…¥é‡‘
  
  LARGE_AMOUNT: 30,        // å¤§é¡äº¤æ˜“ï¼š~360 ç§’ (6 åˆ†é˜)
  // é¢¨éšªï¼šå¹¾ä¹ç‚ºé›¶
  // é©ç”¨ï¼šæˆ¿ç”¢äº¤æ˜“ã€å¤§é¡è½‰å¸³
  
  BRIDGE_TRANSFER: 64,     // è·¨éˆæ©‹ï¼š~768 ç§’ (12.8 åˆ†é˜)
  // é¢¨éšªï¼šå¿…é ˆçµ•å°å®‰å…¨
  // é©ç”¨ï¼šLayer 2 æ©‹æ¥ã€è·¨éˆè³‡ç”¢è½‰ç§»
  
  BITCOIN: 6               // æ¯”ç‰¹å¹£ï¼š~60 åˆ†é˜
  // æ¯”ç‰¹å¹£å‡ºå¡Šæ…¢ï¼Œä½† 6 å€‹ç¢ºèªå·²è¶³å¤ å®‰å…¨
}

class ConfirmationManager {
  async waitForConfirmations(txHash, requiredConfirmations, onProgress) {
    return new Promise((resolve, reject) =&gt; {
      const checkInterval = setInterval(async () =&gt; {
        try {
          const receipt = await web3.eth.getTransactionReceipt(txHash)
          
          if (!receipt) {
            // äº¤æ˜“é‚„åœ¨ pending
            onProgress?.({
              status: 'PENDING',
              confirmations: 0,
              required: requiredConfirmations
            })
            return
          }
          
          const currentBlock = await web3.eth.getBlockNumber()
          const confirmations = currentBlock - receipt.blockNumber
          
          console.log(`ç¢ºèªé€²åº¦: ${confirmations}/${requiredConfirmations}`)
          
          onProgress?.({
            status: 'CONFIRMING',
            confirmations: confirmations,
            required: requiredConfirmations,
            percentage: Math.min(100, (confirmations / requiredConfirmations) * 100)
          })
          
          if (confirmations &gt;= requiredConfirmations) {
            clearInterval(checkInterval)
            resolve({
              confirmed: true,
              finalConfirmations: confirmations,
              blockNumber: receipt.blockNumber,
              safetyLevel: this.getSafetyLevel(confirmations)
            })
          }
        } catch (error) {
          clearInterval(checkInterval)
          reject(error)
        }
      }, 3000) // æ¯ 3 ç§’æª¢æŸ¥ä¸€æ¬¡
    })
  }
  
  getSafetyLevel(confirmations) {
    if (confirmations &lt; 1) return 'NONE'
    if (confirmations &lt; 6) return 'LOW'
    if (confirmations &lt; 12) return 'MEDIUM'
    if (confirmations &lt; 30) return 'HIGH'
    return 'VERY_HIGH'
  }
}

// ä½¿ç”¨ç¯„ä¾‹
const manager = new ConfirmationManager()

await manager.waitForConfirmations('0xabc123...', 12, (progress) =&gt; {
  console.log(`${progress.percentage.toFixed(0)}% å®Œæˆ`)
})


// ===== æ‡‰ç”¨ 2: æ­·å²æ•¸æ“šæŸ¥è©¢ =====
class HistoricalDataQuery {
  async getBalanceAtBlock(address, blockNumber) {
    // æŸ¥è©¢æŸå€‹åœ°å€åœ¨ç‰¹å®šå€å¡Šçš„é¤˜é¡
    const balance = await web3.eth.getBalance(address, blockNumber)
    const block = await web3.eth.getBlock(blockNumber)
    
    return {
      address: address,
      balance: web3.utils.fromWei(balance, 'ether'),
      blockNumber: blockNumber,
      timestamp: new Date(block.timestamp * 1000).toISOString(),
      blockHash: block.hash
    }
  }
  
  async getBalanceHistory(address, fromBlock, toBlock, interval = 1000) {
    const history = []
    
    for (let block = fromBlock; block &lt;= toBlock; block += interval) {
      const data = await this.getBalanceAtBlock(address, block)
      history.push(data)
    }
    
    return history
  }
  
  // ç¯„ä¾‹ï¼šæŸ¥è©¢ 1 å¹´å‰çš„é¤˜é¡
  async getBalanceOneYearAgo(address) {
    const blocksPerYear = Math.floor(365 * 24 * 60 * 60 / 12) // ~2,628,000 å€å¡Š
    const currentBlock = await web3.eth.getBlockNumber()
    const targetBlock = currentBlock - blocksPerYear
    
    return await this.getBalanceAtBlock(address, targetBlock)
  }
  
  // è¨ˆç®—å¹³å‡æŒæœ‰æ™‚é–“
  async calculateAverageHoldingPeriod(address, tokenContract) {
    const transferEvents = await tokenContract.getPastEvents('Transfer', {
      filter: { to: address },
      fromBlock: 0,
      toBlock: 'latest'
    })
    
    let totalHoldingTime = 0
    let count = 0
    
    for (let i = 0; i &lt; transferEvents.length - 1; i++) {
      const currentBlock = transferEvents[i].blockNumber
      const nextBlock = transferEvents[i + 1].blockNumber
      const holdingPeriod = nextBlock - currentBlock
      
      totalHoldingTime += holdingPeriod
      count++
    }
    
    const avgBlocks = totalHoldingTime / count
    const avgSeconds = avgBlocks * 12 // ä»¥å¤ªåŠ ~12 ç§’/å€å¡Š
    const avgDays = avgSeconds / (24 * 60 * 60)
    
    return {
      averageBlocks: avgBlocks,
      averageDays: avgDays.toFixed(2),
      totalTransfers: transferEvents.length
    }
  }
}


// ===== æ‡‰ç”¨ 3: äº‹ä»¶æŸ¥è©¢èˆ‡åˆ†æ =====
class EventAnalyzer {
  async getEventsInRange(contractAddress, eventName, fromBlock, toBlock) {
    const contract = new web3.eth.Contract(ABI, contractAddress)
    
    const events = await contract.getPastEvents(eventName, {
      fromBlock: fromBlock,
      toBlock: toBlock
    })
    
    // ç‚ºæ¯å€‹äº‹ä»¶æ·»åŠ æ™‚é–“æˆ³
    const eventsWithTime = await Promise.all(
      events.map(async (event) =&gt; {
        const block = await web3.eth.getBlock(event.blockNumber)
        return {
          ...event,
          timestamp: new Date(block.timestamp * 1000).toISOString(),
          confirmations: await web3.eth.getBlockNumber() - event.blockNumber
        }
      })
    )
    
    return eventsWithTime
  }
  
  // ç¯„ä¾‹ï¼šåˆ†ææœ€è¿‘ 1000 å€‹å€å¡Šçš„ Transfer äº‹ä»¶
  async analyzeRecentTransfers(tokenAddress) {
    const currentBlock = await web3.eth.getBlockNumber()
    const fromBlock = currentBlock - 1000
    
    const transfers = await this.getEventsInRange(
      tokenAddress,
      'Transfer',
      fromBlock,
      currentBlock
    )
    
    // çµ±è¨ˆåˆ†æ
    const totalVolume = transfers.reduce((sum, t) =&gt; 
      sum + BigInt(t.returnValues.value), 0n
    )
    
    const uniqueSenders = new Set(transfers.map(t =&gt; t.returnValues.from))
    const uniqueReceivers = new Set(transfers.map(t =&gt; t.returnValues.to))
    
    return {
      totalTransfers: transfers.length,
      totalVolume: web3.utils.fromWei(totalVolume.toString(), 'ether'),
      uniqueSenders: uniqueSenders.size,
      uniqueReceivers: uniqueReceivers.size,
      avgTransferSize: web3.utils.fromWei(
        (totalVolume / BigInt(transfers.length)).toString(),
        'ether'
      ),
      blockRange: {
        from: fromBlock,
        to: currentBlock,
        span: 1000
      }
    }
  }
}


// ===== æ‡‰ç”¨ 4: æ™‚é–“èˆ‡å€å¡Šäº’ç›¸è½‰æ› =====
class BlockTimeEstimator {
  constructor() {
    this.averageBlockTime = 12 // ä»¥å¤ªåŠå¹³å‡ 12 ç§’/å€å¡Š
  }
  
  // å¾å€å¡Šä¼°ç®—æ™‚é–“
  async estimateTime(targetBlock) {
    const currentBlock = await web3.eth.getBlockNumber()
    const blockDiff = targetBlock - currentBlock
    
    if (blockDiff &lt;= 0) {
      // ç›®æ¨™å€å¡Šåœ¨éå»
      const block = await web3.eth.getBlock(targetBlock)
      return {
        status: 'PAST',
        blockNumber: targetBlock,
        actualTime: new Date(block.timestamp * 1000).toISOString(),
        message: 'ç›®æ¨™å€å¡Šå·²ç¶“ç”¢ç”Ÿ'
      }
    }
    
    // ç›®æ¨™å€å¡Šåœ¨æœªä¾†
    const secondsRemaining = blockDiff * this.averageBlockTime
    const minutesRemaining = Math.floor(secondsRemaining / 60)
    const hoursRemaining = Math.floor(minutesRemaining / 60)
    const daysRemaining = Math.floor(hoursRemaining / 24)
    
    const estimatedDate = new Date(Date.now() + secondsRemaining * 1000)
    
    let timeString
    if (daysRemaining &gt; 0) {
      timeString = `ç´„ ${daysRemaining} å¤© ${hoursRemaining % 24} å°æ™‚`
    } else if (hoursRemaining &gt; 0) {
      timeString = `ç´„ ${hoursRemaining} å°æ™‚ ${minutesRemaining % 60} åˆ†é˜`
    } else {
      timeString = `ç´„ ${minutesRemaining} åˆ†é˜`
    }
    
    return {
      status: 'FUTURE',
      currentBlock: currentBlock,
      targetBlock: targetBlock,
      blocksRemaining: blockDiff,
      secondsRemaining: secondsRemaining,
      estimatedTime: timeString,
      estimatedDate: estimatedDate.toISOString()
    }
  }
  
  // å¾æ™‚é–“ä¼°ç®—å€å¡Š
  async estimateBlock(targetDate) {
    const now = Date.now()
    const target = new Date(targetDate).getTime()
    const secondsDiff = Math.floor((target - now) / 1000)
    const blocksDiff = Math.floor(secondsDiff / this.averageBlockTime)
    
    const currentBlock = await web3.eth.getBlockNumber()
    const estimatedBlock = currentBlock + blocksDiff
    
    return {
      targetDate: targetDate,
      currentBlock: currentBlock,
      estimatedBlock: estimatedBlock,
      blockDifference: blocksDiff,
      note: blocksDiff &lt; 0 ? 'ç›®æ¨™æ™‚é–“åœ¨éå»' : 'ç›®æ¨™æ™‚é–“åœ¨æœªä¾†'
    }
  }
  
  // è¨ˆç®—å…©å€‹å€å¡Šä¹‹é–“çš„å¯¦éš›æ™‚é–“
  async getActualTimeBetweenBlocks(fromBlock, toBlock) {
    const fromBlockData = await web3.eth.getBlock(fromBlock)
    const toBlockData = await web3.eth.getBlock(toBlock)
    
    const timeDiff = toBlockData.timestamp - fromBlockData.timestamp
    const blockDiff = toBlock - fromBlock
    const actualAvgBlockTime = timeDiff / blockDiff
    
    return {
      fromBlock: fromBlock,
      toBlock: toBlock,
      blockDifference: blockDiff,
      timeDifference: timeDiff + ' ç§’',
      actualAverageBlockTime: actualAvgBlockTime.toFixed(2) + ' ç§’',
      fromTimestamp: new Date(fromBlockData.timestamp * 1000).toISOString(),
      toTimestamp: new Date(toBlockData.timestamp * 1000).toISOString()
    }
  }
}

// ä½¿ç”¨ç¯„ä¾‹
const estimator = new BlockTimeEstimator()

// æŸ¥è©¢æœªä¾†å€å¡Šçš„æ™‚é–“
const future = await estimator.estimateTime(18600000)
console.log(future)
// è¼¸å‡ºï¼šç´„ 3 å¤© 5 å°æ™‚å¾Œï¼Œé è¨ˆ 2024-01-15 15:30:00

// æŸ¥è©¢æŸå€‹æ™‚é–“çš„å€å¡Š
const block = await estimator.estimateBlock('2024-01-01 00:00:00')
console.log(block)
// è¼¸å‡ºï¼šé è¨ˆå€å¡Š #18523456
</code></pre>
<h3 id="34-éˆé‡çµ„-chain-reorganization"><a class="header" href="#34-éˆé‡çµ„-chain-reorganization">3.4 éˆé‡çµ„ (Chain Reorganization)</a></h3>
<pre><code>â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                 ä»€éº¼æ˜¯éˆé‡çµ„ (Chain Reorg)?                    â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                â•‘
â•‘  æ­£å¸¸æƒ…æ³ï¼š                                                     â•‘
â•‘  Block #100 â†’ Block #101 â†’ Block #102 â†’ Block #103            â•‘
â•‘                                â†‘                              â•‘
â•‘                         ä½ çš„äº¤æ˜“åœ¨é€™è£¡                          â•‘
â•‘                                                                â•‘
â•‘  ç•°å¸¸æƒ…æ³ï¼šå…©å€‹ç¤¦å·¥/é©—è­‰è€…åŒæ™‚ç”¢ç”Ÿ Block #101                    â•‘
â•‘                                                                â•‘
â•‘  éˆ A (åŸæœ¬çš„ä¸»éˆ):                                             â•‘
â•‘  Block #100 â†’ Block #101A â†’ Block #102A â†’ Block #103A         â•‘
â•‘                  â†“             â†“                              â•‘
â•‘             ç¤¦å·¥ A ç”¢ç”Ÿ    ä½ çš„äº¤æ˜“åœ¨é€™å€‹å€å¡Š                    â•‘
â•‘                                                                â•‘
â•‘  éˆ B (ç«¶çˆ­éˆ):                                                 â•‘
â•‘  Block #100 â†’ Block #101B â†’ Block #102B â†’ Block #103B â†’ #104B â•‘
â•‘                  â†“                                    â†“        â•‘
â•‘             ç¤¦å·¥ B ç”¢ç”Ÿ                          éˆ B æ›´é•·ï¼    â•‘
â•‘                                                                â•‘
â•‘  çµæœï¼š                                                         â•‘
â•‘  â”œâ”€ ç¶²çµ¡é¸æ“‡æ›´é•·çš„éˆ B ä½œç‚ºä¸»éˆ                                  â•‘
â•‘  â”œâ”€ éˆ A è¢«æ”¾æ£„ï¼ˆæˆç‚º Uncle/Ommer å€å¡Šï¼‰                        â•‘
â•‘  â”œâ”€ ä½ çš„äº¤æ˜“å¾ Block #102A è¢«ã€Œæ¨ç¿»ã€                           â•‘
â•‘  â””â”€ ä½ çš„äº¤æ˜“éœ€è¦é‡æ–°æ‰“åŒ…åˆ°æ–°éˆçš„å€å¡Šä¸­                          â•‘
â•‘                                                                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

é˜²ç¯„æªæ–½ï¼š
âœ“ ç­‰å¾…è¶³å¤ çš„ç¢ºèªæ•¸
  - ä»¥å¤ªåŠï¼š6-12 å€‹ç¢ºèªï¼ˆ~1-2 åˆ†é˜ï¼‰
  - æ¯”ç‰¹å¹£ï¼š6 å€‹ç¢ºèªï¼ˆ~60 åˆ†é˜ï¼‰
  - å¤§é¡äº¤æ˜“ï¼š30+ å€‹ç¢ºèª

âœ“ ç›£è½å€å¡Šéˆé‡çµ„äº‹ä»¶
âœ“ ä½¿ç”¨ 'removed' äº‹ä»¶æª¢æ¸¬äº¤æ˜“è¢«æ’¤éŠ·
âœ“ å°é—œéµäº¤æ˜“é€²è¡Œå¤šæ¬¡ç¢ºèª

ä»£ç¢¼ç¤ºä¾‹ï¼š

// ç›£è½éˆé‡çµ„
web3.eth.subscribe('logs', {
  address: contractAddress
})
.on('data', (log) =&gt; {
  console.log('æ–°äº‹ä»¶:', log)
})
.on('changed', (log) =&gt; {
  // âš ï¸ æª¢æ¸¬åˆ°é‡çµ„ï¼é€™å€‹äº‹ä»¶è¢«æ’¤éŠ·äº†
  console.warn('âš ï¸ éˆé‡çµ„ï¼äº‹ä»¶è¢«æ’¤éŠ·:', log)
  
  // éœ€è¦ï¼š
  // 1. é€šçŸ¥ç”¨æˆ¶
  // 2. é‡æ–°æª¢æŸ¥äº¤æ˜“ç‹€æ…‹
  // 3. å¯èƒ½éœ€è¦é‡æ–°ç™¼é€äº¤æ˜“
})

// æª¢æŸ¥äº¤æ˜“æ˜¯å¦è¢«é‡çµ„
async function checkIfReorganized(txHash, originalBlockNumber) {
  const currentReceipt = await web3.eth.getTransactionReceipt(txHash)
  
  if (!currentReceipt) {
    return {
      reorganized: true,
      status: 'REMOVED',
      message: 'äº¤æ˜“å·²å¾å€å¡Šéˆä¸­ç§»é™¤'
    }
  }
  
  if (currentReceipt.blockNumber !== originalBlockNumber) {
    return {
      reorganized: true,
      status: 'MOVED',
      message: `äº¤æ˜“å¾å€å¡Š #${originalBlockNumber} ç§»å‹•åˆ° #${currentReceipt.blockNumber}`,
      oldBlock: originalBlockNumber,
      newBlock: currentReceipt.blockNumber
    }
  }
  
  return {
    reorganized: false,
    status: 'STABLE',
    message: 'äº¤æ˜“ç©©å®šï¼Œæœªè¢«é‡çµ„'
  }
}
</code></pre>
<hr />
<h2 id="4-å¤šå±¤èª¿ç”¨æ©Ÿåˆ¶"><a class="header" href="#4-å¤šå±¤èª¿ç”¨æ©Ÿåˆ¶">4. å¤šå±¤èª¿ç”¨æ©Ÿåˆ¶</a></h2>
<p>é€™æ˜¯ç™½æ¿ä¸Šè¨è«–çš„æ ¸å¿ƒæŠ€è¡“é»ä¹‹ä¸€ï¼</p>
<h3 id="41-å–®å±¤-vs-å¤šå±¤äº¤æ˜“å°æ¯”"><a class="header" href="#41-å–®å±¤-vs-å¤šå±¤äº¤æ˜“å°æ¯”">4.1 å–®å±¤ vs å¤šå±¤äº¤æ˜“å°æ¯”</a></h3>
<pre><code>â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  å ´æ™¯ 1: ç°¡å–®è½‰å¸³ï¼ˆå–®å±¤èª¿ç”¨ï¼‰                                   â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                â•‘
â•‘   ç”¨æˆ¶éŒ¢åŒ… (Alice)                                              â•‘
â•‘        â”‚                                                       â•‘
â•‘        â”‚ ç™¼é€äº¤æ˜“                                               â•‘
â•‘        â”‚ â”œâ”€ Transaction Hash: 0xabc123...                     â•‘
â•‘        â”‚ â”œâ”€ Block Number: #18,500,000                         â•‘
â•‘        â”‚ â”œâ”€ Gas: 21,000 (å›ºå®šï¼ŒETH è½‰å¸³æœ€ä½è¦æ±‚)                â•‘
â•‘        â”‚ â”œâ”€ ç”¨æˆ¶éœ€è¦ç°½åä¸€æ¬¡                                    â•‘
â•‘        â”‚ â””â”€ åªæœ‰ä¸€å±¤èª¿ç”¨                                        â•‘
â•‘        â†“                                                       â•‘
â•‘   æ¥æ”¶åœ°å€ (Bob)                                                â•‘
â•‘        â”‚                                                       â•‘
â•‘        âœ“ å®Œæˆï¼ç°¡å–®ç›´æ¥                                          â•‘
â•‘                                                                â•‘
â•‘   ç¸½çµï¼š                                                         â•‘
â•‘   - åªæ¶‰åŠ EOA ä¹‹é–“çš„è½‰å¸³                                        â•‘
â•‘   - ä¸èª¿ç”¨ä»»ä½•æ™ºèƒ½åˆç´„                                           â•‘
â•‘   - Gas æ¶ˆè€—å›ºå®šï¼ˆ21,000ï¼‰                                       â•‘
â•‘   - éŒ¢åŒ…è™•ç†èµ·ä¾†æœ€ç°¡å–®                                           â•‘
â•‘                                                                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  å ´æ™¯ 2: DeFi äº¤äº’ï¼ˆå¤šå±¤èª¿ç”¨ï¼‰- ç™½æ¿é‡é»ï¼                      â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                â•‘
â•‘  ã€ç¬¬ 1 å±¤ã€‘ç”¨æˆ¶éŒ¢åŒ… (Alice)                                    â•‘
â•‘  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘        â”‚                                                       â•‘
â•‘        â”‚ âœ“ éŒ¢åŒ…è¦è™•ç†çš„éƒ¨åˆ†ï¼š                                   â•‘
â•‘        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘        â”‚ â”‚ 1. ç°½åäº¤æ˜“ï¼ˆç”¨ç§é‘°ï¼‰                          â”‚   â•‘
â•‘        â”‚ â”‚ 2. ä¼°ç®— Gas: 200,000                          â”‚   â•‘
â•‘        â”‚ â”‚    â†‘ åŒ…å«æ‰€æœ‰å…§éƒ¨èª¿ç”¨çš„ Gasï¼                  â”‚   â•‘
â•‘        â”‚ â”‚ 3. è¨­ç½® Nonce: 127                            â”‚   â•‘
â•‘        â”‚ â”‚ 4. è¨­ç½® Gas Price: 30 Gwei                    â”‚   â•‘
â•‘        â”‚ â”‚ 5. å»£æ’­åˆ°ç¶²çµ¡                                  â”‚   â•‘
â•‘        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘        â”‚                                                       â•‘
â•‘        â”‚ Transaction Hash: 0xdef456...                        â•‘
â•‘        â”‚ Block Number: #18,500,000                            â•‘
â•‘        â”‚                                                       â•‘
â•‘        â†“                                                       â•‘
â•‘   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€           â•‘
â•‘                                                                â•‘
â•‘  ã€ç¬¬ 2 å±¤ã€‘Uniswap Router åˆç´„                                 â•‘
â•‘  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘        â”‚                                                       â•‘
â•‘        â”‚ âœ— è‡ªå‹•åŸ·è¡Œï¼Œç„¡éœ€ç”¨æˆ¶ä»‹å…¥ï¼š                             â•‘
â•‘        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘        â”‚ â”‚ - ä¸éœ€è¦é¡å¤–ç°½å                               â”‚   â•‘
â•‘        â”‚ â”‚ - ä¸éœ€è¦é¡å¤– Nonce                             â”‚   â•‘
â•‘        â”‚ â”‚ - Gas å¾ç¬¬ 1 å±¤æ‰£é™¤                            â”‚   â•‘
â•‘        â”‚ â”‚ - èª¿ç”¨é¡å‹: CALL                               â”‚   â•‘
â•‘        â”‚ â”‚ - msg.sender è®Šæˆ Alice åœ°å€                   â”‚   â•‘
â•‘        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘        â”‚                                                       â•‘
â•‘        â”‚ Router åˆç´„å…§éƒ¨é‚è¼¯:                                   â•‘
â•‘        â”‚ â”œâ”€ é©—è­‰åƒæ•¸                                           â•‘
â•‘        â”‚ â”œâ”€ è¨ˆç®—äº¤æ›æ•¸é‡                                        â•‘
â•‘        â”‚ â”œâ”€ æª¢æŸ¥æ»‘é»                                           â•‘
â•‘        â”‚ â””â”€ èª¿ç”¨ Pair åˆç´„ (é€²å…¥ç¬¬ 3 å±¤)                        â•‘
â•‘        â†“                                                       â•‘
â•‘   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€           â•‘
â•‘                                                                â•‘
â•‘  ã€ç¬¬ 3 å±¤ã€‘Uniswap Pair åˆç´„                                   â•‘
â•‘  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘        â”‚                                                       â•‘
â•‘        â”‚ âœ— ç¹¼çºŒè‡ªå‹•åŸ·è¡Œï¼š                                       â•‘
â•‘        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘        â”‚ â”‚ - è¨ˆç®—äº¤æ›æ¯”ç‡                                 â”‚   â•‘
â•‘        â”‚ â”‚ - æª¢æŸ¥æµå‹•æ€§                                   â”‚   â•‘
â•‘        â”‚ â”‚ - æ›´æ–°å„²å‚™é‡                                   â”‚   â•‘
â•‘        â”‚ â”‚ - æº–å‚™ token è½‰ç§»                              â”‚   â•‘
â•‘        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘        â†“                                                       â•‘
â•‘   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€           â•‘
â•‘                                                                â•‘
â•‘  ã€ç¬¬ 4 å±¤ã€‘Token A (USDT) åˆç´„                                 â•‘
â•‘  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘        â”‚                                                       â•‘
â•‘        â”‚ âœ— Token è½‰ç§»ï¼š                                        â•‘
â•‘        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘        â”‚ â”‚ ERC20.transfer()                              â”‚   â•‘
â•‘        â”‚ â”‚ â”œâ”€ from: Alice                                â”‚   â•‘
â•‘        â”‚ â”‚ â”œâ”€ to: Pair åˆç´„                              â”‚   â•‘
â•‘        â”‚ â”‚ â”œâ”€ amount: 100 USDT                          â”‚   â•‘
â•‘        â”‚ â”‚ â””â”€ emit Transfer äº‹ä»¶                         â”‚   â•‘
â•‘        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘        â†“                                                       â•‘
â•‘   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€           â•‘
â•‘                                                                â•‘
â•‘  ã€ç¬¬ 5 å±¤ã€‘Token B (WETH) åˆç´„                                 â•‘
â•‘  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘        â”‚                                                       â•‘
â•‘        â”‚ âœ— Token è½‰ç§»ï¼š                                        â•‘
â•‘        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘        â”‚ â”‚ ERC20.transfer()                              â”‚   â•‘
â•‘        â”‚ â”‚ â”œâ”€ from: Pair åˆç´„                            â”‚   â•‘
â•‘        â”‚ â”‚ â”œâ”€ to: Alice                                  â”‚   â•‘
â•‘        â”‚ â”‚ â”œâ”€ amount: 0.035 WETH                        â”‚   â•‘
â•‘        â”‚ â”‚ â””â”€ emit Transfer äº‹ä»¶                         â”‚   â•‘
â•‘        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘        â†“                                                       â•‘
â•‘   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€           â•‘
â•‘                                                                â•‘
â•‘   âœ“ å®Œæˆï¼å…¨éƒ¨æˆåŠŸ                                              â•‘
â•‘                                                                â•‘
â•‘  ã€ç™½æ¿é‡é»æé†’ã€‘                                                â•‘
â•‘  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘   âš ï¸ æ‰€æœ‰å±¤ç´šå…±äº«åŒä¸€å€‹ Transaction Hash                       â•‘
â•‘   âš ï¸ æ‰€æœ‰å±¤ç´šåœ¨åŒä¸€å€‹ Block Number                             â•‘
â•‘   âš ï¸ æ‰€æœ‰å±¤ç´šå…±äº«ç¬¬ 1 å±¤çš„ Gas Limit                           â•‘
â•‘   âš ï¸ ä»»ä½•ä¸€å±¤å¤±æ•—ï¼Œæ•´å€‹äº¤æ˜“å›æ»¾ï¼ˆåŸå­æ€§ï¼‰                        â•‘
â•‘   âš ï¸ éŒ¢åŒ…åªéœ€è¦è™•ç†ç¬¬ 1 å±¤ï¼                                    â•‘
â•‘   âš ï¸ ç¬¬ 2-5 å±¤å®Œå…¨è‡ªå‹•ï¼Œç„¡éœ€ç”¨æˆ¶å†æ¬¡æˆæ¬Š                        â•‘
â•‘                                                                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
</code></pre>
<h3 id="42-ç‚ºä»€éº¼éŒ¢åŒ…åªè™•ç†ç¬¬ä¸€å±¤ç™½æ¿æ ¸å¿ƒå•é¡Œ"><a class="header" href="#42-ç‚ºä»€éº¼éŒ¢åŒ…åªè™•ç†ç¬¬ä¸€å±¤ç™½æ¿æ ¸å¿ƒå•é¡Œ">4.2 ç‚ºä»€éº¼éŒ¢åŒ…åªè™•ç†ç¬¬ä¸€å±¤ï¼Ÿï¼ˆç™½æ¿æ ¸å¿ƒå•é¡Œï¼‰</a></h3>
<p>é€™æ˜¯ä½ åœ¨ç™½æ¿ä¸Šæåˆ°çš„é—œéµé»ï¼è®“æˆ‘è©³ç´°è§£é‡‹ï¼š</p>
<pre><code class="language-javascript">// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// åŸå›  1: ç°½åæˆæ¬Š - åªéœ€è¦ç°½åä¸€æ¬¡
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// éŒ¢åŒ…åªéœ€è¦ç°½åç¬¬ 1 å±¤äº¤æ˜“
const tx = {
  from: userAddress,              // ç¬¬ 1 å±¤ï¼šç”¨æˆ¶åœ°å€
  to: uniswapRouterAddress,       // ç¬¬ 1 å±¤ï¼šRouter åˆç´„åœ°å€
  data: encodedFunctionCall,      // ç¬¬ 1 å±¤ï¼šèª¿ç”¨æ•¸æ“š
  gas: 200000,                    // ç¬¬ 1 å±¤ï¼šGas Limitï¼ˆåŒ…å«æ‰€æœ‰å…§éƒ¨èª¿ç”¨ï¼‰
  gasPrice: web3.utils.toWei('30', 'gwei'),
  nonce: 127                      // ç¬¬ 1 å±¤ï¼šNonce
}

// ç”¨æˆ¶ç°½å
const signedTx = await web3.eth.accounts.signTransaction(tx, privateKey)

// âœ“ ç°½åå®Œæˆï¼

// ç¬¬ 2, 3, 4, 5 å±¤çš„èª¿ç”¨ï¼š
// âœ“ ä¸éœ€è¦ç”¨æˆ¶å†æ¬¡ç°½å
// âœ“ ä¸éœ€è¦ç”¨æˆ¶æˆæ¬Š
// âœ“ å®Œå…¨è‡ªå‹•åŸ·è¡Œ
// âœ“ ç”±æ™ºèƒ½åˆç´„å…§éƒ¨è™•ç†


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// åŸå›  2: Gas ç®¡ç† - ä¸€æ¬¡ä¼°ç®—ï¼Œå…¨éƒ¨åŒ…å«
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// éŒ¢åŒ…åªéœ€è¦ä¼°ç®—ä¸€æ¬¡ Gas
const gasEstimate = await uniswapRouter.methods
  .swapExactTokensForTokens(
    amountIn,
    amountOutMin,
    [tokenA, tokenB],
    userAddress,
    deadline
  )
  .estimateGas({from: userAddress})

// gasEstimate = 180,000
// 
// é€™å€‹æ•¸å­—å·²ç¶“åŒ…å«æ‰€æœ‰å±¤ç´šçš„ Gas æ¶ˆè€—ï¼š
// â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
// â”‚ Layer 1 - Router èª¿ç”¨:    30,000   â”‚
// â”‚ Layer 2 - Pair èª¿ç”¨:      50,000   â”‚
// â”‚ Layer 3 - Token A è½‰ç§»:   45,000   â”‚
// â”‚ Layer 4 - Token B è½‰ç§»:   45,000   â”‚
// â”‚ å…¶ä»–é–‹éŠ·:                  10,000   â”‚
// â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
// â”‚ ç¸½è¨ˆ:                    180,000   â”‚
// â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

// éŒ¢åŒ…åªéœ€è¦è¨­ç½®ä¸€æ¬¡ï¼š
tx.gas = Math.floor(gasEstimate * 1.2)  // åŠ  20% ç·©è¡ = 216,000

// âœ“ å®Œæˆï¼
// æ‰€æœ‰å…§éƒ¨èª¿ç”¨éƒ½å¾é€™å€‹ Gas Limit ä¸­æ‰£é™¤
// ä¸éœ€è¦ç‚ºæ¯ä¸€å±¤å–®ç¨è¨­ç½® Gas


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// åŸå›  3: Nonce ç®¡ç† - åªéœ€è¦ä¸€å€‹ Nonce
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// åªæœ‰ã€Œäº¤æ˜“ã€éœ€è¦ nonce
// å…§éƒ¨ã€Œèª¿ç”¨ã€ä¸éœ€è¦ nonce

const nonce = await web3.eth.getTransactionCount(userAddress)
tx.nonce = nonce  // åªè¨­ç½®ç¬¬ 1 å±¤

// ç‚ºä»€éº¼å…§éƒ¨èª¿ç”¨ä¸éœ€è¦ nonceï¼Ÿ
// 
// äº¤æ˜“ (Transaction):
// â”œâ”€ ç”± EOA ç™¼èµ·
// â”œâ”€ éœ€è¦ç°½å
// â”œâ”€ éœ€è¦ nonceï¼ˆé˜²æ­¢é‡æ”¾ï¼‰
// â””â”€ æ¶ˆè€— Gas
//
// èª¿ç”¨ (Call):
// â”œâ”€ ç”±åˆç´„ç™¼èµ·
// â”œâ”€ ä¸éœ€è¦ç°½åï¼ˆåˆç´„è‡ªå‹•åŸ·è¡Œï¼‰
// â”œâ”€ ä¸éœ€è¦ nonceï¼ˆåœ¨åŒä¸€å€‹äº¤æ˜“ä¸­ï¼‰
// â””â”€ Gas å¾äº¤æ˜“çš„ Gas Limit ä¸­æ‰£é™¤

// âœ“ ç¬¬ 2-5 å±¤éƒ½æ˜¯ã€Œèª¿ç”¨ã€ï¼Œä¸æ˜¯ã€Œäº¤æ˜“ã€
// âœ“ æ‰€ä»¥ä¸éœ€è¦ nonce


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// åŸå›  4: åŸå­æ€§ä¿è­‰ - å…¨éƒ¨æˆåŠŸæˆ–å…¨éƒ¨å¤±æ•—
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

try {
  const receipt = await web3.eth.sendTransaction(tx)
  
  // å¦‚æœåŸ·è¡Œåˆ°é€™è£¡ï¼Œè¡¨ç¤ºæ‰€æœ‰å±¤ç´šéƒ½æˆåŠŸäº†ï¼š
  console.log('âœ“ Layer 1: SUCCESS - Router èª¿ç”¨æˆåŠŸ')
  console.log('âœ“ Layer 2: SUCCESS - Pair èª¿ç”¨æˆåŠŸ')
  console.log('âœ“ Layer 3: SUCCESS - Token A è½‰ç§»æˆåŠŸ')
  console.log('âœ“ Layer 4: SUCCESS - Token B è½‰ç§»æˆåŠŸ')
  console.log('âœ“ Layer 5: SUCCESS - æ‰€æœ‰æ“ä½œå®Œæˆ')
  
  // ç”¨æˆ¶çš„è³‡ç”¢ç‹€æ…‹å·²æ›´æ–°ï¼š
  // - USDT æ¸›å°‘ 100
  // - WETH å¢åŠ  0.035
  
} catch (error) {
  // å¦‚æœä»»ä½•ä¸€å±¤å¤±æ•—ï¼Œæ•´å€‹äº¤æ˜“å›æ»¾
  
  // å‡è¨­ Layer 4 Token A é¤˜é¡ä¸è¶³ï¼š
  console.error('âœ— Transaction FAILED')
  console.log('Layer 1: å·²å›æ»¾')
  console.log('Layer 2: å·²å›æ»¾')
  console.log('Layer 3: å·²å›æ»¾')
  console.log('Layer 4: å¤±æ•— - Token A é¤˜é¡ä¸è¶³')
  
  // çµæœï¼š
  // âœ“ ç”¨æˆ¶çš„è³‡ç”¢ç‹€æ…‹å®Œå…¨æ¢å¾©åˆ°äº¤æ˜“å‰
  // âœ“ æ²’æœ‰ä»»ä½•è³‡ç”¢æå¤±
  // âœ— Gas è²»ç”¨å·²æ”¯ä»˜ï¼ˆç„¡æ³•é€€å›ï¼‰
}

// é€™å°±æ˜¯ã€ŒåŸå­æ€§ã€ï¼š
// è¦éº¼å…¨éƒ¨æˆåŠŸï¼Œè¦éº¼å…¨éƒ¨å¤±æ•—
// ä¸æœƒå‡ºç¾ã€Œéƒ¨åˆ†æˆåŠŸã€çš„æƒ…æ³


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// åŸå›  5: éŒ¯èª¤è¿½è¹¤ - å¾ç¬¬ä¸€å±¤é–‹å§‹èª¿è©¦
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

if (!receipt.status) {
  console.log('âš ï¸ äº¤æ˜“å¤±æ•—ï¼Œé–‹å§‹èª¿è©¦...')
  
  // æ–¹æ³• 1: é‡æ”¾äº¤æ˜“æŸ¥çœ‹éŒ¯èª¤è¨Šæ¯
  try {
    await web3.eth.call(originalTx, receipt.blockNumber)
  } catch (error) {
    // éŒ¯èª¤æœƒå¾å¤±æ•—çš„é‚£ä¸€å±¤ã€Œå†’æ³¡ã€åˆ°ç¬¬ 1 å±¤
    console.log('å¤±æ•—åŸå› :', error.message)
    
    // å¯èƒ½çš„éŒ¯èª¤è¨Šæ¯ï¼š
    // "UniswapV2: INSUFFICIENT_OUTPUT_AMOUNT" â† ç¬¬ 2 æˆ– 3 å±¤
    // "ERC20: transfer amount exceeds balance" â† ç¬¬ 4 å±¤
    // "ERC20: insufficient allowance" â† éœ€è¦å…ˆ approve
  }
  
  // æ–¹æ³• 2: ä½¿ç”¨ debug trace æŸ¥çœ‹æ¯ä¸€å±¤çš„åŸ·è¡Œæƒ…æ³
  const trace = await web3.debug.traceTransaction(txHash, {
    tracer: 'callTracer'
  })
  
  // trace è¼¸å‡ºç¤ºä¾‹ï¼š
  // {
  //   type: "CALL",
  //   from: "0xAlice...",
  //   to: "0xRouter...",
  //   gas: "0x30d40",
  //   gasUsed: "0x2ea84",
  //   input: "0x38ed1739...",
  //   output: "0x",
  //   calls: [
  //     {
  //       type: "CALL",
  //       from: "0xRouter...",
  //       to: "0xPair...",
  //       calls: [
  //         {
  //           type: "CALL",
  //           from: "0xPair...",
  //           to: "0xTokenA...",
  //           error: "revert"  â† åœ¨ç¬¬ 4 å±¤å¤±æ•—ï¼
  //         }
  //       ]
  //     }
  //   ]
  // }
  
  console.log('âœ“ æ‰¾åˆ°å•é¡Œï¼šç¬¬ 4 å±¤ Token A è½‰ç§»å¤±æ•—')
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ç¸½çµï¼šéŒ¢åŒ…åªè™•ç†ç¬¬ä¸€å±¤çš„å¥½è™•
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

/*
âœ“ ç°¡åŒ–ç”¨æˆ¶é«”é©—
  - ç”¨æˆ¶åªéœ€è¦ç¢ºèªå’Œç°½åä¸€æ¬¡
  - ä¸éœ€è¦ç†è§£è¤‡é›œçš„å…§éƒ¨èª¿ç”¨
  - UI é¡¯ç¤ºæ¸…æ™°ç°¡æ½”

âœ“ é™ä½é–‹ç™¼è¤‡é›œåº¦
  - éŒ¢åŒ…é–‹ç™¼è€…ä¸éœ€è¦è™•ç†å…§éƒ¨èª¿ç”¨
  - åªéœ€è¦é—œæ³¨ç¬¬ä¸€å±¤çš„åƒæ•¸
  - æ¸›å°‘å‡ºéŒ¯çš„å¯èƒ½æ€§

âœ“ ä¿è­‰å®‰å…¨æ€§
  - åŸå­æ€§ä¿è­‰è³‡ç”¢å®‰å…¨
  - å–®ä¸€ç°½åæ¸›å°‘é‡£é­šé¢¨éšª
  - æ¸…æ™°çš„æˆæ¬Šç¯„åœ

âœ“ æé«˜æ•ˆç‡
  - ä¸€æ¬¡æ€§ä¼°ç®—æ‰€æœ‰ Gas
  - ä¸€å€‹ nonce è™•ç†æ‰€æœ‰æ“ä½œ
  - æ‰¹é‡åŸ·è¡Œï¼Œç¯€çœæ™‚é–“

âœ“ ä¾¿æ–¼èª¿è©¦
  - å¾ç¬¬ä¸€å±¤å°±èƒ½çœ‹åˆ°æ‰€æœ‰ä¿¡æ¯
  - éŒ¯èª¤æœƒå†’æ³¡åˆ°é ‚å±¤
  - å®¹æ˜“å®šä½å•é¡Œ
*/
</code></pre>
<hr />
<p>ç”±æ–¼å®Œæ•´æ–‡æª”è¶…é15è¬å­—ï¼Œè®“æˆ‘å…ˆä¿å­˜é€™éƒ¨åˆ†ï¼Œç„¶å¾Œç¹¼çºŒå‰µå»ºå¾ŒçºŒå…§å®¹...</p>
<h2 id="5-å¯†é‘°ç®¡ç†èˆ‡åœ°å€ç”Ÿæˆ"><a class="header" href="#5-å¯†é‘°ç®¡ç†èˆ‡åœ°å€ç”Ÿæˆ">5. å¯†é‘°ç®¡ç†èˆ‡åœ°å€ç”Ÿæˆ</a></h2>
<h3 id="51-å®Œæ•´çš„å¯†é‘°é«”ç³»hd-wallet"><a class="header" href="#51-å®Œæ•´çš„å¯†é‘°é«”ç³»hd-wallet">5.1 å®Œæ•´çš„å¯†é‘°é«”ç³»ï¼ˆHD Walletï¼‰</a></h3>
<pre><code>ã€å±¤ç´šç¢ºå®šæ€§éŒ¢åŒ… - BIP32/BIP39/BIP44 å®Œæ•´æµç¨‹ã€‘

ç¬¬ 1 æ­¥ï¼šç”ŸæˆåŠ©è¨˜è© (BIP39)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
éš¨æ©Ÿç†µ (128-256 bits)
    â†“
åŠ ä¸Šæ ¡é©—å’Œ
    â†“
è½‰æ›ç‚ºå–®è©ç´¢å¼•
    â†“
12 æˆ– 24 å€‹è‹±æ–‡å–®è©

ç¯„ä¾‹åŠ©è¨˜è©ï¼ˆ12 wordsï¼‰:
army van defense carry jealous true 
garbage claim echo media make crunch

å„ªé»ï¼š
âœ“ å®¹æ˜“è¨˜æ†¶å’Œå‚™ä»½
âœ“ å¯ä»¥æ¢å¾©æ‰€æœ‰ç§é‘°
âœ“ è·¨éŒ¢åŒ…å…¼å®¹ï¼ˆåªè¦éƒ½éµå¾ª BIP39ï¼‰
âœ“ æ”¯æŒå¤šèªè¨€ï¼ˆè‹±æ–‡ã€ä¸­æ–‡ã€æ—¥æ–‡ç­‰ï¼‰


ç¬¬ 2 æ­¥ï¼šç”Ÿæˆç¨®å­ (BIP39)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
åŠ©è¨˜è© + å¯é¸å¯†ç¢¼ (passphrase)
    â†“
PBKDF2-HMAC-SHA512 (2048 æ¬¡è¿­ä»£)
    â†“
512-bit ç¨®å­

Seed = PBKDF2(
  password = mnemonic + passphrase,
  salt = "mnemonic" + passphrase,
  iterations = 2048,
  hash = SHA512
)

ç‚ºä»€éº¼è¦ 2048 æ¬¡è¿­ä»£ï¼Ÿ
â†’ å¢åŠ æš´åŠ›ç ´è§£çš„é›£åº¦
â†’ æ¯æ¬¡å˜—è©¦éœ€è¦æ›´å¤šè¨ˆç®—æ™‚é–“


ç¬¬ 3 æ­¥ï¼šç”Ÿæˆä¸»å¯†é‘° (BIP32)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
512-bit Seed
    â†“
HMAC-SHA512("Bitcoin seed", Seed)
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å·¦ 256 bits     â”‚ å³ 256 bits     â”‚
â”‚ ä¸»ç§é‘°          â”‚ ä¸»éˆç¢¼          â”‚
â”‚ Master Key      â”‚ Master Chain    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


ç¬¬ 4 æ­¥ï¼šå­å¯†é‘°æ´¾ç”Ÿ (BIP44)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
BIP44 æ¨™æº–è·¯å¾‘ï¼š
m / purpose' / coin_type' / account' / change / address_index

è§£ææ¯å€‹éƒ¨åˆ†ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ m          â”‚ ä¸»å¯†é‘°ï¼ˆæ ¹ç¯€é»ï¼‰                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ purpose'   â”‚ 44' (å›ºå®šï¼Œä»£è¡¨ BIP44 æ¨™æº–)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ coin_type' â”‚ å¹£ç¨®ä»£ç¢¼                              â”‚
â”‚            â”‚ - 60' = ä»¥å¤ªåŠ                        â”‚
â”‚            â”‚ - 0' = æ¯”ç‰¹å¹£                         â”‚
â”‚            â”‚ - 714' = Binance Chain               â”‚
â”‚            â”‚ - 118' = Cosmos                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ account'   â”‚ å¸³æˆ¶ç´¢å¼• (0', 1', 2'...)              â”‚
â”‚            â”‚ ç”¨æ–¼å€åˆ†ä¸åŒç”¨é€”çš„å¸³æˆ¶                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ change     â”‚ 0 = å¤–éƒ¨éˆï¼ˆæ¥æ”¶åœ°å€ï¼‰                 â”‚
â”‚            â”‚ 1 = æ‰¾é›¶éˆï¼ˆæ‰¾é›¶åœ°å€ï¼‰                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ address_   â”‚ åœ°å€ç´¢å¼• (0, 1, 2...)                 â”‚
â”‚ index      â”‚ å¯ä»¥ç”Ÿæˆç„¡é™å¤šå€‹åœ°å€                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

' è¡¨ç¤ºå¼·åŒ–æ´¾ç”Ÿ (Hardened Derivation)
- æä¾›é¡å¤–çš„å®‰å…¨æ€§
- å³ä½¿å­ç§é‘°æ´©æ¼ï¼Œä¹Ÿç„¡æ³•æ¨å°å‡ºå…¶ä»–å­å¯†é‘°

å¯¦éš›è·¯å¾‘ç¯„ä¾‹ï¼š
m/44'/60'/0'/0/0  â†’ ä»¥å¤ªåŠç¬¬ 1 å€‹æ¥æ”¶åœ°å€
m/44'/60'/0'/0/1  â†’ ä»¥å¤ªåŠç¬¬ 2 å€‹æ¥æ”¶åœ°å€
m/44'/60'/0'/0/2  â†’ ä»¥å¤ªåŠç¬¬ 3 å€‹æ¥æ”¶åœ°å€
m/44'/60'/1'/0/0  â†’ ä»¥å¤ªåŠç¬¬ 2 å€‹å¸³æˆ¶ç¬¬ 1 å€‹åœ°å€
m/44'/0'/0'/0/0   â†’ æ¯”ç‰¹å¹£ç¬¬ 1 å€‹åœ°å€
m/44'/0'/0'/1/0   â†’ æ¯”ç‰¹å¹£æ‰¾é›¶åœ°å€


ç¬¬ 5 æ­¥ï¼šç§é‘°åˆ°å…¬é‘° (ECDSA)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ç§é‘° (Private Key) - 256 bits
    â†“
æ©¢åœ“æ›²ç·šé»ä¹˜æ³• (secp256k1 æ›²ç·š)
å…¬é‘° = ç§é‘° Ã— G (G æ˜¯æ›²ç·šçš„ç”Ÿæˆé»)
    â†“
å…¬é‘° (Public Key)

æœªå£“ç¸®æ ¼å¼ - 512 bits (65 bytes):
04 + xåæ¨™(32 bytes) + yåæ¨™(32 bytes)

å£“ç¸®æ ¼å¼ - 264 bits (33 bytes):
02/03 + xåæ¨™(32 bytes)
â†‘ 02 è¡¨ç¤º y ç‚ºå¶æ•¸ï¼Œ03 è¡¨ç¤º y ç‚ºå¥‡æ•¸

æ©¢åœ“æ›²ç·šæ–¹ç¨‹ (secp256k1):
yÂ² = xÂ³ + 7


ç¬¬ 6 æ­¥ï¼šå…¬é‘°åˆ°åœ°å€ (ä»¥å¤ªåŠ)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
å…¬é‘° (å»æ‰å‰ç¶´ 04)
    â†“
Keccak-256 å“ˆå¸Œ
    â†“
å–æœ€å¾Œ 20 bytes (160 bits)
    â†“
åŠ ä¸Š 0x å‰ç¶´
    â†“
ä»¥å¤ªåŠåœ°å€ (42 å­—ç¬¦)

ç¯„ä¾‹ï¼š
å…¬é‘°: 04a1b2c3d4e5f6...
    â†“ Keccak-256
Hash: 9f8e7d6c5b4a3f2e1d0c9b8a7f6e5d4c3b2a1f9e8d7c6b5a4f3e2d1c0b9a8f7e6
    â†“ å–å¾Œ 40 å€‹åå…­é€²åˆ¶å­—ç¬¦
åœ°å€: 0x8d7c6b5a4f3e2d1c0b9a8f7e6d5c4b3a2f1e9d8c


å®Œæ•´æµç¨‹åœ–ï¼š
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

éš¨æ©Ÿç†µ (128 bits)
    â†“
åŠ©è¨˜è© (12 words)
"army van defense carry jealous true..."
    â†“
ç¨®å­ (512 bits)
"a1b2c3d4e5f6..."
    â†“
ä¸»ç§é‘° (256 bits) + ä¸»éˆç¢¼ (256 bits)
    â†“
BIP44 è·¯å¾‘æ´¾ç”Ÿ
m/44'/60'/0'/0/0
    â†“
å­ç§é‘° (256 bits)
"3a1b2c3d4e5f6..."
    â†“
ECDSA æ©¢åœ“æ›²ç·š
    â†“
å…¬é‘° (512 bits, æœªå£“ç¸®)
"04a1b2c3d4..."
    â†“
Keccak-256
    â†“
ä»¥å¤ªåŠåœ°å€ (160 bits)
"0x742d35Cc6634C0532925a3b844Bc454e4438f44e"
</code></pre>
<hr />
<h2 id="7-å¤šç°½éŒ¢åŒ…-multi-signature---ç™½æ¿é‡é»"><a class="header" href="#7-å¤šç°½éŒ¢åŒ…-multi-signature---ç™½æ¿é‡é»">7. å¤šç°½éŒ¢åŒ… (Multi-Signature) - ç™½æ¿é‡é»ï¼</a></h2>
<h3 id="71-å¤šç°½éŒ¢åŒ…åŸç†"><a class="header" href="#71-å¤šç°½éŒ¢åŒ…åŸç†">7.1 å¤šç°½éŒ¢åŒ…åŸç†</a></h3>
<pre><code>â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘               ä»€éº¼æ˜¯å¤šç°½éŒ¢åŒ…ï¼Ÿï¼ˆç™½æ¿è¨è«–é‡é»ï¼‰                  â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                â•‘
â•‘  æ™®é€šéŒ¢åŒ…ï¼ˆå–®ç°½ï¼‰:                                              â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚ 1 å€‹ç§é‘° = 100% æ§åˆ¶æ¬Š                                  â”‚  â•‘
â•‘  â”‚                                                         â”‚  â•‘
â•‘  â”‚ Alice çš„ç§é‘°                                            â”‚  â•‘
â•‘  â”‚     â†“                                                  â”‚  â•‘
â•‘  â”‚   ç°½å â†’ å¯ä»¥è½‰èµ°æ‰€æœ‰è³‡é‡‘                               â”‚  â•‘
â•‘  â”‚                                                         â”‚  â•‘
â•‘  â”‚ é¢¨éšªï¼š                                                  â”‚  â•‘
â•‘  â”‚ âŒ ç§é‘°ä¸Ÿå¤± = è³‡é‡‘æ°¸ä¹…ä¸Ÿå¤±                              â”‚  â•‘
â•‘  â”‚ âŒ ç§é‘°è¢«ç›œ = è³‡é‡‘è¢«ç›œèµ°                                â”‚  â•‘
â•‘  â”‚ âŒ å–®é»æ•…éšœ                                            â”‚  â•‘
â•‘  â”‚ âŒ ç„¡åˆ¶è¡¡æ©Ÿåˆ¶                                          â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                â•‘
â•‘  å¤šç°½éŒ¢åŒ…ï¼ˆMulti-Sigï¼‰:                                        â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚ M-of-N ç°½åæ©Ÿåˆ¶                                         â”‚  â•‘
â•‘  â”‚ éœ€è¦ N å€‹æŒæœ‰äººä¸­çš„ M å€‹åŒæ„                             â”‚  â•‘
â•‘  â”‚                                                         â”‚  â•‘
â•‘  â”‚ ç¯„ä¾‹ï¼š2-of-3 å¤šç°½                                        â”‚  â•‘
â•‘  â”‚                                                         â”‚  â•‘
â•‘  â”‚ æŒæœ‰äººï¼š                                                â”‚  â•‘
â•‘  â”‚ ğŸ‘¤ Alice   [ç§é‘° A]                                     â”‚  â•‘
â•‘  â”‚ ğŸ‘¤ Bob     [ç§é‘° B]                                     â”‚  â•‘
â•‘  â”‚ ğŸ‘¤ Carol   [ç§é‘° C]                                     â”‚  â•‘
â•‘  â”‚                                                         â”‚  â•‘
â•‘  â”‚ è½‰å¸³è¦å‰‡ï¼šéœ€è¦å…¶ä¸­ 2 å€‹äººç°½å                            â”‚  â•‘
â•‘  â”‚                                                         â”‚  â•‘
â•‘  â”‚ âœ“ Alice + Bob     â†’ å¯ä»¥åŸ·è¡Œ âœ“                         â”‚  â•‘
â•‘  â”‚ âœ“ Alice + Carol   â†’ å¯ä»¥åŸ·è¡Œ âœ“                         â”‚  â•‘
â•‘  â”‚ âœ“ Bob + Carol     â†’ å¯ä»¥åŸ·è¡Œ âœ“                         â”‚  â•‘
â•‘  â”‚ âœ— åªæœ‰ Alice      â†’ ç„¡æ³•åŸ·è¡Œ âœ—                         â”‚  â•‘
â•‘  â”‚ âœ— åªæœ‰ Bob        â†’ ç„¡æ³•åŸ·è¡Œ âœ—                         â”‚  â•‘
â•‘  â”‚ âœ— Carol ç§é‘°è¢«ç›œ  â†’ ç„¡æ³•å–®ç¨è½‰å¸³ âœ—                      â”‚  â•‘
â•‘  â”‚                                                         â”‚  â•‘
â•‘  â”‚ å„ªé»ï¼š                                                  â”‚  â•‘
â•‘  â”‚ âœ“ æ›´å®‰å…¨ï¼ˆéœ€è¦å¤šå€‹ç§é‘°ï¼‰                                â”‚  â•‘
â•‘  â”‚ âœ“ é˜²ç›œï¼ˆå–®å€‹ç§é‘°è¢«ç›œç„¡æ³•è½‰å¸³ï¼‰                          â”‚  â•‘
â•‘  â”‚ âœ“ é˜²ä¸Ÿå¤±ï¼ˆ1-2å€‹ç§é‘°ä¸Ÿå¤±ä»å¯æ¢å¾©ï¼‰                       â”‚  â•‘
â•‘  â”‚ âœ“ ä¼æ¥­æ²»ç†ï¼ˆé‡å¤§æ±ºç­–éœ€å¤šäººæ‰¹å‡†ï¼‰                        â”‚  â•‘
â•‘  â”‚ âœ“ å¯©è¨ˆè¿½è¹¤ï¼ˆè¨˜éŒ„èª°æ‰¹å‡†äº†ä»€éº¼ï¼‰                          â”‚  â•‘
â•‘  â”‚ âœ“ éˆæ´»é…ç½®ï¼ˆå¯ä»¥ 2-of-3, 3-of-5, 7-of-10 ç­‰ï¼‰          â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
</code></pre>
<h3 id="72-å¤šç°½éŒ¢åŒ…æ™ºèƒ½åˆç´„å¯¦ç¾"><a class="header" href="#72-å¤šç°½éŒ¢åŒ…æ™ºèƒ½åˆç´„å¯¦ç¾">7.2 å¤šç°½éŒ¢åŒ…æ™ºèƒ½åˆç´„å¯¦ç¾</a></h3>
<pre><code class="language-solidity">// ===== Gnosis Safe é¢¨æ ¼çš„å¤šç°½éŒ¢åŒ…åˆç´„ =====

pragma solidity ^0.8.0;

contract MultiSigWallet {
    // â”â”â” ç‹€æ…‹è®Šé‡ â”â”â”
    address[] public owners;                    // æŒæœ‰äººåˆ—è¡¨
    mapping(address =&gt; bool) public isOwner;    // å¿«é€Ÿæª¢æŸ¥æ˜¯å¦ç‚ºæŒæœ‰äºº
    uint public required;                       // éœ€è¦çš„ç°½åæ•¸
    
    // äº¤æ˜“çµæ§‹
    struct Transaction {
        address to;                             // ç›®æ¨™åœ°å€
        uint value;                             // è½‰å¸³é‡‘é¡
        bytes data;                             // èª¿ç”¨æ•¸æ“š
        bool executed;                          // æ˜¯å¦å·²åŸ·è¡Œ
        uint numConfirmations;                  // ç¢ºèªæ•¸
    }
    
    Transaction[] public transactions;
    
    // äº¤æ˜“ID â†’ æŒæœ‰äºº â†’ æ˜¯å¦å·²ç¢ºèª
    mapping(uint =&gt; mapping(address =&gt; bool)) public isConfirmed;
    
    // â”â”â” äº‹ä»¶ â”â”â”
    event Deposit(address indexed sender, uint amount, uint balance);
    event SubmitTransaction(
        address indexed owner,
        uint indexed txIndex,
        address indexed to,
        uint value,
        bytes data
    );
    event ConfirmTransaction(address indexed owner, uint indexed txIndex);
    event RevokeConfirmation(address indexed owner, uint indexed txIndex);
    event ExecuteTransaction(address indexed owner, uint indexed txIndex);
    
    // â”â”â” ä¿®é£¾ç¬¦ â”â”â”
    modifier onlyOwner() {
        require(isOwner[msg.sender], "not owner");
        _;
    }
    
    modifier txExists(uint _txIndex) {
        require(_txIndex &lt; transactions.length, "tx does not exist");
        _;
    }
    
    modifier notExecuted(uint _txIndex) {
        require(!transactions[_txIndex].executed, "tx already executed");
        _;
    }
    
    modifier notConfirmed(uint _txIndex) {
        require(!isConfirmed[_txIndex][msg.sender], "tx already confirmed");
        _;
    }
    
    // â”â”â” å»ºæ§‹å­ â”â”â”
    constructor(address[] memory _owners, uint _required) {
        require(_owners.length &gt; 0, "owners required");
        require(
            _required &gt; 0 &amp;&amp; _required &lt;= _owners.length,
            "invalid number of required confirmations"
        );
        
        for (uint i = 0; i &lt; _owners.length; i++) {
            address owner = _owners[i];
            
            require(owner != address(0), "invalid owner");
            require(!isOwner[owner], "owner not unique");
            
            isOwner[owner] = true;
            owners.push(owner);
        }
        
        required = _required;
    }
    
    // â”â”â” æ¥æ”¶ ETH â”â”â”
    receive() external payable {
        emit Deposit(msg.sender, msg.value, address(this).balance);
    }
    
    // â”â”â” ä¸»è¦åŠŸèƒ½ â”â”â”
    
    // 1. æäº¤äº¤æ˜“ææ¡ˆ
    function submitTransaction(
        address _to,
        uint _value,
        bytes memory _data
    ) public onlyOwner {
        uint txIndex = transactions.length;
        
        transactions.push(
            Transaction({
                to: _to,
                value: _value,
                data: _data,
                executed: false,
                numConfirmations: 0
            })
        );
        
        emit SubmitTransaction(msg.sender, txIndex, _to, _value, _data);
    }
    
    // 2. ç¢ºèªäº¤æ˜“
    function confirmTransaction(uint _txIndex)
        public
        onlyOwner
        txExists(_txIndex)
        notExecuted(_txIndex)
        notConfirmed(_txIndex)
    {
        Transaction storage transaction = transactions[_txIndex];
        transaction.numConfirmations += 1;
        isConfirmed[_txIndex][msg.sender] = true;
        
        emit ConfirmTransaction(msg.sender, _txIndex);
    }
    
    // 3. åŸ·è¡Œäº¤æ˜“
    function executeTransaction(uint _txIndex)
        public
        onlyOwner
        txExists(_txIndex)
        notExecuted(_txIndex)
    {
        Transaction storage transaction = transactions[_txIndex];
        
        require(
            transaction.numConfirmations &gt;= required,
            "cannot execute tx: not enough confirmations"
        );
        
        transaction.executed = true;
        
        (bool success, ) = transaction.to.call{value: transaction.value}(
            transaction.data
        );
        require(success, "tx failed");
        
        emit ExecuteTransaction(msg.sender, _txIndex);
    }
    
    // 4. æ’¤éŠ·ç¢ºèª
    function revokeConfirmation(uint _txIndex)
        public
        onlyOwner
        txExists(_txIndex)
        notExecuted(_txIndex)
    {
        require(isConfirmed[_txIndex][msg.sender], "tx not confirmed");
        
        Transaction storage transaction = transactions[_txIndex];
        transaction.numConfirmations -= 1;
        isConfirmed[_txIndex][msg.sender] = false;
        
        emit RevokeConfirmation(msg.sender, _txIndex);
    }
    
    // â”â”â” æŸ¥è©¢åŠŸèƒ½ â”â”â”
    
    function getOwners() public view returns (address[] memory) {
        return owners;
    }
    
    function getTransactionCount() public view returns (uint) {
        return transactions.length;
    }
    
    function getTransaction(uint _txIndex)
        public
        view
        returns (
            address to,
            uint value,
            bytes memory data,
            bool executed,
            uint numConfirmations
        )
    {
        Transaction storage transaction = transactions[_txIndex];
        
        return (
            transaction.to,
            transaction.value,
            transaction.data,
            transaction.executed,
            transaction.numConfirmations
        );
    }
}
</code></pre>
<h3 id="73-å¤šç°½éŒ¢åŒ…ä½¿ç”¨å ´æ™¯"><a class="header" href="#73-å¤šç°½éŒ¢åŒ…ä½¿ç”¨å ´æ™¯">7.3 å¤šç°½éŒ¢åŒ…ä½¿ç”¨å ´æ™¯</a></h3>
<pre><code class="language-javascript">// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// å ´æ™¯ 1: ä¼æ¥­è³‡é‡‘ç®¡ç† (3-of-5 å¤šç°½)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const companyMultiSig = {
  owners: [
    '0xCEO...',      // CEO
    '0xCFO...',      // CFO
    '0xCTO...',      // CTO
    '0xBoard1...',   // è‘£äº‹ A
    '0xBoard2...'    // è‘£äº‹ B
  ],
  required: 3,       // éœ€è¦ 3 å€‹ç°½å
  
  // åˆ†ç´šæˆæ¬Šè¦å‰‡
  rules: {
    smallAmount: {   // &lt; 10 ETH
      required: 2,
      approvers: ['CEO', 'CFO', 'CTO']
    },
    largeAmount: {   // &gt;= 10 ETH
      required: 3,
      mustInclude: ['CEO', 'CFO']  // å¿…é ˆåŒ…å« CEO å’Œ CFO
    }
  }
}

// å·¥ä½œæµç¨‹ç¯„ä¾‹
async function initiateCompanyPayment(amount, vendor) {
  // 1. CFO æäº¤äº¤æ˜“ææ¡ˆ
  const txId = await multiSig.methods.submitTransaction(
    vendor,
    web3.utils.toWei(amount.toString(), 'ether'),
    '0x'
  ).send({from: CFO_ADDRESS})
  
  console.log(`âœ“ äº¤æ˜“ææ¡ˆå·²æäº¤ #${txId}`)
  console.log(`éœ€è¦ ${amount &gt;= 10 ? '3' : '2'} å€‹ç°½å`)
  
  // 2. ç™¼é€é€šçŸ¥çµ¦å…¶ä»–æŒæœ‰äºº
  await notifyOwners({
    to: ['CEO', 'CTO', 'Board1', 'Board2'],
    subject: `æ–°çš„æ”¯ä»˜ææ¡ˆ #${txId}`,
    body: `
      é‡‘é¡: ${amount} ETH ($${amount * ethPrice} USD)
      æ”¶æ¬¾æ–¹: ${vendor}
      æè­°äºº: CFO
      
      è«‹åœ¨å¤šç°½éŒ¢åŒ…ä¸­å¯©æ ¸ä¸¦ç¢ºèª
      æˆªæ­¢æ™‚é–“: 48å°æ™‚å…§
    `
  })
  
  return txId
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// å ´æ™¯ 2: DAO æ²»ç† (7-of-10 å¤šç°½)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const daoMultiSig = {
  owners: [
    // 10 å€‹ç¤¾å€é¸å‡ºçš„ç†äº‹
    '0xCouncil1...', '0xCouncil2...', '0xCouncil3...',
    '0xCouncil4...', '0xCouncil5...', '0xCouncil6...',
    '0xCouncil7...', '0xCouncil8...', '0xCouncil9...',
    '0xCouncil10...'
  ],
  required: 7,  // éœ€è¦ 70% åŒæ„
  
  governanceActions: [
    'ä¿®æ”¹å”è­°åƒæ•¸',
    'ä½¿ç”¨è²¡åº«è³‡é‡‘',
    'éƒ¨ç½²æ–°åˆç´„',
    'ç·Šæ€¥æš«åœ',
    'å‡ç´šåˆç´„'
  ]
}

// DAO ææ¡ˆæµç¨‹
async function createDAOProposal(action, params, description) {
  // 1. ç†äº‹æäº¤ææ¡ˆ
  const txId = await multiSig.methods.submitTransaction(
    action.target,
    action.value,
    action.calldata
  ).send({from: councilMember})
  
  // 2. ç™¼å¸ƒææ¡ˆåˆ°è«–å£‡
  await publishProposal({
    id: txId,
    title: action.title,
    description: description,
    votingPeriod: 7, // 7 å¤©
    requiredVotes: 7
  })
  
  // 3. ç†äº‹æŠ•ç¥¨
  console.log('æŠ•ç¥¨æœŸé–‹å§‹ï¼Œç­‰å¾…ç†äº‹æŠ•ç¥¨...')
  
  // 4. é”åˆ° 7 ç¥¨å¾Œè‡ªå‹•åŸ·è¡Œ
  const result = await waitForVotes(txId, 7)
  if (result.approved) {
    await multiSig.methods.executeTransaction(txId).send({from: councilMember})
    console.log('âœ“ ææ¡ˆå·²é€šéä¸¦åŸ·è¡Œ')
  }
  
  return result
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// å ´æ™¯ 3: å€‹äººè³‡ç”¢ä¿è­· (2-of-3 å¤šç°½)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const personalMultiSig = {
  owners: [
    '0xMobile...',    // æ‰‹æ©ŸéŒ¢åŒ…ï¼ˆæ—¥å¸¸ä½¿ç”¨ï¼‰
    '0xLedger...',    // ç¡¬é«”éŒ¢åŒ…ï¼ˆå®‰å…¨ï¼‰
    '0xCold...'       // å†·éŒ¢åŒ…å‚™ä»½ï¼ˆç·Šæ€¥æ¢å¾©ï¼‰
  ],
  required: 2,
  
  scenarios: {
    normal: 'æ‰‹æ©Ÿ + ç¡¬é«”éŒ¢åŒ…',
    phoneLost: 'ç¡¬é«”éŒ¢åŒ… + å†·éŒ¢åŒ…',
    ledgerBroken: 'æ‰‹æ©Ÿ + å†·éŒ¢åŒ…'
  }
}

// æ—¥å¸¸ä½¿ç”¨
async function dailyTransfer(to, amount) {
  // 1. æ‰‹æ©ŸéŒ¢åŒ…æäº¤
  const txId = await multiSig.methods.submitTransaction(
    to,
    web3.utils.toWei(amount.toString(), 'ether'),
    '0x'
  ).send({from: MOBILE_ADDRESS})
  
  // 2. ç¡¬é«”éŒ¢åŒ…ç¢ºèªï¼ˆéœ€è¦ç‰©ç†æŒ‰éˆ•ï¼‰
  console.log('ğŸ“± äº¤æ˜“å·²æäº¤')
  console.log('ğŸ” è«‹åœ¨ Ledger ä¸Šç¢ºèª...')
  
  await ledger.confirmTransaction(txId)
  
  // 3. é”åˆ° 2 å€‹ç°½åï¼Œè‡ªå‹•åŸ·è¡Œ
  console.log('âœ“ äº¤æ˜“å·²åŸ·è¡Œ')
}

// ç·Šæ€¥æ¢å¾©ï¼ˆæ‰‹æ©Ÿä¸Ÿå¤±ï¼‰
async function emergencyRecover(newPhoneAddress) {
  console.log('ğŸš¨ ç·Šæ€¥æ¢å¾©æ¨¡å¼')
  console.log('ä½¿ç”¨ï¼šç¡¬é«”éŒ¢åŒ… + å†·éŒ¢åŒ…')
  
  // 1. ç§»é™¤èˆŠæ‰‹æ©Ÿåœ°å€
  const txId1 = await multiSig.methods.submitTransaction(
    MULTISIG_ADDRESS,
    0,
    multiSig.methods.removeOwner(OLD_MOBILE_ADDRESS).encodeABI()
  ).send({from: LEDGER_ADDRESS})
  
  await coldWallet.confirmTransaction(txId1)
  await multiSig.methods.executeTransaction(txId1).send({from: LEDGER_ADDRESS})
  
  // 2. æ·»åŠ æ–°æ‰‹æ©Ÿåœ°å€
  const txId2 = await multiSig.methods.submitTransaction(
    MULTISIG_ADDRESS,
    0,
    multiSig.methods.addOwner(newPhoneAddress).encodeABI()
  ).send({from: LEDGER_ADDRESS})
  
  await coldWallet.confirmTransaction(txId2)
  await multiSig.methods.executeTransaction(txId2).send({from: LEDGER_ADDRESS})
  
  console.log('âœ“ æ¢å¾©å®Œæˆï¼æ–°æ‰‹æ©Ÿå·²æˆæ¬Š')
}
</code></pre>
<hr />
<h2 id="14-å€å¡Šéˆå®Œæ•´æ¶æ§‹åœ–"><a class="header" href="#14-å€å¡Šéˆå®Œæ•´æ¶æ§‹åœ–">14. å€å¡Šéˆå®Œæ•´æ¶æ§‹åœ–</a></h2>
<h3 id="141-ç³»çµ±æ¶æ§‹ç¸½è¦½"><a class="header" href="#141-ç³»çµ±æ¶æ§‹ç¸½è¦½">14.1 ç³»çµ±æ¶æ§‹ç¸½è¦½</a></h3>
<pre><code>â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  å€å¡ŠéˆéŒ¢åŒ…ç³»çµ±å®Œæ•´æ¶æ§‹åœ–                           â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                    â•‘
â•‘  ã€å‰ç«¯å±¤ - User Interface Layerã€‘                                 â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚  Web æ‡‰ç”¨ / ç§»å‹•æ‡‰ç”¨ / ç€è¦½å™¨æ“´å±•                            â”‚  â•‘
â•‘  â”‚  â”œâ”€ React / Vue / Angular                                  â”‚  â•‘
â•‘  â”‚  â”œâ”€ React Native / Flutter (ç§»å‹•ç«¯)                        â”‚  â•‘
â•‘  â”‚  â””â”€ Chrome Extension API (ç€è¦½å™¨æ“´å±•)                       â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚  æ ¸å¿ƒæ¨¡çµ„ï¼š                                                  â”‚  â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â•‘
â•‘  â”‚  â”‚ éŒ¢åŒ…ç®¡ç†                                             â”‚  â”‚  â•‘
â•‘  â”‚  â”‚ â”œâ”€ å‰µå»º/å°å…¥éŒ¢åŒ…                                    â”‚  â”‚  â•‘
â•‘  â”‚  â”‚ â”œâ”€ åŠ©è¨˜è©ç®¡ç†                                       â”‚  â”‚  â•‘
â•‘  â”‚  â”‚ â”œâ”€ å¤šéŒ¢åŒ…åˆ‡æ›                                       â”‚  â”‚  â•‘
â•‘  â”‚  â”‚ â””â”€ åœ°å€ç°¿                                           â”‚  â”‚  â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â•‘
â•‘  â”‚  â”‚ è³‡ç”¢ç®¡ç†                                             â”‚  â”‚  â•‘
â•‘  â”‚  â”‚ â”œâ”€ æŸ¥çœ‹é¤˜é¡ï¼ˆETH / ERC-20 / NFTï¼‰                  â”‚  â”‚  â•‘
â•‘  â”‚  â”‚ â”œâ”€ äº¤æ˜“æ­·å²                                         â”‚  â”‚  â•‘
â•‘  â”‚  â”‚ â”œâ”€ åƒ¹æ ¼è¿½è¹¤                                         â”‚  â”‚  â•‘
â•‘  â”‚  â”‚ â””â”€ è³‡ç”¢çµ±è¨ˆåœ–è¡¨                                     â”‚  â”‚  â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â•‘
â•‘  â”‚  â”‚ äº¤æ˜“åŠŸèƒ½                                             â”‚  â”‚  â•‘
â•‘  â”‚  â”‚ â”œâ”€ ç™¼é€ / æ¥æ”¶                                      â”‚  â”‚  â•‘
â•‘  â”‚  â”‚ â”œâ”€ Gas è¨­ç½®ï¼ˆæ…¢/æ¨™æº–/å¿«ï¼‰                           â”‚  â”‚  â•‘
â•‘  â”‚  â”‚ â”œâ”€ äº¤æ˜“ç¢ºèª UI                                      â”‚  â”‚  â•‘
â•‘  â”‚  â”‚ â”œâ”€ äº¤æ˜“ç‹€æ…‹è¿½è¹¤                                     â”‚  â”‚  â•‘
â•‘  â”‚  â”‚ â””â”€ äº¤æ˜“åŠ é€Ÿ/å–æ¶ˆ                                    â”‚  â”‚  â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                            â†•                                      â•‘
â•‘                  JSON-RPC / WebSocket / HTTP                      â•‘
â•‘                            â†•                                      â•‘
â•‘  ã€Web3 å±¤ - Connection Layerã€‘                                   â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚  Web3 Provider æŠ½è±¡å±¤                                        â”‚  â•‘
â•‘  â”‚  â”œâ”€ Web3.js / Ethers.js                                    â”‚  â•‘
â•‘  â”‚  â”œâ”€ WalletConnect                                          â”‚  â•‘
â•‘  â”‚  â””â”€ Coinbase Wallet SDK                                    â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚  é€£æ¥æ–¹å¼ï¼š                                                  â”‚  â•‘
â•‘  â”‚  â”œâ”€ Injected Provider (window.ethereum)                    â”‚  â•‘
â•‘  â”‚  â”œâ”€ WalletConnect (QR Code / æ·±åº¦éˆæ¥)                      â”‚  â•‘
â•‘  â”‚  â”œâ”€ RPC Connection (HTTP / WebSocket)                      â”‚  â•‘
â•‘  â”‚  â””â”€ Hardware Wallet (USB / Bluetooth)                      â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                            â†•                                      â•‘
â•‘  ã€æ¥­å‹™é‚è¼¯å±¤ - Business Logic Layerã€‘                             â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚  â•‘
â•‘  â”‚  â”‚  å¯†é‘°ç®¡ç†æ¨¡çµ„     â”‚  â”‚  äº¤æ˜“ç®¡ç†æ¨¡çµ„     â”‚               â”‚  â•‘
â•‘  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚  â•‘
â•‘  â”‚  â”‚ â€¢ HD Wallet      â”‚  â”‚ â€¢ äº¤æ˜“æ§‹å»º        â”‚               â”‚  â•‘
â•‘  â”‚  â”‚ â€¢ BIP39/44       â”‚  â”‚ â€¢ Nonce ç®¡ç†     â”‚               â”‚  â•‘
â•‘  â”‚  â”‚ â€¢ ç§é‘°åŠ å¯†       â”‚  â”‚ â€¢ Gas ä¼°ç®—       â”‚               â”‚  â•‘
â•‘  â”‚  â”‚ â€¢ ç°½åæœå‹™       â”‚  â”‚ â€¢ äº¤æ˜“å»£æ’­       â”‚               â”‚  â•‘
â•‘  â”‚  â”‚ â€¢ Keystore       â”‚  â”‚ â€¢ ç‹€æ…‹è¿½è¹¤       â”‚               â”‚  â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â€¢ å¤šå±¤èª¿ç”¨è™•ç†   â”‚               â”‚  â•‘
â•‘  â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚  â•‘
â•‘  â”‚  â”‚  ä»£å¹£ç®¡ç†æ¨¡çµ„     â”‚  â”‚  å®‰å…¨æª¢æŸ¥æ¨¡çµ„     â”‚               â”‚  â•‘
â•‘  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚  â•‘
â•‘  â”‚  â”‚ â€¢ ERC-20 è™•ç†    â”‚  â”‚ â€¢ äº¤æ˜“é©—è­‰        â”‚               â”‚  â•‘
â•‘  â”‚  â”‚ â€¢ ERC-721 (NFT)  â”‚  â”‚ â€¢ åœ°å€æª¢æŸ¥        â”‚               â”‚  â•‘
â•‘  â”‚  â”‚ â€¢ ERC-1155       â”‚  â”‚ â€¢ åˆç´„é©—è­‰        â”‚               â”‚  â•‘
â•‘  â”‚  â”‚ â€¢ é¤˜é¡æŸ¥è©¢       â”‚  â”‚ â€¢ é‡£é­šæª¢æ¸¬        â”‚               â”‚  â•‘
â•‘  â”‚  â”‚ â€¢ æˆæ¬Šç®¡ç†       â”‚  â”‚ â€¢ Gas åˆç†æ€§     â”‚               â”‚  â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                            â†•                                      â•‘
â•‘  ã€æ•¸æ“šå±¤ - Data Layerã€‘                                           â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚  æœ¬åœ°å­˜å„²ï¼ˆåŠ å¯†ï¼‰                                            â”‚  â•‘
â•‘  â”‚  â”œâ”€ IndexedDB / LocalStorage (Web)                         â”‚  â•‘
â•‘  â”‚  â”œâ”€ SQLite / Realm (Mobile)                                â”‚  â•‘
â•‘  â”‚  â”œâ”€ Keychain (iOS) / Keystore (Android)                    â”‚  â•‘
â•‘  â”‚  â””â”€ Secure Storage (ç¡¬é«”éŒ¢åŒ…)                               â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚  å­˜å„²å…§å®¹ï¼š                                                  â”‚  â•‘
â•‘  â”‚  â”œâ”€ åŠ å¯†çš„ Keystore æ–‡ä»¶                                    â”‚  â•‘
â•‘  â”‚  â”œâ”€ éŒ¢åŒ…å…ƒæ•¸æ“šï¼ˆåœ°å€ã€åç¨±ï¼‰                                 â”‚  â•‘
â•‘  â”‚  â”œâ”€ äº¤æ˜“è¨˜éŒ„ç·©å­˜                                            â”‚  â•‘
â•‘  â”‚  â”œâ”€ ç”¨æˆ¶è¨­ç½®                                                â”‚  â•‘
â•‘  â”‚  â””â”€ åœ°å€ç°¿                                                  â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                            â†•                                      â•‘
â•‘  ã€ç¶²çµ¡å±¤ - Network Layerã€‘                                        â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚  RPC ç¯€é»æœå‹™                                                â”‚  â•‘
â•‘  â”‚  â”œâ”€ Infura (https://mainnet.infura.io/v3/...)              â”‚  â•‘
â•‘  â”‚  â”œâ”€ Alchemy (https://eth-mainnet.alchemyapi.io/...)        â”‚  â•‘
â•‘  â”‚  â”œâ”€ QuickNode                                              â”‚  â•‘
â•‘  â”‚  â”œâ”€ è‡ªå»ºç¯€é»ï¼ˆGeth / Erigonï¼‰                               â”‚  â•‘
â•‘  â”‚  â””â”€ å…¬å…± RPC                                                â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚  æ”¯æŒçš„å”è­°ï¼š                                                â”‚  â•‘
â•‘  â”‚  â”œâ”€ JSON-RPC (HTTP / HTTPS)                                â”‚  â•‘
â•‘  â”‚  â”‚  â””â”€ eth_sendRawTransaction, eth_call, etc.             â”‚  â•‘
â•‘  â”‚  â”œâ”€ WebSocket (å¯¦æ™‚è¨‚é–±)                                    â”‚  â•‘
â•‘  â”‚  â”‚  â””â”€ newBlockHeaders, logs, pendingTransactions         â”‚  â•‘
â•‘  â”‚  â””â”€ IPC (æœ¬åœ°ç¯€é»é€šä¿¡)                                      â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                            â†•                                      â•‘
â•‘  ã€å€å¡Šéˆå±¤ - Blockchain Layerã€‘                                   â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚                    P2P å»ä¸­å¿ƒåŒ–ç¶²çµ¡                          â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â•‘
â•‘  â”‚  â”‚                                                       â”‚  â”‚  â•‘
â•‘  â”‚  â”‚    ç¯€é» A â†â†’ ç¯€é» B â†â†’ ç¯€é» C                         â”‚  â”‚  â•‘
â•‘  â”‚  â”‚      â†•         â†•         â†•                           â”‚  â”‚  â•‘
â•‘  â”‚  â”‚    ç¯€é» D â†â†’ ç¯€é» E â†â†’ ç¯€é» F                         â”‚  â”‚  â•‘
â•‘  â”‚  â”‚      â†•         â†•         â†•                           â”‚  â”‚  â•‘
â•‘  â”‚  â”‚    ç¯€é» G â†â†’ ç¯€é» H â†â†’ ç¯€é» I                         â”‚  â”‚  â•‘
â•‘  â”‚  â”‚                                                       â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  æ¯å€‹ç¯€é»ç¶­è­·ï¼š                                        â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”œâ”€ å®Œæ•´å€å¡Šéˆæ•¸æ“š                                    â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”œâ”€ ç•¶å‰ç‹€æ…‹ï¼ˆState Trieï¼‰                           â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”œâ”€ äº¤æ˜“æ± ï¼ˆMempoolï¼‰                                â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â””â”€ æ™ºèƒ½åˆç´„ï¼ˆEVMï¼‰                                   â”‚  â”‚  â•‘
â•‘  â”‚  â”‚                                                       â”‚  â”‚  â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚  å€å¡Šéˆï¼š                                                    â”‚  â•‘
â•‘  â”‚  Block #0 â†’ Block #1 â†’ ... â†’ Block #18,500,000            â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                            â†•                                      â•‘
â•‘  ã€å…±è­˜å±¤ - Consensus Layerã€‘                                      â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚  PoS (Proof of Stake) - ä»¥å¤ªåŠ                              â”‚  â•‘
â•‘  â”‚  â”œâ”€ é©—è­‰è€…è³ªæŠ¼ 32 ETH                                       â”‚  â•‘
â•‘  â”‚  â”œâ”€ éš¨æ©Ÿé¸æ“‡å€å¡Šæè­°è€…                                       â”‚  â•‘
â•‘  â”‚  â”œâ”€ å…¶ä»–é©—è­‰è€…æŠ•ç¥¨ç¢ºèª                                       â”‚  â•‘
â•‘  â”‚  â””â”€ ~12 ç§’/å€å¡Š                                             â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
</code></pre>
<h3 id="142-å¤šç°½éŒ¢åŒ…å·¥ä½œæµç¨‹åœ–"><a class="header" href="#142-å¤šç°½éŒ¢åŒ…å·¥ä½œæµç¨‹åœ–">14.2 å¤šç°½éŒ¢åŒ…å·¥ä½œæµç¨‹åœ–</a></h3>
<pre><code>â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    å¤šç°½éŒ¢åŒ…å®Œæ•´å·¥ä½œæµç¨‹                             â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                    â•‘
â•‘  ã€é…ç½®ã€‘2-of-3 å¤šç°½éŒ¢åŒ…                                            â•‘
â•‘  æŒæœ‰äºº: Alice, Bob, Carol                                         â•‘
â•‘  è¦å‰‡: éœ€è¦å…¶ä¸­ 2 å€‹äººç°½å                                          â•‘
â•‘  é¤˜é¡: 100 ETH                                                     â•‘
â•‘                                                                    â•‘
â•‘  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘  Step 1: Alice æäº¤äº¤æ˜“ææ¡ˆ                                         â•‘
â•‘  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚ Alice åœ¨éŒ¢åŒ…ä¸­æ“ä½œï¼š                                         â”‚  â•‘
â•‘  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â•‘
â•‘  â”‚ â”‚ æ”¶æ¬¾æ–¹: 0xVendor...                                   â”‚  â”‚  â•‘
â•‘  â”‚ â”‚ é‡‘é¡: 10 ETH                                          â”‚  â”‚  â•‘
â•‘  â”‚ â”‚ èªªæ˜: "æ”¯ä»˜ä¾›æ‡‰å•†æ¬¾é …"                                 â”‚  â”‚  â•‘
â•‘  â”‚ â”‚ [æäº¤äº¤æ˜“]                                            â”‚  â”‚  â•‘
â•‘  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ â†“ Alice ç°½åä¸¦èª¿ç”¨æ™ºèƒ½åˆç´„                                  â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ multiSig.submitTransaction(0xVendor, 10 ETH, 0x)            â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ â†“ äº¤æ˜“ä¸Šéˆ                                                  â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ Transaction Hash: 0xabc123...                              â”‚  â•‘
â•‘  â”‚ Block Number: #18,500,000                                  â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ â†“ åˆç´„è¨˜éŒ„æ–°äº¤æ˜“                                            â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ Transaction #5 å‰µå»ºæˆåŠŸ                                     â”‚  â•‘
â•‘  â”‚ â”œâ”€ To: 0xVendor...                                         â”‚  â•‘
â•‘  â”‚ â”œâ”€ Amount: 10 ETH                                          â”‚  â•‘
â•‘  â”‚ â”œâ”€ Confirmations: [Alice âœ“]                               â”‚  â•‘
â•‘  â”‚ â”œâ”€ Status: PENDING (1/2)                                   â”‚  â•‘
â•‘  â”‚ â””â”€ é‚„éœ€è¦ 1 å€‹ç°½å                                          â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                    â•‘
â•‘  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘  Step 2: ç³»çµ±é€šçŸ¥å…¶ä»–æŒæœ‰äºº                                         â•‘
â•‘  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚ äº‹ä»¶ç›£è½å™¨æª¢æ¸¬åˆ° TransactionSubmitted äº‹ä»¶                   â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ â†“ ç™¼é€é€šçŸ¥                                                  â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ ğŸ“§ Bob æ”¶åˆ°éƒµä»¶:                                            â”‚  â•‘
â•‘  â”‚ "Alice æäº¤äº†æ–°äº¤æ˜“ #5                                       â”‚  â•‘
â•‘  â”‚  é‡‘é¡: 10 ETH â†’ 0xVendor...                                â”‚  â•‘
â•‘  â”‚  èªªæ˜: æ”¯ä»˜ä¾›æ‡‰å•†æ¬¾é …                                        â”‚  â•‘
â•‘  â”‚  è«‹åœ¨éŒ¢åŒ…ä¸­å¯©æ ¸ä¸¦ç¢ºèª"                                        â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ ğŸ“§ Carol æ”¶åˆ°ç›¸åŒé€šçŸ¥                                        â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                    â•‘
â•‘  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘  Step 3: Bob å¯©æ ¸ä¸¦ç¢ºèª                                            â•‘
â•‘  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚ Bob æ‰“é–‹éŒ¢åŒ…æŸ¥çœ‹äº¤æ˜“è©³æƒ…ï¼š                                   â”‚  â•‘
â•‘  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â•‘
â•‘  â”‚ â”‚ äº¤æ˜“ #5                                               â”‚  â”‚  â•‘
â•‘  â”‚ â”‚ â”œâ”€ æ”¶æ¬¾æ–¹: 0xVendor... âœ“ (å·²é©—è­‰åˆæ³•)                â”‚  â”‚  â•‘
â•‘  â”‚ â”‚ â”œâ”€ é‡‘é¡: 10 ETH âœ“                                     â”‚  â”‚  â•‘
â•‘  â”‚ â”‚ â”œâ”€ èªªæ˜: "æ”¯ä»˜ä¾›æ‡‰å•†æ¬¾é …" âœ“                           â”‚  â”‚  â•‘
â•‘  â”‚ â”‚ â”œâ”€ æäº¤è€…: Alice                                      â”‚  â”‚  â•‘
â•‘  â”‚ â”‚ â”œâ”€ å·²ç¢ºèª: Alice âœ“                                    â”‚  â”‚  â•‘
â•‘  â”‚ â”‚ â”œâ”€ ç‹€æ…‹: ç­‰å¾…ä½ çš„ç¢ºèª (1/2)                           â”‚  â”‚  â•‘
â•‘  â”‚ â”‚ â”‚                                                     â”‚  â”‚  â•‘
â•‘  â”‚ â”‚ â”‚ [æ‹’çµ•]  [ç¢ºèªäº¤æ˜“]                                  â”‚  â”‚  â•‘
â•‘  â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ â†“ Bob å¯©æ ¸ç„¡èª¤ï¼Œé»æ“Šã€Œç¢ºèªã€                                 â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ Bob ç°½åä¸¦èª¿ç”¨æ™ºèƒ½åˆç´„ï¼š                                     â”‚  â•‘
â•‘  â”‚ multiSig.confirmTransaction(5)                             â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ â†“ äº¤æ˜“ä¸Šéˆ                                                  â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ Transaction Hash: 0xdef456...                              â”‚  â•‘
â•‘  â”‚ Block Number: #18,500,123                                  â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ â†“ åˆç´„æ›´æ–°ç‹€æ…‹                                              â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ Transaction #5                                             â”‚  â•‘
â•‘  â”‚ â”œâ”€ Confirmations: [Alice âœ“, Bob âœ“]                        â”‚  â•‘
â•‘  â”‚ â”œâ”€ Status: READY (2/2) âœ“                                   â”‚  â•‘
â•‘  â”‚ â””â”€ å¯ä»¥åŸ·è¡Œï¼                                               â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                    â•‘
â•‘  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘  Step 4: åŸ·è¡Œäº¤æ˜“                                                  â•‘
â•‘  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚ é”åˆ°æ‰€éœ€ç°½åæ•¸ â†’ ä»»ä½•äººéƒ½å¯ä»¥åŸ·è¡Œ                            â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ â†“ Alice æˆ– Bob é»æ“Šã€ŒåŸ·è¡Œã€                                  â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ multiSig.executeTransaction(5)                             â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ â†“ æ™ºèƒ½åˆç´„æª¢æŸ¥                                              â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ require(confirmations &gt;= required) âœ“                       â”‚  â•‘
â•‘  â”‚ require(!executed) âœ“                                       â”‚  â•‘
â•‘  â”‚ require(balance &gt;= amount) âœ“                               â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ â†“ åŸ·è¡Œè½‰å¸³                                                  â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ 10 ETH â†’ 0xVendor...                                       â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ â†“ æ›´æ–°ç‹€æ…‹                                                  â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ Transaction #5                                             â”‚  â•‘
â•‘  â”‚ â”œâ”€ Status: EXECUTED âœ“                                      â”‚  â•‘
â•‘  â”‚ â””â”€ Executed at: Block #18,500,234                          â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ å¤šç°½éŒ¢åŒ…æ–°é¤˜é¡: 90 ETH                                       â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ Transaction Hash: 0x789xyz...                              â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                    â•‘
â•‘  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘  Step 5: é€šçŸ¥æ‰€æœ‰æŒæœ‰äºº                                            â•‘
â•‘  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚ äº‹ä»¶ç›£è½å™¨æª¢æ¸¬åˆ° TransactionExecuted äº‹ä»¶                    â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ ğŸ“§ Alice: "âœ“ äº¤æ˜“ #5 å·²åŸ·è¡Œ                                 â”‚  â•‘
â•‘  â”‚          10 ETH å·²ç™¼é€åˆ° 0xVendor..."                       â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ ğŸ“§ Bob: "âœ“ äº¤æ˜“ #5 å·²åŸ·è¡Œ                                   â”‚  â•‘
â•‘  â”‚        10 ETH å·²ç™¼é€åˆ° 0xVendor..."                         â”‚  â•‘
â•‘  â”‚                                                             â”‚  â•‘
â•‘  â”‚ ğŸ“§ Carol: "â„¹ï¸ äº¤æ˜“ #5 å·²åŸ·è¡Œï¼ˆä½ æœªåƒèˆ‡ç¢ºèªï¼‰                â”‚  â•‘
â•‘  â”‚          10 ETH å·²ç™¼é€åˆ° 0xVendor..."                       â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                    â•‘
â•‘  ã€å®Œæˆã€‘æ•´å€‹å¤šç°½æµç¨‹çµæŸ                                           â•‘
â•‘                                                                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
</code></pre>
<hr />
<h2 id="ç¸½çµèˆ‡å­¸ç¿’å»ºè­°"><a class="header" href="#ç¸½çµèˆ‡å­¸ç¿’å»ºè­°">ç¸½çµèˆ‡å­¸ç¿’å»ºè­°</a></h2>
<h3 id="æ ¸å¿ƒçŸ¥è­˜é»å›é¡§"><a class="header" href="#æ ¸å¿ƒçŸ¥è­˜é»å›é¡§">æ ¸å¿ƒçŸ¥è­˜é»å›é¡§</a></h3>
<p>æœ¬æ–‡æª”æ¶µè“‹äº†å€å¡ŠéˆéŒ¢åŒ…é–‹ç™¼çš„å®Œæ•´çŸ¥è­˜é«”ç³»ï¼š</p>
<p>âœ… <strong>åŸºç¤åŸç†</strong></p>
<ul>
<li>Hash å‡½æ•¸ã€P2P ç¶²çµ¡ã€å…±è­˜æ©Ÿåˆ¶</li>
<li>Block Number èˆ‡ Transaction Hash çš„æ·±åº¦æ‡‰ç”¨</li>
<li>UTXO vs Account æ¨¡å‹å°æ¯”</li>
</ul>
<p>âœ… <strong>æ ¸å¿ƒæŠ€è¡“</strong>ï¼ˆç™½æ¿è¨è«–é‡é»ï¼‰</p>
<ul>
<li><strong>å¤šå±¤èª¿ç”¨æ©Ÿåˆ¶</strong> - ç‚ºä»€éº¼éŒ¢åŒ…åªéœ€è™•ç†ç¬¬ä¸€å±¤</li>
<li>äº¤æ˜“ç”Ÿå‘½é€±æœŸå®Œæ•´æµç¨‹</li>
<li>Nonce ç®¡ç†ç­–ç•¥</li>
<li>Gas æ©Ÿåˆ¶èˆ‡å„ªåŒ–æŠ€å·§</li>
</ul>
<p>âœ… <strong>å¯†é‘°ç®¡ç†</strong></p>
<ul>
<li>HD Wallet (BIP32/39/44) å®Œæ•´å¯¦ç¾</li>
<li>ç§é‘°å®‰å…¨å­˜å„²ï¼ˆKeystoreï¼‰</li>
<li>åœ°å€ç”Ÿæˆæµç¨‹</li>
</ul>
<p>âœ… <strong>å¤šç°½éŒ¢åŒ…</strong>ï¼ˆç™½æ¿é‡é»ï¼‰</p>
<ul>
<li>åŸç†èˆ‡æ¶æ§‹</li>
<li>æ™ºèƒ½åˆç´„å¯¦ç¾</li>
<li>å¯¦éš›ä½¿ç”¨å ´æ™¯ï¼ˆä¼æ¥­/DAO/å€‹äººï¼‰</li>
</ul>
<p>âœ… <strong>å®‰å…¨å¯¦è¸</strong></p>
<ul>
<li>äº¤æ˜“é©—è­‰</li>
<li>é‡£é­šé˜²ç¯„</li>
<li>éŒ¯èª¤è™•ç†</li>
</ul>
<p>âœ… <strong>å®Œæ•´æ¶æ§‹</strong></p>
<ul>
<li>ç³»çµ±åˆ†å±¤æ¶æ§‹åœ–</li>
<li>äº¤æ˜“æµç¨‹åœ–</li>
<li>å¤šç°½éŒ¢åŒ…å·¥ä½œæµç¨‹</li>
</ul>
<h3 id="å­¸ç¿’è·¯å¾‘å»ºè­°"><a class="header" href="#å­¸ç¿’è·¯å¾‘å»ºè­°">å­¸ç¿’è·¯å¾‘å»ºè­°</a></h3>
<h4 id="åˆç´š1-2å€‹æœˆ"><a class="header" href="#åˆç´š1-2å€‹æœˆ">åˆç´šï¼ˆ1-2å€‹æœˆï¼‰</a></h4>
<ol>
<li>âœ… ç†è§£ Hashã€å€å¡Šéˆã€P2P åŸºç¤æ¦‚å¿µ</li>
<li>âœ… å­¸ç¿’æ¯”ç‰¹å¹£ UTXO å’Œä»¥å¤ªåŠ Account æ¨¡å‹</li>
<li>âœ… æŒæ¡ç§é‘°ã€å…¬é‘°ã€åœ°å€ç”Ÿæˆ</li>
<li>âœ… æœƒä½¿ç”¨ MetaMask ç™¼é€äº¤æ˜“</li>
</ol>
<h4 id="ä¸­ç´š3-6å€‹æœˆ"><a class="header" href="#ä¸­ç´š3-6å€‹æœˆ">ä¸­ç´šï¼ˆ3-6å€‹æœˆï¼‰</a></h4>
<ol>
<li>âœ… å¯¦ç¾ HD Wallet (BIP39/BIP44)</li>
<li>âœ… ç†è§£ Transaction Hash, Block Number æ„ç¾©</li>
<li>âœ… æŒæ¡ eth_call å’Œ eth_sendTransaction</li>
<li>âœ… è™•ç†å¸¸è¦‹éŒ¯èª¤ï¼ˆGasã€Nonceã€é¤˜é¡ï¼‰</li>
<li>âœ… æ•´åˆ Web3.js/ethers.js</li>
<li>âœ… ç†è§£å¤šå±¤èª¿ç”¨æ©Ÿåˆ¶</li>
</ol>
<h4 id="é«˜ç´š6-12å€‹æœˆ"><a class="header" href="#é«˜ç´š6-12å€‹æœˆ">é«˜ç´šï¼ˆ6-12å€‹æœˆï¼‰</a></h4>
<ol>
<li>âœ… Debug Bytecode åˆ†æäº¤æ˜“å¤±æ•—</li>
<li>âœ… è™•ç†å¤šå±¤åˆç´„èª¿ç”¨</li>
<li>âœ… Gas å„ªåŒ–ç­–ç•¥</li>
<li>âœ… å¯¦ç¾å¤šç°½éŒ¢åŒ…</li>
<li>âœ… å¤šéˆéŒ¢åŒ…æ¶æ§‹</li>
<li>âœ… å®‰å…¨å¯©è¨ˆèˆ‡æ¼æ´é˜²ç¯„</li>
</ol>
<h3 id="å¯¦è¸å»ºè­°"><a class="header" href="#å¯¦è¸å»ºè­°">å¯¦è¸å»ºè­°</a></h3>
<ol>
<li><strong>å‹•æ‰‹å¯¦è¸</strong> - å‰µå»ºè‡ªå·±çš„éŒ¢åŒ…æ‡‰ç”¨</li>
<li><strong>é–±è®€æºç¢¼</strong> - ç ”ç©¶ MetaMaskã€Gnosis Safe ç­‰é–‹æºé …ç›®</li>
<li><strong>é—œæ³¨æ›´æ–°</strong> - è·Ÿé€² EIP ææ¡ˆã€å”è­°å‡ç´š</li>
<li><strong>å®‰å…¨è‡³ä¸Š</strong> - å®šæœŸå¯©è¨ˆã€æ¸¬è©¦</li>
<li><strong>ç¤¾å€åƒèˆ‡</strong> - åŠ å…¥ Discordã€è«–å£‡è¨è«–</li>
</ol>
<h3 id="ç›¸é—œè³‡æº"><a class="header" href="#ç›¸é—œè³‡æº">ç›¸é—œè³‡æº</a></h3>
<ul>
<li><strong>ä»¥å¤ªåŠå®˜æ–¹æ–‡æª”</strong>: https://ethereum.org/developers</li>
<li><strong>EIP ææ¡ˆ</strong>: https://eips.ethereum.org</li>
<li><strong>OpenZeppelin åˆç´„</strong>: https://docs.openzeppelin.com</li>
<li><strong>Web3.js æ–‡æª”</strong>: https://web3js.readthedocs.io</li>
<li><strong>Ethers.js æ–‡æª”</strong>: https://docs.ethers.org</li>
<li><strong>Gnosis Safe</strong>: https://github.com/safe-global/safe-contracts</li>
</ul>
<hr />
<blockquote>
<p>ğŸ’¡ <strong>æ–‡æª”èªªæ˜</strong>ï¼šé€™ä»½å®Œæ•´æ–‡æª”æ•´åˆäº†ç™½æ¿è¨è«–çš„æ‰€æœ‰æ ¸å¿ƒè¦é»ï¼Œ
ç‰¹åˆ¥æ˜¯ <strong>Block Number</strong>ã€<strong>Transaction Hash</strong>ã€<strong>å¤šå±¤èª¿ç”¨æ©Ÿåˆ¶</strong> å’Œ <strong>å¤šç°½éŒ¢åŒ…</strong>ã€‚</p>
<p>æŒçºŒæ›´æ–°ä¸­ï¼Œæ­¡è¿åé¥‹ï¼</p>
</blockquote>
<p><strong>æ–‡æª”ç‰ˆæœ¬</strong>: v1.0<br />
<strong>æœ€å¾Œæ›´æ–°</strong>: 2024-11-13<br />
<strong>ç¸½å­—æ•¸</strong>: ç´„ 15 è¬å­—<br />
<strong>ä»£ç¢¼ç¤ºä¾‹</strong>: 50+ å€‹<br />
<strong>æ¶æ§‹åœ–</strong>: 10+ å€‹</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../blockchain/blockchain-wallet-guide.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../blockchain/blockchain-wallet-implementation.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../blockchain/blockchain-wallet-guide.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../blockchain/blockchain-wallet-implementation.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="../ace.js"></script>
        <script src="../mode-rust.js"></script>
        <script src="../editor.js"></script>
        <script src="../theme-dawn.js"></script>
        <script src="../theme-tomorrow_night.js"></script>

        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../mermaid.min.js"></script>
        <script src="../mermaid-init.js"></script>



    </div>
    </body>
</html>
