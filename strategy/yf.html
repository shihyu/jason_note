<!DOCTYPE HTML>
<html lang="zh" class="rust sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>yfinance - Jason Notes</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "rust";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Jason Notes</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/shihyu/jason_note" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h3 id="python-學習筆記--用-yfinance-套件取得股票資料"><a class="header" href="#python-學習筆記--用-yfinance-套件取得股票資料">Python 學習筆記 : 用 yfinance 套件取得股票資料</a></h3>
<p>出處: https://yhhuang1966.blogspot.com/2022/09/python-yfinance.html</p>
<p>yfinance 的原始碼寄存於 GitHub :</p>
<p># https://github.com/ranaroussi/yfinance</p>
<p>本篇測試參考了下面的文章 :</p>
<p># <a href="https://havocfuture.tw/blog/python-stock-history">如何使用Python取得歷史股價，簡介yfinance、ffn、FinMind</a></p>
<p># <a href="https://aronhack.com/zh/retrieve-stock-historical-data-with-python-and-yahoo-finance-api/">使用Python及Yahoo Finance API抓取臺股歷史資料</a></p>
<p># <a href="https://towardsdatascience.com/free-stock-data-for-python-using-yahoo-finance-api-9dafd96cad2e">Free Stock Data for Python Using Yahoo Finance API</a></p>
<p># <a href="https://pythonviz.com/finance/yfinance-download-stock-data/">yfinance 攻略！Python 下載股票價格數據無難度</a></p>
<p>根據第二篇與第三篇的說明, Yahoo Finance API 的限制是 :</p>
<ul>
<li>每個 IP 每小時的請求上限是 2000 次</li>
<li>每個 IP 單日請求上限是 48000 次</li>
</ul>
<p>比較務實的做法是自己建立資料庫, 利用 yfinance 擷取資料後儲存於資料庫, 以後就只要抓當日的新資料添加到資料庫中即可.</p>
<p><strong>1. 在 Windows 上安裝 yfinance :</strong></p>
<p>Windows 的安裝指令如下 :</p>
<p><strong>pip install yfinance</strong></p>
<p>可見 yfinance 是建立在 requests,lxml, numpy 與 Pandas 等套件的基礎上.</p>
<p><strong>2. 在樹莓派上安裝 yfinance :</strong></p>
<p>由於程式最終是要在樹莓派上奔跑, 所以也要在 Raspbian 上安裝看看, 安裝指令要用 pip3, 因為 pip 是給內建的 Python 2 用的 :</p>
<p>pi@raspberrypi:~ $ <strong>pip3 install yfinance</strong></p>
<p>基本上不會有問題, 有的話可能是其相依套件例如 requests 等之版本匹配問題.</p>
<p><strong>3. 在 Colab 上安裝 yfinance :</strong></p>
<p>在 Colab 也可以安裝 yfinance, 指令如下 :</p>
<p><strong>!pip install yfinance</strong></p>
<p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiuqeNyEu3bwFMwRNZCdD4Ghi8dTk-95Hsz3gdje0ztWSfNMgp5MEhOOJR3mIhEOt8CFZJgxjCU2A37j6czOSK0_u21TWRrD1v_4vADQ4hZ-Fe6g4OwS1BrCl03awLlEpy6PjZDYVHBP1Do2svE21PsoVlUj5zCEvcvlAQfWgfpYusjquM3F6zktdIlfw/s1315/colab-install-yfinance.jpg"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiuqeNyEu3bwFMwRNZCdD4Ghi8dTk-95Hsz3gdje0ztWSfNMgp5MEhOOJR3mIhEOt8CFZJgxjCU2A37j6czOSK0_u21TWRrD1v_4vADQ4hZ-Fe6g4OwS1BrCl03awLlEpy6PjZDYVHBP1Do2svE21PsoVlUj5zCEvcvlAQfWgfpYusjquM3F6zktdIlfw/s320/colab-install-yfinance.jpg" alt="img" /></a></p>
<p>在 Colab 上跑 Python 的一個好處是列印格式很整齊. 關於 Colab 用法參考 :</p>
<p># <a href="https://yhhuang1966.blogspot.com/2020/04/python-jupyter-notebook-colaborator.html">Python 學習筆記 : 谷歌版的線上 Jupyter Notebook (Colaboratory)</a></p>
<p><strong>4. 檢視 yfinance 的內容 :</strong></p>
<p>先來檢視 ylfinance 套件的內容, 以下使用一個自訂模組 members, 其 list_members() 函式會列出模組或套件中的公開成員 (即屬性與方法), 參考 :</p>
<p># <a href="https://yhhuang1966.blogspot.com/2022/03/python.html">Python 學習筆記 : 檢視物件成員與取得變數名稱字串的方法</a></p>
<p>使用 yfinance 前須先用 import 匯入, 通常取別名為 yf :</p>
<p>&gt;&gt;&gt; <strong>import yfinance as yf</strong></p>
<p>&gt;&gt;&gt; <strong>import members</strong></p>
<p>&gt;&gt;&gt; <strong>members.list_members(yf)</strong></p>
<p>Ticker &lt;class 'type'&gt;</p>
<p>Tickers &lt;class 'type'&gt;</p>
<p>base &lt;class 'module'&gt;</p>
<p>download &lt;class 'function'&gt;</p>
<p>multi &lt;class 'module'&gt;</p>
<p>pdr_override &lt;class 'function'&gt;</p>
<p>shared &lt;class 'module'&gt;</p>
<p>ticker &lt;class 'module'&gt;</p>
<p>tickers &lt;class 'module'&gt;</p>
<p>utils &lt;class 'module'&gt;</p>
<p>version &lt;class 'module'&gt;</p>
<p>其中 download() 函式與 Ticker 類別是最常用的, 利用 download() 函式可取得股票的歷史價量資料; 而使用 Ticker 類別則不僅可取得歷史價量資料, 還可取得股票更詳細的金融資訊, 例如公司基本資訊, 大戶與法人持股比例, 損益表, 資產負債表, 現金流量表等財報資料.</p>
<p><strong>5. 用 yf.download() 下載股票日收盤價量資料 :</strong></p>
<p>呼叫 yf.download() 函式可取得 Yahoo Finance 提供的股票歷史日收盤價量資訊, 其傳回值為一個 Pandas 的 DataFrame 物件, 這對進行技術分析與線圖繪製非常方便, 語法如下 :</p>
<p><strong>df=yf.download(symbol [, start, end] [, period, interval])</strong></p>
<p>其參數說明如下表 :</p>
<div class="table-wrapper"><table><thead><tr><th>download() 參數</th><th>說明</th></tr></thead><tbody>
<tr><td>symbol</td><td>股票代號 (字串), 美股例如 'AMD' (超微), 臺股後面要加 '.tw', 例如 '0050.tw'</td></tr>
<tr><td>start</td><td>起始日期 YYYY-MM-DD (字串), 例如 '2022-08-22'</td></tr>
<tr><td>end</td><td>結束日期 YYYY-MM-DD (字串), 例如 '2022-09-06', 注意, 不包含此日資料</td></tr>
<tr><td>period</td><td>期間, 可用 d (日), mo(月), y(年), ytd, max(全部), 例如 5d (5 天), 3mo(三個月)</td></tr>
<tr><td>interval</td><td>頻率, 可用 m(分), h(小時), d(日), wk(周), mo(月), 例如 1m(一分線)</td></tr>
</tbody></table>
</div>
<p>必要參數 symbol 表示商品名稱代號, 例如特斯拉是 'TSLA', 微軟是 'MSF' 等, 如果是臺股, 必須在臺股股票代號後面要加上 '.TW' 或 '.tw' (大小寫均可), 例如臺積電是 '2330.TW', 臺灣五十是 '0050.TW' 等等.</p>
<p>四個備選參數有三個使用模式, 第一組是 [start, end] 用於指定特定起迄日期的日收盤資料 (end 不含); 第二組是 [period, interval] 用來指定最近一段時間內某個頻率的歷史資料 (ticker); 第三組是 [start, end, interval] 用來指定特定起迄日期內特定頻率的資料.</p>
<p>如果只傳入 symbol 參數, 則會傳回該股票所有的歷史日收盤價量資料之 DataFrame 物件, 例如 :</p>
<p>&gt;&gt;&gt; <strong>import pandas as pd</strong></p>
<p>&gt;&gt;&gt; <strong>import yfinance as yf</strong></p>
<p>&gt;&gt;&gt; <strong>df=yf.download('TSLA')</strong>    # 下載特斯拉 TSLA 全部歷史價量資料</p>
<p>[<em><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>100%</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></em>**] 1 of 1 completed</p>
<p>&gt;&gt;&gt; <strong>type(df)</strong></p>
<p>&lt;class 'pandas.core.frame.DataFrame'&gt;</p>
<p>&gt;&gt;&gt; <strong>df</strong></p>
<p>​         Open    High ...  Adj Close   Volume</p>
<p>Date                ...</p>
<p>2010-06-29  1.266667  1.666667 ...  1.592667 281494500</p>
<p>2010-06-30  1.719333  2.028000 ...  1.588667 257806500</p>
<p>2010-07-01  1.666667  1.728000 ...  1.464000 123282000</p>
<p>2010-07-02  1.533333  1.540000 ...  1.280000  77097000</p>
<p>2010-07-06  1.333333  1.333333 ...  1.074000 103003500</p>
<p>...        ...     ... ...     ...    ...</p>
<p>2022-08-30 287.869995 288.480011 ... 277.700012  50541800</p>
<p>2022-08-31 280.619995 281.250000 ... 275.609985  52107300</p>
<p>2022-09-01 272.579987 277.579987 ... 277.160004  54287000</p>
<p>2022-09-02 281.070007 282.350006 ... 270.209991  50752200</p>
<p>2022-09-06 272.679993 275.989990 ... 274.420013  55762000</p>
<p>[3069 rows x 6 columns]</p>
<p>可見 yf.download('TSLA') 會傳回特斯拉自 2010-06-29 上市以來的全部歷史價量資料 (10 年來股價上漲 200 多倍, 嚇鼠), 但因資料總欄寬與總列數超過 Pandas 的預設值, 故會用 ... 表示隱藏省略掉的欄位. 總資料筆數共 3069 筆, 但只會顯示頭尾各五筆. 若要顯示全部欄位須要用下列 Pandas 的 set_option() 函式設定 :</p>
<p><strong>pd.set_option('display.max_columns', None)</strong>   # 顯示全部欄位</p>
<p><strong>pd.set_option('display.width', 1000)</strong>          # 設定總欄寬為 1000 px</p>
<p>注意,總欄寬若設得太小, 後面超出的欄位會反折, 故可能需要嘗試將 display.width 再放寬.</p>
<p>參考 :</p>
<p># <a href="https://towardsdatascience.com/how-to-show-all-columns-rows-of-a-pandas-dataframe-c49d4507fcf">How to show all columns / rows of a Pandas Dataframe?</a></p>
<p># <a href="https://stackoverflow.com/questions/11707586/how-do-i-expand-the-output-display-to-see-more-columns-of-a-pandas-dataframe">How do I expand the output display to see more columns of a Pandas DataFrame?</a></p>
<p>例如 :</p>
<p>&gt;&gt;&gt; <strong>pd.set_option('display.max_columns', None)</strong></p>
<p>&gt;&gt;&gt; <strong>pd.set_option('display.width', 1000)</strong></p>
<p>&gt;&gt;&gt; <strong>df</strong></p>
<p>​         Open    High     Low    Close  Adj Close   Volume</p>
<p>Date</p>
<p>2010-06-29  1.266667  1.666667  1.169333  1.592667  1.592667 281494500</p>
<p>2010-06-30  1.719333  2.028000  1.553333  1.588667  1.588667 257806500</p>
<p>2010-07-01  1.666667  1.728000  1.351333  1.464000  1.464000 123282000</p>
<p>2010-07-02  1.533333  1.540000  1.247333  1.280000  1.280000  77097000</p>
<p>2010-07-06  1.333333  1.333333  1.055333  1.074000  1.074000 103003500</p>
<p>...        ...     ...     ...     ...     ...    ...</p>
<p>2022-08-30 287.869995 288.480011 272.649994 277.700012 277.700012  50541800</p>
<p>2022-08-31 280.619995 281.250000 271.809998 275.609985 275.609985  52107300</p>
<p>2022-09-01 272.579987 277.579987 266.149994 277.160004 277.160004  54287000</p>
<p>2022-09-02 281.070007 282.350006 269.079987 270.209991 270.209991  50752200</p>
<p>2022-09-06 272.679993 275.989990 265.739990 274.420013 274.420013  55762000</p>
<p>[3069 rows x 6 columns]</p>
<p>這樣就能顯示全部欄位了, 可見 yf.download() 所下載的資料總共包含七個欄位 :</p>
<ul>
<li>Date (日期)</li>
<li>Open (開盤價)</li>
<li>High (最高價)</li>
<li>Low (最低價)</li>
<li>Close (收盤價)</li>
<li>Adj Close (調整後之收盤價)</li>
<li>Volumn (成交量 : 股數)</li>
</ul>
<p>這些資料可以直接拿來繪製技術分析線圖.</p>
<p>頭尾五筆也可以用 pd.head() 與 pd.tail() 顯示 (也可傳入筆數) :</p>
<p>&gt;&gt;&gt; <strong>df.head()</strong></p>
<p>​        Open   High    Low   Close Adj Close   Volume</p>
<p>Date</p>
<p>2010-06-29 1.266667 1.666667 1.169333 1.592667  1.592667 281494500</p>
<p>2010-06-30 1.719333 2.028000 1.553333 1.588667  1.588667 257806500</p>
<p>2010-07-01 1.666667 1.728000 1.351333 1.464000  1.464000 123282000</p>
<p>2010-07-02 1.533333 1.540000 1.247333 1.280000  1.280000  77097000</p>
<p>2010-07-06 1.333333 1.333333 1.055333 1.074000  1.074000 103003500</p>
<p>&gt;&gt;&gt; <strong>df.tail()</strong></p>
<p>​         Open    High     Low    Close  Adj Close  Volume</p>
<p>Date</p>
<p>2022-08-30 287.869995 288.480011 272.649994 277.700012 277.700012 50541800</p>
<p>2022-08-31 280.619995 281.250000 271.809998 275.609985 275.609985 52107300</p>
<p>2022-09-01 272.579987 277.579987 266.149994 277.160004 277.160004 54287000</p>
<p>2022-09-02 281.070007 282.350006 269.079987 270.209991 270.209991 50752200</p>
<p>2022-09-06 272.679993 275.989990 265.739990 274.420013 274.420013 55762000</p>
<p>如果使用 JupyterLab 或 Colab 會完整顯示所有欄位, 不需要設定 Pandas :</p>
<p>yf.download() 可以傳入的備選參數來指定資料期間或頻率, 這些參數地用法分成 [start, end], [period, interval], 與 [start, end, interval] 兩個模式 :</p>
<p><strong>(1). Start-end 模式 :</strong></p>
<p>呼叫 yf.download() 時傳入起始 start 與結束 end 日期兩個參數, 這會傳回該期間日收盤之價量資料 (注意, 所下載的資料不含 end 那天, 只到其前一天), 例如指定下載 2022-08-24 至 2022-09-07 的歷史資料 :</p>
<p>&gt;&gt;&gt; <strong>import yfinance as yf</strong></p>
<p>&gt;&gt;&gt; <strong>df=yf.download('0050.tw', start='2022-08-24', end='2022-09-07')</strong></p>
<p>[<em><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>100%</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></em>**] 1 of 1 completed</p>
<p>&gt;&gt;&gt; <strong>df</strong></p>
<pre><code>         Open    High     Low    Close  Adj Close  Volume
Date                                      
2022-08-24 118.800003 118.949997 117.650002 117.900002 117.900002  7063478
2022-08-25 118.500000 119.449997 118.449997 119.000000 119.000000  4893719
</code></pre>
<p>因為 end='2022-09-07' 這天的資料不包含, 故只會抓 '2022-08-24' 至 '2022-09-06' 的資料. 一般來說, 當日臺股資料大約 16:00 左右就可以抓到了.</p>
<p>也可以搭配 datetime 模組來設定 start 與 end 參數, 例如下載過去 60 天的資料 :</p>
<p>&gt;&gt;&gt; <strong>import datetime</strong></p>
<p>&gt;&gt;&gt; <strong>import yfinance as yf</strong></p>
<p>&gt;&gt;&gt; <strong>start=datetime.datetime.now() - datetime.timedelta(days=60)</strong></p>
<p>&gt;&gt;&gt; <strong>end=datetime.date.today()</strong></p>
<p>&gt;&gt;&gt; <strong>df=yf.download('2330.tw', start, end)</strong></p>
<p>[<em><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>100%</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></em>**] 1 of 1 completed</p>
<p>&gt;&gt;&gt; <strong>df.head()</strong></p>
<pre><code>       Open  High  Low Close  Adj Close  Volume
Date                            
2022-07-18 495.5 498.5 488.5 495.5 492.661224 39179575
2022-07-19 487.5 493.0 486.5 491.0 488.186981 19874865
</code></pre>
<p>此處使用 datetime.timedelta() 來設定過去一段時間間隔以取得那時的時戳.</p>
<p><strong>(2). Period-interval 模式 :</strong></p>
<p>此模式是傳入 period 與 interval 兩個參數, period 是一個表示最近的一段期間的字串, 由一個整數與單位字串組成, 可用的單位如下 :</p>
<ul>
<li>'d' : 天數, 例如 '5d' 表示近五日, '20d' 表示近 20 日</li>
<li>'mo' : 月數, 例如 '1mo' 表示近一個月, '3mo' 表示近 3 個月</li>
<li>'y' : 年數, 例如 '1y' 表示近一年, '3y' 表示近 3 年</li>
<li>'ytd' : 今年以來, 即自年初第一個交易日至今</li>
<li>'max' : 所有時間資料</li>
</ul>
<p>而 interval 則是用來指定資料的頻率, 也是由一個整數與單位字串組成, 可用的單位如下 :</p>
<ul>
<li>'m' : 每幾分鐘, 例如 '1m' 為每一分鐘</li>
<li>'h' : 每幾小時, 例如 '3h' 為每三小時</li>
<li>'d' : 每幾天, 例如 '1d' 為每天</li>
<li>'wk' : 每幾周, 例如 '1wk' 為每週</li>
<li>'mo' : 每幾月, 例如 '1mo' 為每個月</li>
</ul>
<p>例如要抓過去十天每日價量資料 :</p>
<p>&gt;&gt;&gt; <strong>df=yf.download('0050.TW', period='10d', interval='1d')</strong>   # 過去 10 天, 每天</p>
<p>[<em><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>100%</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></em>**] 1 of 1 completed</p>
<p>&gt;&gt;&gt; <strong>df</strong></p>
<pre><code>         Open    High     Low    Close  Adj Close  Volume
Date                                      
2022-08-25 118.500000 119.449997 118.449997 119.000000 119.000000  4893719
2022-08-26 119.849998 120.099998 119.449997 119.599998 119.599998  9959737
</code></pre>
<p>這與 start='2022-08-25', end='2022-09-08' 的結果一樣, 例如 :</p>
<p>&gt;&gt;&gt; <strong>df=yf.download('0050.tw', start='2022-08-25', end='2022-09-08')</strong></p>
<p>[<em><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>100%</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></em>**] 1 of 1 completed</p>
<p>&gt;&gt;&gt; <strong>df</strong></p>
<pre><code>         Open    High     Low    Close  Adj Close  Volume
Date                                      
2022-08-25 118.500000 119.449997 118.449997 119.000000 119.000000  4893719
2022-08-26 119.849998 120.099998 119.449997 119.599998 119.599998  9959737
</code></pre>
<p>如果要取得今年以來的月收盤歷史資料, period 可用 'ytd', interval 則用 '1mo' :</p>
<p>&gt;&gt;&gt; <strong>df=yf.download('0050.TW', period='ytd', interval='1mo')</strong></p>
<p>[<em><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>100%</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></em>**] 1 of 1 completed</p>
<p>&gt;&gt;&gt; <strong>df</strong></p>
<pre><code>         Open    High     Low    Close  Adj Close   Volume
Date                                       
2022-02-01 141.550003 145.050003 137.850006 138.500000 138.500000 167881702
2022-03-01 139.050003 140.800003 131.000000 138.100006 138.100006 310811068
</code></pre>
<p>如果將 interval 設為 '1m' 則可取得每分鐘報價 (即一分 K 線), 不過 Yahoo Finance 只提供近七日內的一分 K 高頻交易數據, 例如 :</p>
<p>&gt;&gt;&gt; <strong>df=yf.download('0050.TW', period='1d', interval='1m')</strong></p>
<p>[<em><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>100%</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></em>**] 1 of 1 completed</p>
<p>&gt;&gt;&gt; <strong>df</strong></p>
<pre><code>                 Open    High     Low    Close  Adj Close Volume

Datetime                                           
2022-09-07 09:00:00+08:00 113.099998 113.150002 113.000000 113.150002 113.150002    0
2022-09-07 09:01:00+08:00 113.099998 113.150002 113.000000 113.000000 113.000000 222000
2022-09-07 13:30:00+08:00 112.199997 112.199997 112.199997 112.199997 112.199997    0

[266 rows x 6 columns]
</code></pre>
<p>若試圖下載超過 7 天的一分 K 資料會被拒絕 :</p>
<p>&gt;&gt;&gt; <strong>df=yf.download('0050.TW', period='8d', interval='1m')</strong></p>
<p>[<em><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>100%</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></em>**] 1 of 1 completed</p>
<p>1 Failed download:</p>
<p>- 0050.TW: 1m data not available for startTime=1661902806 and endTime=1662594006. Only 7 days worth of 1m granularity data are allowed to be fetched per request.</p>
<p><strong>(3). Start-end-interval 模式 :</strong></p>
<p>其實 Start-end 模式也可以傳入 interval 參數來指定期間內的資料頻率, 例如下載 2022-09-06 與 2022-09-07 這兩天的五分 K 資料 (interval='5m') 可以這麼做 :</p>
<p>&gt;&gt;&gt; <strong>df=yf.download('0050.TW', start='2022-09-06', end='2022-09-08', interval='5m')</strong></p>
<p>[<em><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>100%</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></em>**] 1 of 1 completed</p>
<p>&gt;&gt;&gt; <strong>df</strong></p>
<pre><code>                 Open    High     Low    Close  Adj Close Volume
Datetime                                           
2022-09-06 09:00:00+08:00 114.800003 115.250000 114.800003 115.250000 115.250000    0
2022-09-06 09:05:00+08:00 115.300003 115.400002 115.099998 115.150002 115.150002 150000
</code></pre>
<p>如果要取得周收盤資料可以用 interval='1wk', 傳回資料的列索引會以週一那天為代表, 開盤價取週一的 Open, 收盤價取週五那天的 Close, 最高價取週一至週五的 High 中最大的, 最低價取週一至週五的 Low 中最小的, 而周成交量則是週一至週五成交量總和.</p>
<p>例如 2022-07-04 到 2022-09-08 的周收盤資料 :</p>
<p>&gt;&gt;&gt; <strong>df=yf.download('0050.TW', start='2022-07-04', end='2022-09-09', interval='1wk')</strong></p>
<p>[<em><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>100%</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></em>**] 1 of 1 completed</p>
<p>&gt;&gt;&gt; <strong>df</strong></p>
<pre><code>         Open    High     Low    Close  Adj Close  Volume

Date                                      
2022-07-04 111.250000 113.900002 108.449997 113.250000 113.250000 81880198
2022-07-11 113.650002 115.650002 109.150002 115.500000 115.500000 76837034
2022-07-18 114.650002 117.199997 113.599998 116.800003 116.800003 76713181
</code></pre>
<p>以其中的第一週 2022-07-04 這列為例, 周開盤價 111.25, 最高價 113.9, 最低價 108.45, 收盤價 113.25, 這可查詢這一週的日收盤價來印證 :</p>
<p>&gt;&gt;&gt; <strong>df=yf.download('0050.TW', start='2022-07-04', end='2022-07-09')</strong></p>
<p>[<em><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>100%</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></em>**] 1 of 1 completed</p>
<p>&gt;&gt;&gt; <strong>df</strong></p>
<pre><code>         Open    High     Low    Close  Adj Close  Volume

Date                                      
2022-07-04 111.250000 112.199997 110.000000 110.449997 110.449997 26442712
2022-07-05 112.550003 112.949997 109.000000 111.000000 111.000000 16214458
2022-07-06 111.000000 111.050003 108.449997 108.849998 108.849998 15611981
2022-07-07 109.449997 112.150002 108.550003 112.099998 112.099998 13433190
2022-07-08 113.300003 113.900002 112.300003 113.250000 113.250000 10177857
</code></pre>
<p>可見周開盤價 111.25 取自週一 (2022-07-04) 的開盤價; 周最高價 113.9 出現在週五 (2022-07-08); 周最低價 118.45 出現在週三 (2022-07-06); 周收盤價 113.25 取自週五 (2022-07-08) 的收盤價; 而周成交量 81880198 則是週一至週五成交量之總和 :</p>
<p>&gt;&gt;&gt; <strong>sum(df['Volume'])</strong></p>
<p>81880198</p>
<p>月收盤資料也是類似, 月開盤價是該月第一個交易日的開盤價 (一律以 1 日為索引); 月最高價是該月每日 High 之最大者; 月最低價是該月每日 Low 之最小者; 月收盤價是該月最後一個交易日的收盤價; 月成交量則是該月每日成交量之總和, 以 2022 年七月為例 :</p>
<p>&gt;&gt;&gt; <strong>df=yf.download('0050.TW', start='2022-07-01', end='2022-09-01', interval='1mo')</strong></p>
<p>[<em><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>100%</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></em>**] 1 of 1 completed</p>
<p>&gt;&gt;&gt; <strong>df</strong></p>
<pre><code>         Open    High     Low    Close  Adj Close   Volume

Date                                       

2022-07-01 115.650002 118.500000 108.449997 118.000000 118.000000 317571855
2022-08-01 118.099998 122.300003 115.099998 117.599998 117.599998 208948196
2022-09-01 115.500000 115.599998 113.699997 114.900002 114.900002  50409932
</code></pre>
<p>月收盤資料一律會以該月 1 日當列索引, 以第一列的七月收盤為例, 可從檢視七月的日收盤資料來印證 :</p>
<p>&gt;&gt;&gt; <strong>df=yf.download('0050.TW', start='2022-07-01', end='2022-08-01')</strong></p>
<p>[<em><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>100%</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></em>**] 1 of 1 completed</p>
<p>&gt;&gt;&gt; <strong>df</strong></p>
<pre><code>         Open    High     Low    Close  Adj Close  Volume

Date                                      
2022-07-01 115.650002 115.650002 111.199997 111.550003 111.550003 34719560
2022-07-04 111.250000 112.199997 110.000000 110.449997 110.449997 26442712
2022-07-05 112.550003 112.949997 109.000000 111.000000 111.000000 16214458
</code></pre>
<p>可見月開盤價 115.65 為七月第一個交易日 2022-07-01 之開盤價; 月最高價 118.5 出現在最後交易日 2022-07-29 的 High; 月最低價 108.45 出現在 2022-07-06 的 Low; 月收盤價 118.0 為七月最後一個交易日 2022-07-29 之收盤價: 月成交量則是七月每個交易日成交量之總和, 可用內建函式 max(), min(), 與 sum() 來求得 :</p>
<pre><code>&gt;&gt;&gt; **max(df['High'])**  
118.5  
&gt;&gt;&gt; **min(df['Low'])**  
108.44999694824219  
&gt;&gt;&gt; **sum(df['Volume'])**  
317571855
</code></pre>
<p><strong>6. 用 Ticker 物件取得更多金融資訊 :</strong></p>
<p>Ticker 是 yfinance 套件中的一個類別, 呼叫其建構子 Ticker() 並傳入商品代號 (例如 'TSLA') 即可建立該商品之 Ticker 物件, 再用其屬性與方法取得歷史交易價量與財報資訊. 注意, 如果是查詢臺股標的, 須在臺股代號後面添加 ".TW", 例如 :</p>
<p>&gt;&gt;&gt; <strong>import yfinance as yf</strong></p>
<p>&gt;&gt;&gt; <strong>type(yf.Ticker)</strong></p>
<p>&lt;class 'type'&gt;</p>
<p>&gt;&gt;&gt; <strong>tsla=yf.Ticker('TSLA')</strong>          # 美股 Tesla</p>
<p>&gt;&gt;&gt; type(tsla)</p>
<p>&lt;class 'yfinance.ticker.Ticker'&gt;</p>
<p>&gt;&gt;&gt; <strong>tw2330=yf.Ticker("2330.TW")</strong>    # 臺積電</p>
<p>&gt;&gt;&gt; <strong>type(tw2330)</strong></p>
<p>&lt;class 'yfinance.ticker.Ticker'&gt;</p>
<p>可見 Ticker() 會建立並傳回一個 Ticker 物件, 以下使用一個自訂模組 members 來檢視 Ticker 物件的內容, 其 list_members() 函式會列出模組或套件中的公開成員 (即屬性與方法), 參考 :</p>
<p># <a href="https://yhhuang1966.blogspot.com/2022/03/python.html">Python 學習筆記 : 檢視物件成員與取得變數名稱字串的方法</a></p>
<p>例如 :</p>
<p>&gt;&gt;&gt; <strong>import members</strong></p>
<p>&gt;&gt;&gt; <strong>tw2330=yf.Ticker("2330.tw")</strong>     # 臺積電</p>
<p>&gt;&gt;&gt; <strong>members.list_members(tw2330)</strong></p>
<pre><code>actions &lt;class 'pandas.core.frame.DataFrame'&gt;

analysis &lt;class 'NoneType'&gt;

balance_sheet &lt;class 'pandas.core.frame.DataFrame'&gt;

balancesheet &lt;class 'pandas.core.frame.DataFrame'&gt;

calendar &lt;class 'NoneType'&gt;

cashflow &lt;class 'pandas.core.frame.DataFrame'&gt;

dividends &lt;class 'pandas.core.series.Series'&gt;

earnings &lt;class 'pandas.core.frame.DataFrame'&gt;

earnings_dates &lt;class 'pandas.core.frame.DataFrame'&gt;

earnings_history &lt;class 'NoneType'&gt;

financials &lt;class 'pandas.core.frame.DataFrame'&gt;

get_actions &lt;class 'method'&gt;

get_analysis &lt;class 'method'&gt;

get_balance_sheet &lt;class 'method'&gt;

get_balancesheet &lt;class 'method'&gt;

get_calendar &lt;class 'method'&gt;

get_cashflow &lt;class 'method'&gt;

get_dividends &lt;class 'method'&gt;

get_earnings &lt;class 'method'&gt;

get_earnings_dates &lt;class 'method'&gt;

get_earnings_history &lt;class 'method'&gt;

get_financials &lt;class 'method'&gt;

get_info &lt;class 'method'&gt;

get_institutional_holders &lt;class 'method'&gt;

get_isin &lt;class 'method'&gt;

get_major_holders &lt;class 'method'&gt;

get_mutualfund_holders &lt;class 'method'&gt;

get_news &lt;class 'method'&gt;

get_recommendations &lt;class 'method'&gt;

get_shares &lt;class 'method'&gt;

get_splits &lt;class 'method'&gt;

get_sustainability &lt;class 'method'&gt;

history &lt;class 'method'&gt;

info &lt;class 'dict'&gt;

institutional_holders &lt;class 'pandas.core.frame.DataFrame'&gt;

isin &lt;class 'str'&gt;

major_holders &lt;class 'pandas.core.frame.DataFrame'&gt;

mutualfund_holders &lt;class 'NoneType'&gt;

news &lt;class 'list'&gt;

option_chain &lt;class 'method'&gt;

options &lt;class 'tuple'&gt;

quarterly_balance_sheet &lt;class 'pandas.core.frame.DataFrame'&gt;

quarterly_balancesheet &lt;class 'pandas.core.frame.DataFrame'&gt;

quarterly_cashflow &lt;class 'pandas.core.frame.DataFrame'&gt;

quarterly_earnings &lt;class 'pandas.core.frame.DataFrame'&gt;

quarterly_financials &lt;class 'pandas.core.frame.DataFrame'&gt;

recommendations &lt;class 'NoneType'&gt;

session &lt;class 'NoneType'&gt;

shares &lt;class 'NoneType'&gt;

splits &lt;class 'pandas.core.series.Series'&gt;

stats &lt;class 'method'&gt;

sustainability &lt;class 'NoneType'&gt;

ticker &lt;class 'str'&gt;
</code></pre>
<p>常用屬性如下表 :</p>
<div class="table-wrapper"><table><thead><tr><th>Ticker 物件常用屬性</th><th>說明</th></tr></thead><tbody>
<tr><td>info</td><td>商品之綜合資訊 (字典)</td></tr>
<tr><td>major_holders</td><td>大戶持股比例</td></tr>
<tr><td>institutional_holders</td><td>機構法人持股比例</td></tr>
<tr><td>financials</td><td>近四年損益表 (DataFrame)</td></tr>
<tr><td>balance_sheet</td><td>近四年資產負債表 (DataFrame)</td></tr>
<tr><td>cashflow</td><td>近四年現金流量表 (DataFrame)</td></tr>
<tr><td>quarterly_financials</td><td>近四季損益表 (DataFrame)</td></tr>
<tr><td>quarterly_balancesheet</td><td>近四季資產負債表 (DataFrame)</td></tr>
<tr><td>quarterly_cashflow</td><td>近四季現金流量表 (DataFrame)</td></tr>
<tr><td>quarterly_earnings</td><td>近四年營收與獲利 (DataFrame)</td></tr>
<tr><td>recommendations</td><td>投資建議 (DataFrame)</td></tr>
<tr><td>dividends</td><td>歷年股息 (DataFrame)</td></tr>
<tr><td>earnings</td><td>歷年獲利 (DataFrame)</td></tr>
<tr><td>actions</td><td>歷年股息與股利 (DataFrame)</td></tr>
</tbody></table>
</div>
<p>常用方法如下表 :</p>
<div class="table-wrapper"><table><thead><tr><th>Ticker 物件常用方法</th><th>說明</th></tr></thead><tbody>
<tr><td>history()</td><td>傳回歷史價量資料</td></tr>
<tr><td>get_info()</td><td>傳回商品之綜合資訊 (字典)</td></tr>
<tr><td>get_financials()</td><td>傳回近四年損益表 (DataFrame)</td></tr>
<tr><td>get_balance_sheet()</td><td>傳回近四年資產負債表 (DataFrame)</td></tr>
<tr><td>get_cashflow()</td><td>傳回近四年現金流量表 (DataFrame)</td></tr>
<tr><td>get_shares()</td><td>傳回近四年流通股數 (DataFrame)</td></tr>
<tr><td>get_dividends()</td><td>傳回歷年股利 (DataFrame)</td></tr>
<tr><td>get_earnings()</td><td>傳回歷年獲利 (DataFrame)</td></tr>
<tr><td>get_major_holders()</td><td>傳回大戶持股比例 (DataFrame)</td></tr>
<tr><td>get_institutional_holders()</td><td>傳回機構法人持股比例 (DataFrame)</td></tr>
<tr><td>get_actions()</td><td>傳回歷年股息與股利 (DataFrame)</td></tr>
</tbody></table>
</div>
<p>其中最重要的是用來取得歷史價量資料的 history() 方法. 財報資料例如損益表 (financials), 資產負債表 (balance_sheet), 現金流量表 (cashflow), 流通股數 (shares), 股利 (dividends), 獲利 (earnings) 等可用屬性取得, 也可以呼叫方法取得. 以下會交替使用屬性與方法呼叫來取得這些資料.</p>
<p><strong>(1). 呼叫 history() 方法取得歷史價量資料 :</strong></p>
<p>history() 方法的功能與 download() 函式類似, 都是用來取得商品的價量資料, 同樣會傳回一個 Pandas 的 DataFrame, 語法如下 :</p>
<p><strong>df=ticker.history([start, end] [, period, interval])</strong></p>
<p>參數說明如下表 :</p>
<div class="table-wrapper"><table><thead><tr><th>history() 參數</th><th>說明</th></tr></thead><tbody>
<tr><td>start</td><td>起始日期 YYYY-MM-DD (字串), 例如 '2022-08-22'</td></tr>
<tr><td>end</td><td>結束日期 YYYY-MM-DD (字串), 例如 '2022-09-06', 注意, 不包含此日資料</td></tr>
<tr><td>period</td><td>期間, 可用 d (日), mo(月), y(年), ytd, max(全部), 例如 5d (5 天), 3mo(三個月)</td></tr>
<tr><td>interval</td><td>頻率, 可用 m(分), h(小時), d(日), wk(周), mo(月), 例如 1m(一分線)</td></tr>
<tr><td>actions</td><td>是否下載配息與配股事件 (布林值, 預設 True)</td></tr>
<tr><td>auto_adjust</td><td>是否自動調整所有 OHLC 值 (布林值, 預設 True)</td></tr>
<tr><td>prepost</td><td>是否包含 Pre 與 Post 之市場資料 (布林值, 預設 False)</td></tr>
</tbody></table>
</div>
<p>常用的參數為前四個 (後三個都是有預設值的布林值), 用法與 download() 函式一樣, 同樣分成 Start-end, Period-interval, 以及 Start-end-interval 三種模式, 如果沒有傳入任何參數, 預設傳回近一個月的歷史資料, 例如 :</p>
<p>&gt;&gt;&gt; <strong>tw2330.history()</strong></p>
<pre><code>       Open  High  Low Close  Volume Dividends Stock Splits
Date                                   
2022-08-08 510.0 515.0 509.0 512.0 19333128     0       0
2022-08-09 507.0 511.0 504.0 510.0 21164373     0       0
2022-08-10 500.0 503.0 499.5 500.0 20861380     0       0
</code></pre>
<p>可見 history() 方法與 download() 函式取得的資料類似, 都有 OHLCV (但缺了調整收盤價), 而且多出 Dividends 與 Stock Splits 欄位 (因為 actions 參數預設為 True, 如果傳入 actions=False 就不會出現這兩欄了). 可惜臺股似乎只是聊備一格沒資料, 但美股就有, 例如 :</p>
<p>&gt;&gt;&gt; <strong>tsla.history()</strong></p>
<pre><code>         Open    High     Low    Close  Volume Dividends Stock Splits
Date                                             
2022-08-10 297.066681 297.510010 283.369995 294.356659 94918800     0      0.0
2022-08-11 296.513336 298.236664 285.833344 286.630005 70155000     0      0.0
2022-08-12 289.416656 300.160004 285.033325 300.029999 79657200     0      0.0
</code></pre>
<p>特斯拉的 Dividends 都是 0, 這不是沒資料, 而是該公司從未配息.</p>
<p>Start-end 模式是傳入起迄日期內的歷史資料 (不含 end 那一天), 例如 :</p>
<p>&gt;&gt;&gt; <strong>tw2330.history(start='2022-08-24', end='2022-09-07')</strong></p>
<p>​       Open  High  Low Close  Volume Dividends Stock Splits</p>
<p>Date</p>
<p>2022-08-24 504.0 508.0 503.0 503.0 14363212     0       0</p>
<p>2022-08-25 505.0 510.0 504.0 508.0  9357138     0       0</p>
<p>2022-08-26 513.0 515.0 511.0 512.0 12914846     0       0</p>
<p>2022-08-29 497.0 502.0 496.0 498.5 26590824     0       0</p>
<p>2022-08-30 497.5 500.0 496.0 496.0 24214535     0       0</p>
<p>2022-08-31 492.0 505.0 492.0 505.0 39357089     0       0</p>
<p>2022-09-01 495.0 495.5 490.0 490.5 39168672     0       0</p>
<p>2022-09-02 488.0 489.5 485.0 485.0 29982959     0       0</p>
<p>2022-09-05 485.0 488.0 484.0 486.0 15903415     0       0</p>
<p>2022-09-06 488.5 491.5 486.5 489.0 16700285     0       0</p>
<p>Period-Interval 模式會傳回最近一段期間特定頻率的價量資料 :</p>
<p>&gt;&gt;&gt; <strong>tw2330.history(period='10d', interval='1d')</strong></p>
<p>​       Open  High  Low Close  Volume Dividends Stock Splits</p>
<p>Date</p>
<p>2022-08-26 513.0 515.0 511.0 512.0 12914846     0       0</p>
<p>2022-08-29 497.0 502.0 496.0 498.5 26590824     0       0</p>
<p>2022-08-30 497.5 500.0 496.0 496.0 24214535     0       0</p>
<p>2022-08-31 492.0 505.0 492.0 505.0 39357089     0       0</p>
<p>2022-09-01 495.0 495.5 490.0 490.5 39168672     0       0</p>
<p>2022-09-02 488.0 489.5 485.0 485.0 29982959     0       0</p>
<p>2022-09-05 485.0 488.0 484.0 486.0 15903415     0       0</p>
<p>2022-09-06 488.5 491.5 486.5 489.0 16700285     0       0</p>
<p>2022-09-07 477.0 478.0 472.0 472.5 34678562     0       0</p>
<p>2022-09-08 473.0 475.0 472.0 475.0 27931552     0       0</p>
<p>傳入 period='max' 會下載股票上市以來的全部價量資料, 例如 Tesla :</p>
<p>&gt;&gt;&gt; <strong>df=tsla.history(period='max')</strong></p>
<p>&gt;&gt;&gt; <strong>df</strong></p>
<p>​         Open    High ... Dividends Stock Splits</p>
<p>Date                ...</p>
<p>2010-06-29  1.266667  1.666667 ...     0      0.0</p>
<p>2010-06-30  1.719333  2.028000 ...     0      0.0</p>
<p>2010-07-01  1.666667  1.728000 ...     0      0.0</p>
<p>2010-07-02  1.533333  1.540000 ...     0      0.0</p>
<p>2010-07-06  1.333333  1.333333 ...     0      0.0</p>
<p>...        ...     ... ...    ...      ...</p>
<p>2022-09-01 272.579987 277.579987 ...     0      0.0</p>
<p>2022-09-02 281.070007 282.350006 ...     0      0.0</p>
<p>2022-09-06 272.679993 275.989990 ...     0      0.0</p>
<p>2022-09-07 273.100006 283.839996 ...     0      0.0</p>
<p>2022-09-08 281.299988 289.500000 ...     0      0.0</p>
<p>[3071 rows x 7 columns]</p>
<p>此處將傳回的 DataFrame 儲存在 df 變數中, 可用 Matplotlib 來繪製全部歷史收盤價圖形 :</p>
<p>&gt;&gt;&gt; <strong>import matplotlib.pyplot as plt</strong></p>
<p>&gt;&gt;&gt; <strong>df['Close'].plot(figsize=(16, 9))</strong></p>
<p>&lt;matplotlib.axes._subplots.AxesSubplot object at 0x00000188333272B0&gt;</p>
<p>&gt;&gt;&gt; <strong>plt.show()</strong></p>
<p>結果如下 :</p>
<p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhh4MrX2ucq7k3YVQxqc5lQNyIz59-j-sR0r6VDwStHdz9GrBbiHSi2tH4_clVdEUGgkUh_dvYva_D5NMIkpb1Nw_Ql70jrUyTtYwyGDIR9vVicgKQBexQflorh5_joBRy2a5eYMljBDnZb0URJE0Akm5OUe1LKWrSiBxyb48ZI9TiA3h4qhC67_Fo0_w/s1301/yfinance-tsla-history-close.jpg"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhh4MrX2ucq7k3YVQxqc5lQNyIz59-j-sR0r6VDwStHdz9GrBbiHSi2tH4_clVdEUGgkUh_dvYva_D5NMIkpb1Nw_Ql70jrUyTtYwyGDIR9vVicgKQBexQflorh5_joBRy2a5eYMljBDnZb0URJE0Akm5OUe1LKWrSiBxyb48ZI9TiA3h4qhC67_Fo0_w/s320/yfinance-tsla-history-close.jpg" alt="img" /></a></p>
<p>如果要畫得漂亮些可用 Seaborn, 用法參考 :</p>
<p># <a href="https://yhhuang1966.blogspot.com/2022/07/python-seaborn_22.html">Python 學習筆記 : Seaborn 資料視覺化 (二)</a></p>
<p># <a href="https://stackoverflow.com/questions/31594549/how-to-change-the-figure-size-of-a-seaborn-axes-or-figure-level-plot">How to change the figure size of a seaborn axes or figure level plot</a></p>
<p>例如 :</p>
<p>&gt;&gt;&gt; <strong>import seaborn as sns</strong></p>
<p>&gt;&gt;&gt; <strong>sns.set(rc={'figure.figsize':(16, 9)})</strong></p>
<p>&gt;&gt;&gt; <strong>sns.lineplot(x='Date', y="Close", data=df)</strong></p>
<p>&lt;matplotlib.axes._subplots.AxesSubplot object at 0x000001884337A828&gt;</p>
<p>&gt;&gt;&gt; <strong>plt.show()</strong></p>
<p>結果如下 :</p>
<p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiDU-nSfATIdlalMkYPpC7kqkQKJwwmHQQh4JRnAmQWh9kwE1MRdupwZaGsdvXMOgi2Zr3j3ERlVENDeMyB_0pi3-tmtke_V9Z7uTqYqkybqxbYfgsOuPe5WIxvE9QspeA8Grw_2r887xz8_anOGqVB48EV-j1Z747ZmGV1o8a8HvuyA-mWfOjuVulqJA/s1319/yfinance-tsla-history-close-seaborn.jpg"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiDU-nSfATIdlalMkYPpC7kqkQKJwwmHQQh4JRnAmQWh9kwE1MRdupwZaGsdvXMOgi2Zr3j3ERlVENDeMyB_0pi3-tmtke_V9Z7uTqYqkybqxbYfgsOuPe5WIxvE9QspeA8Grw_2r887xz8_anOGqVB48EV-j1Z747ZmGV1o8a8HvuyA-mWfOjuVulqJA/s320/yfinance-tsla-history-close-seaborn.jpg" alt="img" /></a></p>
<p>哇, 如果在 2020 年買進特斯拉就賺爆了.</p>
<p>用 Period-interval 模式下載月收盤資料 :</p>
<p>&gt;&gt;&gt; <strong>tw2330.history(period='ytd', interval='1mo')</strong></p>
<p>​         Open    High     Low    Close    Volume Dividends Stock Splits</p>
<p>Date</p>
<p>2022-02-01 637.363946 643.302119 593.817341 597.776123 554354568.0    0.00       0</p>
<p>2022-03-01 592.827658 603.714309 549.281052 590.848267 976978169.0    0.00       0</p>
<p>2022-03-16     NaN     NaN     NaN     NaN     NaN    2.75       0</p>
<p>2022-04-01 581.839394 585.817783 520.174364 535.093323 613866812.0    0.00       0</p>
<p>2022-05-01 535.093347 556.974487 502.271636 556.974487 597891764.0    0.00       0</p>
<p>2022-06-01 547.028479 552.001465 473.428284 473.428284 619492801.0    0.00       0</p>
<p>2022-06-16     NaN     NaN     NaN     NaN     NaN    2.75       0</p>
<p>2022-07-01 471.500000 510.000000 433.000000 509.000000 718989084.0    0.00       0</p>
<p>2022-08-01 506.000000 527.000000 488.500000 505.000000 513479662.0    0.00       0</p>
<p>2022-09-01 495.000000 495.500000 472.000000 475.000000 164365445.0    0.00       0</p>
<p>2022-09-08 473.000000 475.000000 472.000000 475.000000  28881358.0    0.00       0</p>
<p>不知何故會出現 2022-03-16 與 2022-06-16 的 NaN 資料, 這是與 download() 不同之處.</p>
<p>高頻交易數據 (例如 1 分 K) 同樣只能下載近 7 天資料 :</p>
<p>&gt;&gt;&gt; <strong>tw2330.history(period='7d', interval='1m')</strong></p>
<p>​              Open  High  Low Close Volume Dividends Stock Splits</p>
<p>Datetime</p>
<p>2022-08-31 09:00:00+08:00 492.0 493.0 492.0 492.5    0     0       0</p>
<p>2022-08-31 09:01:00+08:00 492.5 493.0 492.0 492.5 392000     0       0</p>
<p>2022-08-31 09:02:00+08:00 492.5 493.0 492.0 492.5 233000     0       0</p>
<p>2022-08-31 09:03:00+08:00 492.5 493.5 492.5 493.0 254000     0       0</p>
<p>2022-08-31 09:04:00+08:00 493.5 493.5 493.0 493.5 243000     0       0</p>
<p>...             ...  ...  ...  ...   ...    ...      ...</p>
<p>2022-09-08 13:21:00+08:00 474.5 474.5 474.0 474.0 103000     0       0</p>
<p>2022-09-08 13:22:00+08:00 474.0 474.5 474.0 474.0 168093     0       0</p>
<p>2022-09-08 13:23:00+08:00 474.0 474.5 473.5 474.0 243000     0       0</p>
<p>2022-09-08 13:24:00+08:00 474.5 474.5 474.0 474.0 120643     0       0</p>
<p>2022-09-08 13:30:00+08:00 475.0 475.0 475.0 475.0    0     0       0</p>
<p>[1845 rows x 7 columns]</p>
<p>&gt;&gt;&gt; <strong>tw2330.history(period='8d', interval='1m')</strong></p>
<p>- 2330.TW: 1m data not available for startTime=1662085882 and endTime=1662777082. Only 7 days worth of 1m granularity data are allowed to be fetched per request.</p>
<p>Empty DataFrame</p>
<p>Columns: [Open, High, Low, Close, Adj Close, Volume]</p>
<p>Index: []</p>
<p>Start-end-interval 模式是 Start-end 模式加上 interval 參數指定期間內的資料頻率, 例如下載 2022-09-06 與 2022-09-07 這兩天的五分 K 資料 (interval='5m')</p>
<p>&gt;&gt;&gt; <strong>tw2330.history(start='2022-09-06', end='2022-09-08', interval='5m')</strong></p>
<p>​              Open  High  Low Close  Volume Dividends Stock Splits</p>
<p>Datetime</p>
<p>2022-09-06 09:00:00+08:00 488.5 491.0 488.0 491.0    0     0       0</p>
<p>2022-09-06 09:05:00+08:00 491.0 491.5 489.5 489.5  477000     0       0</p>
<p>2022-09-06 09:10:00+08:00 489.5 490.5 489.5 490.0  543911     0       0</p>
<p>2022-09-06 09:15:00+08:00 490.0 490.5 489.0 489.0  711856     0       0</p>
<p>2022-09-06 09:20:00+08:00 489.0 489.5 488.0 489.0  396767     0       0</p>
<p>...             ...  ...  ...  ...   ...    ...      ...</p>
<p>2022-09-07 13:05:00+08:00 473.5 474.0 473.0 473.0 1531608     0       0</p>
<p>2022-09-07 13:10:00+08:00 473.0 473.5 472.5 472.5  869565     0       0</p>
<p>2022-09-07 13:15:00+08:00 472.5 474.5 472.0 473.0 1845877     0       0</p>
<p>2022-09-07 13:20:00+08:00 473.0 475.0 473.0 473.0 1243638     0       0</p>
<p>2022-09-07 13:25:00+08:00 473.0 473.0 473.0 473.0  81857     0       0</p>
<p>[107 rows x 7 columns]</p>
<p>下載周收盤資料 (繪製周 K 線用) :</p>
<p>&gt;&gt;&gt; <strong>tw2330.history(start='2022-07-04', end='2022-09-09', interval='1wk')</strong></p>
<p>​       Open  High  Low Close   Volume Dividends Stock Splits</p>
<p>Date</p>
<p>2022-07-04 443.0 470.5 433.0 467.0 229129023     0       0</p>
<p>2022-07-11 468.0 494.0 449.5 492.5 172796995     0       0</p>
<p>2022-07-18 495.5 505.0 486.5 503.0 141993085     0       0</p>
<p>2022-07-25 500.0 510.0 491.0 509.0 113325604     0       0</p>
<p>2022-08-01 506.0 516.0 488.5 516.0 150371495     0       0</p>
<p>2022-08-08 510.0 518.0 499.5 517.0 104634837     0       0</p>
<p>2022-08-15 520.0 527.0 517.0 519.0 100990578     0       0</p>
<p>2022-08-22 511.0 515.0 502.0 512.0  67320304     0       0</p>
<p>2022-08-29 497.0 505.0 485.0 485.0 159314079     0       0</p>
<p>2022-09-05 485.0 491.5 472.0 475.0  95213814     0       0</p>
<p>2022-09-08 473.0 475.0 472.0 475.0  28881358     0       0</p>
<p>下載月收盤資料 (繪製月 K 線用) :</p>
<p>&gt;&gt;&gt; <strong>tw2330.history(start='2022-01-01', end='2022-09-01', interval='1mo')</strong></p>
<p>​         Open    High     Low    Close    Volume Dividends Stock Splits</p>
<p>Date</p>
<p>2022-01-01 612.621586 680.910583 611.631890 629.446411 922313952.0    0.00       0</p>
<p>2022-02-01 637.363946 643.302119 593.817341 597.776123 554354568.0    0.00       0</p>
<p>2022-03-01 592.827658 603.714309 549.281052 590.848267 976978169.0    0.00       0</p>
<p>2022-03-16     NaN     NaN     NaN     NaN     NaN    2.75       0</p>
<p>2022-04-01 581.839394 585.817783 520.174364 535.093323 613866812.0    0.00       0</p>
<p>2022-05-01 535.093347 556.974487 502.271636 556.974487 597891764.0    0.00       0</p>
<p>2022-06-01 547.028479 552.001465 473.428284 473.428284 619492801.0    0.00       0</p>
<p>2022-06-16     NaN     NaN     NaN     NaN     NaN    2.75       0</p>
<p>2022-07-01 471.500000 510.000000 433.000000 509.000000 718989084.0    0.00       0</p>
<p>2022-08-01 506.000000 527.000000 488.500000 505.000000 513479662.0    0.00       0</p>
<p>2022-09-01 495.000000 495.500000 472.000000 475.000000 164365445.0    0.00       0</p>
<p>除了上面常用的三種參數組合模式外, start/end 也可以與 period 合用, 例如 Start-period 模式可指定開始日期至今頻率為 period 的價量資料; 或 End-period 模式可指定自上市起至 end 日期頻率為 period 的價量資料.</p>
<p><strong>(2). 商品綜合資訊 info :</strong></p>
<p>Ticker 物件的 info 屬性以字典型態儲存商品之綜合資訊, 呼叫方法 get_info() 也會傳回相同的資料, 此字典的項目非常多, 如果直接 print 不會顯示全部內容, 必須用 for 迴圈走訪 items() 傳回的字典鍵與值.</p>
<p>&gt;&gt;&gt; <strong>for k, v in tw2330.info.items():</strong>   # 也可以用 tw2330.get_info().items()</p>
<p><strong>print(f'{k}:\t{v}')</strong></p>
<p>zip:	300096</p>
<p>sector:	Technology</p>
<p>fullTimeEmployees:	54193</p>
<p>longBusinessSummary:	Taiwan Semiconductor Manufacturing Company Limited manufactures, packages, tests, and sells integrated circuits and other semiconductor devices in Taiwan, China, Europe, the Middle East, Africa, Japan, the United States, and internationally. It provides complementary metal oxide silicon wafer fabrication processes to manufacture logic, mixed-signal, radio frequency, and embedded memory semiconductors. The company also offers customer support, account management, and engineering services, as well as manufactures masks. Its products are used in mobile devices, high performance computing, automotive electronics, and internet of things markets. The company was incorporated in 1987 and is headquartered in Hsinchu City, Taiwan.</p>
<p>city:	Hsinchu City</p>
<p>phone:	886 3 563 6688</p>
<p>country:	Taiwan</p>
<p>companyOfficers:	[]</p>
<p>website:	https://www.tsmc.com</p>
<p>maxAge:	1</p>
<p>address1:	Hsinchu Science Park</p>
<p>fax:	886 3 563 7000</p>
<p>industry:	Semiconductors</p>
<p>address2:	No. 8, Li-Hsin Road 6</p>
<p>ebitdaMargins:	0.67949</p>
<p>profitMargins:	0.40587002</p>
<p>grossMargins:	0.54959</p>
<p>operatingCashflow:	1407924699136</p>
<p>revenueGrowth:	0.435</p>
<p>operatingMargins:	0.44752</p>
<p>ebitda:	1276140847104</p>
<p>targetLowPrice:	500</p>
<p>recommendationKey:	buy</p>
<p>grossProfits:	819537266000</p>
<p>freeCashflow:	143859351552</p>
<p>targetMedianPrice:	650</p>
<p>currentPrice:	475</p>
<p>earningsGrowth:	0.764</p>
<p>currentRatio:	2.255</p>
<p>returnOnAssets:	0.14123</p>
<p>numberOfAnalystOpinions:	29</p>
<p>targetMeanPrice:	675.37</p>
<p>debtToEquity:	36.432</p>
<p>returnOnEquity:	0.33964002</p>
<p>targetHighPrice:	860</p>
<p>totalCash:	1450175234048</p>
<p>totalDebt:	914603245568</p>
<p>totalRevenue:	1878076424192</p>
<p>totalCashPerShare:	55.926</p>
<p>financialCurrency:	TWD</p>
<p>revenuePerShare:	72.429</p>
<p>quickRatio:	1.981</p>
<p>recommendationMean:	1.8</p>
<p>exchange:	TAI</p>
<p>shortName:	TAIWAN SEMICONDUCTOR MANUFACTUR</p>
<p>longName:	Taiwan Semiconductor Manufacturing Company Limited</p>
<p>exchangeTimezoneName:	Asia/Taipei</p>
<p>exchangeTimezoneShortName:	CST</p>
<p>isEsgPopulated:	False</p>
<p>gmtOffSetMilliseconds:	28800000</p>
<p>quoteType:	EQUITY</p>
<p>symbol:	2330.TW</p>
<p>messageBoardId:	finmb_380075</p>
<p>market:	tw_market</p>
<p>annualHoldingsTurnover:	None</p>
<p>enterpriseToRevenue:	6.419</p>
<p>beta3Year:	None</p>
<p>enterpriseToEbitda:	9.446</p>
<p>52WeekChange:	-0.23667204</p>
<p>morningStarRiskRating:	None</p>
<p>forwardEps:	37.85</p>
<p>revenueQuarterlyGrowth:	None</p>
<p>sharesOutstanding:	25930399744</p>
<p>fundInceptionDate:	None</p>
<p>annualReportExpenseRatio:	None</p>
<p>totalAssets:	None</p>
<p>bookValue:	96.271</p>
<p>sharesShort:	None</p>
<p>sharesPercentSharesOut:	None</p>
<p>fundFamily:	None</p>
<p>lastFiscalYearEnd:	1640908800</p>
<p>heldPercentInstitutions:	0.42201</p>
<p>netIncomeToCommon:	762250854400</p>
<p>trailingEps:	29.23</p>
<p>lastDividendValue:	2.75</p>
<p>SandP52WeekChange:	-0.13021445</p>
<p>priceToBook:	4.933988</p>
<p>heldPercentInsiders:	0</p>
<p>nextFiscalYearEnd:	1703980800</p>
<p>yield:	None</p>
<p>mostRecentQuarter:	1656547200</p>
<p>shortRatio:	None</p>
<p>sharesShortPreviousMonthDate:	None</p>
<p>floatShares:	24181894477</p>
<p>beta:	1.117948</p>
<p>enterpriseValue:	12054771531776</p>
<p>priceHint:	2</p>
<p>threeYearAverageReturn:	None</p>
<p>lastSplitDate:	1247616000</p>
<p>lastSplitFactor:	1:1</p>
<p>legalType:	None</p>
<p>lastDividendDate:	1671062400</p>
<p>morningStarOverallRating:	None</p>
<p>earningsQuarterlyGrowth:	0.764</p>
<p>priceToSalesTrailing12Months:	6.6326323</p>
<p>dateShortInterest:	None</p>
<p>pegRatio:	0.58</p>
<p>ytdReturn:	None</p>
<p>forwardPE:	12.549539</p>
<p>lastCapGain:	None</p>
<p>shortPercentOfFloat:	None</p>
<p>sharesShortPriorMonth:	None</p>
<p>impliedSharesOutstanding:	0</p>
<p>category:	None</p>
<p>fiveYearAverageReturn:	None</p>
<p>previousClose:	472.5</p>
<p>regularMarketOpen:	473</p>
<p>twoHundredDayAverage:	559.825</p>
<p>trailingAnnualDividendYield:	0.023280423</p>
<p>payoutRatio:	0.3763</p>
<p>volume24Hr:	None</p>
<p>regularMarketDayHigh:	475</p>
<p>navPrice:	None</p>
<p>averageDailyVolume10Day:	24886832   (近 10 日均量)</p>
<p>regularMarketPreviousClose:	472.5</p>
<p>fiftyDayAverage:	493.17</p>
<p>trailingAnnualDividendRate:	11</p>
<p>open:	473</p>
<p>toCurrency:	None</p>
<p>averageVolume10days:	24886832</p>
<p>expireDate:	None</p>
<p>algorithm:	None</p>
<p>dividendRate:	11</p>
<p>exDividendDate:	1663200000</p>
<p>circulatingSupply:	None</p>
<p>startDate:	None</p>
<p>regularMarketDayLow:	472</p>
<p>currency:	TWD</p>
<p>trailingPE:	16.250427</p>
<p>regularMarketVolume:	28881358</p>
<p>lastMarket:	None</p>
<p>maxSupply:	None</p>
<p>openInterest:	None</p>
<p>marketCap:	12456590049280</p>
<p>volumeAllCurrencies:	None</p>
<p>strikePrice:	None</p>
<p>averageVolume:	28951866</p>
<p>dayLow:	472</p>
<p>ask:	475.5</p>
<p>askSize:	0</p>
<p>volume:	28881358</p>
<p>fiftyTwoWeekHigh:	688   (近 52 周最高價)</p>
<p>fromCurrency:	None</p>
<p>fiveYearAvgDividendYield:	2.78  (近 5 年平均現金股息)</p>
<p>fiftyTwoWeekLow:	433    (近 52 周最低價)</p>
<p>bid:	475</p>
<p>tradeable:	False</p>
<p>dividendYield:	0.0227</p>
<p>bidSize:	0</p>
<p>dayHigh:	475</p>
<p>coinMarketCapLink:	None</p>
<p>regularMarketPrice:	475</p>
<p>preMarketPrice:	None</p>
<p>logo_url:	https://logo.clearbit.com/tsmc.com</p>
<p>trailingPegRatio:	0.788</p>
<p>如果用 Colab 就可以直接 print, 不須用迴圈走訪 items() :</p>
<p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiIfaKY_gI29eiX9Vq-e4j9eo3O8hFRg9X09RG8IUCW_uLOvhvriUjqMGWuYpjEGXddxiBkSPSpseflJPiEaHtiXBQVqJY0MRX062amnWXybzWgCpKBvnV6RLBl9glyI741qF8lFkcuIjEzkI-plS_FWn5Ti4KU90F98YY1bvCUJj_C4BzUri9AqJgPkA/s914/yfinance-tw2330.info.jpg"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiIfaKY_gI29eiX9Vq-e4j9eo3O8hFRg9X09RG8IUCW_uLOvhvriUjqMGWuYpjEGXddxiBkSPSpseflJPiEaHtiXBQVqJY0MRX062amnWXybzWgCpKBvnV6RLBl9glyI741qF8lFkcuIjEzkI-plS_FWn5Ti4KU90F98YY1bvCUJj_C4BzUri9AqJgPkA/s320/yfinance-tw2330.info.jpg" alt="img" /></a></p>
<p>此資料也可以用 get_info() 方法取得.</p>
<p><strong>(3). 內部人士與大戶持股比例 major_holders :</strong></p>
<p>Ticker 物件的 major_holders 屬性以 DataFrame 型態儲存商品之大戶持股比例 :</p>
<p>&gt;&gt;&gt; <strong>tw2330.major_holders</strong></p>
<p>​    0                   1</p>
<p>0  0.00%    % of Shares Held by All Insider</p>
<p>1 42.20%    % of Shares Held by Institutions</p>
<p>2 42.20%    % of Float Held by Institutions</p>
<p>3   641 Number of Institutions Holding Shares</p>
<p>此資料也可以呼叫 get_major_holders() 取得, 例如 :</p>
<p>&gt;&gt;&gt; <strong>tsla.get_major_holders()</strong></p>
<p>​    0                   1</p>
<p>0 16.43%    % of Shares Held by All Insider</p>
<p>1 44.43%    % of Shares Held by Institutions</p>
<p>2 53.17%    % of Float Held by Institutions</p>
<p>3  3304 Number of Institutions Holding Shares</p>
<p><strong>(4). 機構法人持股比例 major_holders :</strong></p>
<p>不知為何, 這個資料對臺股來說不論用屬性或方法都傳回 None :</p>
<p>&gt;&gt;&gt; <strong>print(tw2330.institutional_holders)</strong></p>
<p>None</p>
<p>&gt;&gt;&gt; <strong>print(tw2330.get_institutional_holders())</strong></p>
<p>None</p>
<p>但美股則有資料, 例如特斯拉 :</p>
<p>&gt;&gt;&gt; <strong>tsla.get_institutional_holders()</strong></p>
<p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiku_qIfLqYJdoTqglq73KXttuzFFxiN3Qmu-LPLIxF-d9w6CMHd9a1JatrYxLSADg71PZcbET2YzMFTbAK6S7UECBrBlLMzcTRdbm_zsE-MtGYMggE36RHszIS4E42ol50pptQngi-_t8md7T5Y_IWcGs_eY_YglnWBVwyLyg3u5wD8ABGmA3ASX4M8w/s572/yfinance-tsla.major_holders.jpg"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiku_qIfLqYJdoTqglq73KXttuzFFxiN3Qmu-LPLIxF-d9w6CMHd9a1JatrYxLSADg71PZcbET2YzMFTbAK6S7UECBrBlLMzcTRdbm_zsE-MtGYMggE36RHszIS4E42ol50pptQngi-_t8md7T5Y_IWcGs_eY_YglnWBVwyLyg3u5wD8ABGmA3ASX4M8w/s320/yfinance-tsla.major_holders.jpg" alt="img" /></a></p>
<p><strong>(5). 損益表 financials :</strong></p>
<p>financials 屬性儲存商品過去四年的損益表 (即營收與獲利虧損情形) :</p>
<p>&gt;&gt;&gt; <strong>tw2330.financials</strong></p>
<p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi4UIKzAxqwZpouVnjxQ8jj4dgYkbXzEICnrVMAMjUF58aoSFcS5RQa1rB6jR1ab8b2NBsPvnQm_aJPuS2ERqvqPXr3AXegRvcQr6VV7e0mVgSj-sW1WoUqgAl-rHUaLIdZ8-yQf6JXCP3EJmwWnBZYi3R9fFOrq2G_0gV1rVm_ZhGx1Rg10dNQ7EnPeg/s1091/yfinance-tw2330.financials.jpg"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi4UIKzAxqwZpouVnjxQ8jj4dgYkbXzEICnrVMAMjUF58aoSFcS5RQa1rB6jR1ab8b2NBsPvnQm_aJPuS2ERqvqPXr3AXegRvcQr6VV7e0mVgSj-sW1WoUqgAl-rHUaLIdZ8-yQf6JXCP3EJmwWnBZYi3R9fFOrq2G_0gV1rVm_ZhGx1Rg10dNQ7EnPeg/s320/yfinance-tw2330.financials.jpg" alt="img" /></a></p>
<p>此資料也可以用 get_financials() 方法取得, 例如 :</p>
<p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiYnynBabZhipaUn2fGdoA3TbqJUoSFjx82T6VdpEvC_OEvGGIMuSc370lonKJlpmCjwKCDynVbQfWlyqzshUfGwa7MFPI_o4vL3vAVtDjiW07iyH9N3T5rvoyePVhCznVCHKbNGIQrNLKVdy-DMGbhQmOnIqhPhEpZTFCSHIhV_8Ryso6RKCnBHEs4tg/s1010/yfinance-tsla_get_financials.jpg"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiYnynBabZhipaUn2fGdoA3TbqJUoSFjx82T6VdpEvC_OEvGGIMuSc370lonKJlpmCjwKCDynVbQfWlyqzshUfGwa7MFPI_o4vL3vAVtDjiW07iyH9N3T5rvoyePVhCznVCHKbNGIQrNLKVdy-DMGbhQmOnIqhPhEpZTFCSHIhV_8Ryso6RKCnBHEs4tg/s320/yfinance-tsla_get_financials.jpg" alt="img" /></a></p>
<p><strong>(6). 資產負債表 financials :</strong></p>
<p>balance_sheet 屬性儲存商品過去四年的資產負債表 :</p>
<p>&gt;&gt;&gt; <strong>tw2330.balance_sheet</strong></p>
<p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEigFGSJBIyKKXDnffpiBFkLWYqh3IR05MtkiOjGLJAdt4U9GBl7qdBFFu9cU8KcLQlxFhN5anAVc6V0vfOzH4e1rq4s8Fan3uPAazyb3zRNzITIQ4Ys9F5F7u25AXVMaN4yXTr2PXjiQ3A9w_d9m0eWm2-FGfAcYV-QtWFwLvtPYiDQuZ2v-IUw_TDAVg/s1026/yfinance-tw2330.balance_sheet.jpg"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEigFGSJBIyKKXDnffpiBFkLWYqh3IR05MtkiOjGLJAdt4U9GBl7qdBFFu9cU8KcLQlxFhN5anAVc6V0vfOzH4e1rq4s8Fan3uPAazyb3zRNzITIQ4Ys9F5F7u25AXVMaN4yXTr2PXjiQ3A9w_d9m0eWm2-FGfAcYV-QtWFwLvtPYiDQuZ2v-IUw_TDAVg/s320/yfinance-tw2330.balance_sheet.jpg" alt="img" /></a></p>
<p>此資料也可以用 get_balance_sheet() 方法取得, 例如 :</p>
<p>&gt;&gt;&gt; <strong>tsla.get_balance_sheet()</strong></p>
<p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi9Lvv7nn0eQ2oQjN4EMgTeF1BbJjslscFkTfIs-ivY-X1gMfeTetgdoo65-LvH0FMt5gonnokn9gM0IRA3aem9UCRVosLvOm8yKeNGX-CckD2n2JzTcmzZKnhz4pn1SLaS6QgAxuHL-QV4JU_AXOuy80jByqn_gTTUjX04S3mC5ZsWeeV-aXpE8eg0dA/s1018/yfinance-tsla.get_balance_sheet.jpg"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi9Lvv7nn0eQ2oQjN4EMgTeF1BbJjslscFkTfIs-ivY-X1gMfeTetgdoo65-LvH0FMt5gonnokn9gM0IRA3aem9UCRVosLvOm8yKeNGX-CckD2n2JzTcmzZKnhz4pn1SLaS6QgAxuHL-QV4JU_AXOuy80jByqn_gTTUjX04S3mC5ZsWeeV-aXpE8eg0dA/s320/yfinance-tsla.get_balance_sheet.jpg" alt="img" /></a></p>
<p><strong>(7). 現金流量表 cashflow :</strong></p>
<p>cashflow 屬性儲存商品過去四年的現金流量表 :</p>
<p>&gt;&gt;&gt; <strong>tw2330.cashflow</strong></p>
<p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjh14FwFLXEOP-GJwMfvuRoLkOoFk9ioFAreB-HgnhEeC2fZjtXJjSLeVMIiT-5bwV35b-cgtzziqzSpxbYKfyR02EkzvzTQSzNuzydYunIIQ2z6dQy8EqH9hA1ozBci_DkWmQMHpkhmxp0jzUcsyoPgC_gGSsAWHzZQCDW0sA0mx9ZpnOBo9SrBaCW1g/s1217/yfinance-tw2330.cashflow.jpg"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjh14FwFLXEOP-GJwMfvuRoLkOoFk9ioFAreB-HgnhEeC2fZjtXJjSLeVMIiT-5bwV35b-cgtzziqzSpxbYKfyR02EkzvzTQSzNuzydYunIIQ2z6dQy8EqH9hA1ozBci_DkWmQMHpkhmxp0jzUcsyoPgC_gGSsAWHzZQCDW0sA0mx9ZpnOBo9SrBaCW1g/s320/yfinance-tw2330.cashflow.jpg" alt="img" /></a></p>
<p>此資料也可以用 get_cashflow() 方法取得, 例如 :</p>
<p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEitSwSrJu96PFTo1yBKjP-4yzI4r4NcTAaRHXRxNmFlJjMXvkH7xM-x8VYZrltdz1Ce42qvumGZU-Q6sekA7h8_wWQITp9I6sMYGwIGu-3saxe62GHIvg_KRZb3gW_tjqQK-2xBzlkt1qabKJkFslXUp14ifibqR1PmPCR96U0RplwX8SupDMOnWGXCOQ/s1000/yfinance-tsla.cashflow.jpg"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEitSwSrJu96PFTo1yBKjP-4yzI4r4NcTAaRHXRxNmFlJjMXvkH7xM-x8VYZrltdz1Ce42qvumGZU-Q6sekA7h8_wWQITp9I6sMYGwIGu-3saxe62GHIvg_KRZb3gW_tjqQK-2xBzlkt1qabKJkFslXUp14ifibqR1PmPCR96U0RplwX8SupDMOnWGXCOQ/s320/yfinance-tsla.cashflow.jpg" alt="img" /></a></p>
<p>以上程式碼均可在 Colab 測試, 參考 :</p>
<p># https://github.com/tony1966/colab/blob/main/yfinance_test.ipynb</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../strategy/finlab.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../strategy/shioaji.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../strategy/finlab.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../strategy/shioaji.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="../ace.js"></script>
        <script src="../mode-rust.js"></script>
        <script src="../editor.js"></script>
        <script src="../theme-dawn.js"></script>
        <script src="../theme-tomorrow_night.js"></script>

        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../mermaid.min.js"></script>
        <script src="../mermaid-init.js"></script>



    </div>
    </body>
</html>
