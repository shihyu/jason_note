<!DOCTYPE HTML>
<html lang="zh" class="rust sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>AI 模型訓練完整指南：從零開始到實戰 - Jason Notes</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "rust";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Jason Notes</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/shihyu/jason_note" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="ai-模型訓練完整指南從零開始到實戰"><a class="header" href="#ai-模型訓練完整指南從零開始到實戰">AI 模型訓練完整指南：從零開始到實戰</a></h1>
<h2 id="目錄"><a class="header" href="#目錄">目錄</a></h2>
<ol>
<li><a href="#%E9%96%8B%E6%BA%90%E6%A8%A1%E5%9E%8B%E9%81%B8%E6%93%87">開源模型選擇</a></li>
<li><a href="#%E8%A8%93%E7%B7%B4%E6%96%B9%E6%B3%95lora-%E6%8A%80%E8%A1%93">訓練方法：LoRA 技術</a></li>
<li><a href="#%E6%95%B8%E6%93%9A%E6%94%B6%E9%9B%86%E7%AD%96%E7%95%A5">數據收集策略</a></li>
<li><a href="#%E7%A1%AC%E9%AB%94%E9%9C%80%E6%B1%82%E8%88%87%E8%A7%A3%E6%B1%BA%E6%96%B9%E6%A1%88">硬體需求與解決方案</a></li>
<li><a href="#%E7%82%BA%E4%BB%80%E9%BA%BC%E9%81%B8%E6%93%87-nvidia-gpu">為什麼選擇 NVIDIA GPU</a></li>
<li><a href="#cpu-vs-gpu-%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90">CPU vs GPU 原理解析</a></li>
<li><a href="#%E5%AF%A6%E6%88%B0%E7%A8%8B%E5%BC%8F%E7%A2%BC%E7%AF%84%E4%BE%8B">實戰程式碼範例</a></li>
</ol>
<hr />
<h2 id="開源模型選擇"><a class="header" href="#開源模型選擇">開源模型選擇</a></h2>
<h3 id="基礎語言模型"><a class="header" href="#基礎語言模型">基礎語言模型</a></h3>
<ul>
<li><strong>Llama 3.1/3.2</strong> (Meta): 效能優異，有 8B、70B 等版本</li>
<li><strong>Mistral/Mixtral</strong>: 輕量但效果好，適合財務分析</li>
<li><strong>Qwen 2.5</strong> (阿里): 中文支援佳，適合中文財報</li>
<li><strong>Yi-1.5</strong> (零一萬物): 中英雙語能力強</li>
<li><strong>Phi-2</strong> (Microsoft): 2.7B 參數，適合初學者</li>
<li><strong>TinyLlama</strong>: 1.1B 參數，訓練快速</li>
</ul>
<h3 id="財務專用模型"><a class="header" href="#財務專用模型">財務專用模型</a></h3>
<ul>
<li><strong>FinGPT</strong>: 專門為金融領域設計的開源模型</li>
<li><strong>BloombergGPT</strong> (部分開源): 金融領域預訓練</li>
<li><strong>FinBERT</strong>: 較小但專注於金融情感分析</li>
</ul>
<h3 id="模型選擇建議"><a class="header" href="#模型選擇建議">模型選擇建議</a></h3>
<div class="table-wrapper"><table><thead><tr><th>模型規模</th><th>參數量</th><th>VRAM需求</th><th>適用場景</th></tr></thead><tbody>
<tr><td>小型</td><td>&lt; 3B</td><td>4-8GB</td><td>學習測試、特定任務</td></tr>
<tr><td>中型</td><td>3-13B</td><td>8-24GB</td><td>通用助手、商業應用</td></tr>
<tr><td>大型</td><td>13-70B</td><td>24-80GB</td><td>複雜推理、專業應用</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="訓練方法lora-技術"><a class="header" href="#訓練方法lora-技術">訓練方法：LoRA 技術</a></h2>
<h3 id="什麼是-lora"><a class="header" href="#什麼是-lora">什麼是 LoRA？</a></h3>
<p>LoRA (Low-Rank Adaptation) 是一種<strong>通用的微調技術</strong>，不綁定特定模型：</p>
<ul>
<li>在原始模型旁邊添加小的可訓練參數</li>
<li>凍結原始模型權重，只訓練新增的部分</li>
<li>大幅減少需要訓練的參數量（通常只需 1-10%）</li>
</ul>
<h3 id="lora-的優勢"><a class="header" href="#lora-的優勢">LoRA 的優勢</a></h3>
<ol>
<li><strong>省資源</strong>: 只需訓練 1-10% 參數</li>
<li><strong>可疊加</strong>: 可以訓練多個 LoRA 用於不同任務</li>
<li><strong>易分享</strong>: LoRA 檔案小（幾十MB），方便分享</li>
<li><strong>可切換</strong>: 同一個基礎模型可以載入不同 LoRA</li>
</ol>
<h3 id="lora-配置範例"><a class="header" href="#lora-配置範例">LoRA 配置範例</a></h3>
<pre><code class="language-python">from peft import LoraConfig, get_peft_model

# 通用 LoRA 配置
lora_config = LoraConfig(
    r=16,  # LoRA rank（可調整：4, 8, 16, 32, 64）
    lora_alpha=32,  # 縮放參數
    target_modules=["q_proj", "k_proj", "v_proj", "o_proj"],
    lora_dropout=0.1,
    bias="none",
    task_type="CAUSAL_LM",
)

# 應用到任何模型
model = get_peft_model(model, lora_config)
</code></pre>
<hr />
<h2 id="數據收集策略"><a class="header" href="#數據收集策略">數據收集策略</a></h2>
<h3 id="推薦訓練領域按難易度"><a class="header" href="#推薦訓練領域按難易度">推薦訓練領域（按難易度）</a></h3>
<h4 id="1-程式碼助手-"><a class="header" href="#1-程式碼助手-">1. 程式碼助手 ⭐⭐⭐⭐⭐</a></h4>
<p><strong>最容易收集數據，實用性極高</strong></p>
<ul>
<li>CodeAlpaca: 20K 程式指令數據</li>
<li>CodeSearchNet: 2M+ 函數和文檔</li>
<li>The Stack: 3TB 開源程式碼</li>
<li>GitHub 公開專案</li>
</ul>
<h4 id="2-客服faq-機器人-"><a class="header" href="#2-客服faq-機器人-">2. 客服/FAQ 機器人 ⭐⭐⭐⭐⭐</a></h4>
<p><strong>公開數據多，商業價值高</strong></p>
<ul>
<li>Amazon 產品 QA: 100萬+ QA對</li>
<li>SQuAD: 問答數據集</li>
<li>各公司公開的 FAQ 頁面</li>
</ul>
<h4 id="3-文章摘要生成器-"><a class="header" href="#3-文章摘要生成器-">3. 文章摘要生成器 ⭐⭐⭐⭐</a></h4>
<p><strong>新聞網站多，數據豐富</strong></p>
<ul>
<li>CNN/DailyMail: 30萬+ 新聞摘要</li>
<li>XSum: BBC 新聞摘要</li>
<li>中文：THUCNews、新浪新聞</li>
</ul>
<h4 id="4-財報分析數據源"><a class="header" href="#4-財報分析數據源">4. 財報分析數據源</a></h4>
<pre><code class="language-python"># SEC EDGAR (美股)
import sec_edgar_downloader
downloader = sec_edgar_downloader.Downloader()
downloader.get("10-K", "AAPL")

# 財經 API
import yfinance as yf
ticker = yf.Ticker("TSLA")
financials = ticker.financials

# 台灣公開資訊觀測站
# https://mops.twse.com.tw/
</code></pre>
<h3 id="數據格式範例"><a class="header" href="#數據格式範例">數據格式範例</a></h3>
<pre><code class="language-json">{
  "instruction": "分析這份財報的營收成長",
  "input": "公司2023年營收...",
  "output": "根據財報顯示..."
}
</code></pre>
<hr />
<h2 id="硬體需求與解決方案"><a class="header" href="#硬體需求與解決方案">硬體需求與解決方案</a></h2>
<h3 id="硬體配置建議"><a class="header" href="#硬體配置建議">硬體配置建議</a></h3>
<h4 id="最低配置"><a class="header" href="#最低配置">最低配置</a></h4>
<ul>
<li>GPU: RTX 3090 (24GB VRAM)</li>
<li>可訓練 7B 參數模型（使用 LoRA）</li>
</ul>
<h4 id="建議配置"><a class="header" href="#建議配置">建議配置</a></h4>
<ul>
<li>GPU: A100 40GB 或 RTX 4090</li>
<li>可訓練 13B-30B 模型</li>
</ul>
<h3 id="沒有顯卡的解決方案"><a class="header" href="#沒有顯卡的解決方案">沒有顯卡的解決方案</a></h3>
<h4 id="1-google-colab最推薦"><a class="header" href="#1-google-colab最推薦">1. Google Colab（最推薦）</a></h4>
<div class="table-wrapper"><table><thead><tr><th>方案</th><th>價格</th><th>GPU</th><th>適用場景</th></tr></thead><tbody>
<tr><td>免費版</td><td>$0</td><td>T4 (15GB)</td><td>學習測試</td></tr>
<tr><td>Pro</td><td>$10/月</td><td>V100/A100</td><td>常常訓練</td></tr>
<tr><td>Pro+</td><td>$50/月</td><td>A100 48小時不斷</td><td>專業使用</td></tr>
</tbody></table>
</div>
<h4 id="2-雲端租用"><a class="header" href="#2-雲端租用">2. 雲端租用</a></h4>
<ul>
<li>Vast.ai: $0.2-0.5/hr (RTX 3090)</li>
<li>RunPod: $0.3-0.7/hr</li>
<li>Lambda Labs: $0.5-1.5/hr</li>
</ul>
<h4 id="3-cpu-訓練策略amd-8745hs"><a class="header" href="#3-cpu-訓練策略amd-8745hs">3. CPU 訓練策略（AMD 8745HS）</a></h4>
<pre><code class="language-python"># CPU 優化設定
import torch
torch.set_num_threads(16)  # 使用所有線程

# 使用量化技術
from transformers import BitsAndBytesConfig
quantization_config = BitsAndBytesConfig(
    load_in_4bit=True,
    bnb_4bit_compute_dtype=torch.float16,
)

# 使用超小模型
models = {
    "microsoft/phi-1_5": "1.3B",
    "TinyLlama/TinyLlama-1.1B": "1.1B",
    "facebook/opt-350m": "350M",
}
</code></pre>
<h3 id="訓練時間對比"><a class="header" href="#訓練時間對比">訓練時間對比</a></h3>
<div class="table-wrapper"><table><thead><tr><th>硬體</th><th>模型規模</th><th>1000筆資料訓練時間</th></tr></thead><tbody>
<tr><td>CPU (8745HS)</td><td>350M</td><td>5-8 小時</td></tr>
<tr><td>CPU (8745HS)</td><td>2.7B + LoRA</td><td>10-15 小時</td></tr>
<tr><td>GPU (RTX 3090)</td><td>7B + LoRA</td><td>30 分鐘</td></tr>
<tr><td>GPU (A100)</td><td>13B</td><td>45 分鐘</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="為什麼選擇-nvidia-gpu"><a class="header" href="#為什麼選擇-nvidia-gpu">為什麼選擇 NVIDIA GPU</a></h2>
<h3 id="nvidia-壟斷的原因"><a class="header" href="#nvidia-壟斷的原因">NVIDIA 壟斷的原因</a></h3>
<h4 id="1-生態系統優勢"><a class="header" href="#1-生態系統優勢">1. 生態系統優勢</a></h4>
<ul>
<li><strong>CUDA</strong>: 2007年發布，領先 AMD ROCm 9年</li>
<li><strong>軟體支援</strong>: 所有 AI 框架原生支援</li>
<li><strong>開發工具</strong>: 完整的除錯、優化工具鏈</li>
</ul>
<h4 id="2-硬體優勢"><a class="header" href="#2-硬體優勢">2. 硬體優勢</a></h4>
<ul>
<li><strong>Tensor Cores</strong>: 專門的 AI 運算單元</li>
<li><strong>記憶體頻寬</strong>: H100 達 3.35 TB/s</li>
<li><strong>NVLink</strong>: GPU 間高速通訊</li>
</ul>
<h3 id="nvidia-vs-amd-對比"><a class="header" href="#nvidia-vs-amd-對比">NVIDIA vs AMD 對比</a></h3>
<div class="table-wrapper"><table><thead><tr><th>項目</th><th>NVIDIA</th><th>AMD</th></tr></thead><tbody>
<tr><td>軟體生態</td><td>⭐⭐⭐⭐⭐ 成熟完整</td><td>⭐⭐ 發展中</td></tr>
<tr><td>安裝難度</td><td>⭐⭐⭐⭐⭐ 簡單</td><td>⭐ 複雜</td></tr>
<tr><td>框架支援</td><td>⭐⭐⭐⭐⭐ 全面</td><td>⭐⭐ 有限</td></tr>
<tr><td>性能表現</td><td>⭐⭐⭐⭐⭐ 最佳</td><td>⭐⭐⭐ 可用</td></tr>
<tr><td>性價比</td><td>⭐⭐⭐ 較貴</td><td>⭐⭐⭐⭐ 便宜</td></tr>
</tbody></table>
</div>
<h3 id="實際差異"><a class="header" href="#實際差異">實際差異</a></h3>
<pre><code class="language-bash"># NVIDIA 安裝（簡單）
pip install torch torchvision torchaudio

# AMD 安裝（複雜）
# 1. 確認 GPU 支援
# 2. 安裝特定 Linux 版本
# 3. 安裝 ROCm
# 4. 安裝特殊版本 PyTorch
pip install torch --index-url https://download.pytorch.org/whl/rocm5.7
</code></pre>
<hr />
<h2 id="cpu-vs-gpu-原理解析"><a class="header" href="#cpu-vs-gpu-原理解析">CPU vs GPU 原理解析</a></h2>
<h3 id="架構差異"><a class="header" href="#架構差異">架構差異</a></h3>
<h4 id="cpu高級餐廳主廚"><a class="header" href="#cpu高級餐廳主廚">CPU：高級餐廳主廚</a></h4>
<ul>
<li><strong>核心數</strong>: 8-16 個強大核心</li>
<li><strong>特點</strong>: 複雜邏輯、依序處理</li>
<li><strong>適合</strong>: 通用計算、邏輯判斷</li>
</ul>
<h4 id="gpu流水線工廠"><a class="header" href="#gpu流水線工廠">GPU：流水線工廠</a></h4>
<ul>
<li><strong>核心數</strong>: 數千個簡單核心</li>
<li><strong>特點</strong>: 並行處理、同時運算</li>
<li><strong>適合</strong>: 大量重複計算</li>
</ul>
<h3 id="ai-訓練的本質矩陣運算"><a class="header" href="#ai-訓練的本質矩陣運算">AI 訓練的本質：矩陣運算</a></h3>
<pre><code class="language-python"># 神經網路 = 大量矩陣乘法
def neural_network_layer(input_data, weights, bias):
    output = np.dot(input_data, weights) + bias  # 核心運算
    return output

# 實際規模
input_data = (1024, 768)   # 批次資料
weights = (768, 2048)       # 權重矩陣
# 需要：1024 × 768 × 2048 = 16億次運算！
</code></pre>
<h3 id="性能對比"><a class="header" href="#性能對比">性能對比</a></h3>
<div class="table-wrapper"><table><thead><tr><th>運算類型</th><th>CPU (8核)</th><th>GPU (RTX 4090)</th><th>速度差異</th></tr></thead><tbody>
<tr><td>串行邏輯</td><td>⭐⭐⭐⭐⭐</td><td>⭐</td><td>CPU 勝</td></tr>
<tr><td>矩陣運算</td><td>⭐</td><td>⭐⭐⭐⭐⭐</td><td>GPU 快 100x</td></tr>
<tr><td>AI 訓練</td><td>50 小時</td><td>30 分鐘</td><td>GPU 快 100x</td></tr>
</tbody></table>
</div>
<h3 id="為什麼-gpu-快"><a class="header" href="#為什麼-gpu-快">為什麼 GPU 快？</a></h3>
<ol>
<li><strong>並行計算</strong>: 16,384 個 CUDA 核心 vs 8 個 CPU 核心</li>
<li><strong>記憶體頻寬</strong>: 1008 GB/s vs 90 GB/s</li>
<li><strong>專用硬體</strong>: Tensor Cores 專為 AI 設計</li>
</ol>
<h3 id="gpu-適合-ai-訓練的核心原因"><a class="header" href="#gpu-適合-ai-訓練的核心原因">GPU 適合 AI 訓練的核心原因</a></h3>
<ol>
<li><strong>大規模並行</strong> - 數千個核心同時工作</li>
<li><strong>矩陣運算優化</strong> - AI 的本質就是矩陣運算</li>
<li><strong>高記憶體頻寬</strong> - 快速移動大量資料</li>
<li><strong>專用硬體</strong> - Tensor Cores 專為 AI 設計</li>
<li><strong>能源效率</strong> - 同樣運算量，GPU 更省電</li>
</ol>
<p><strong>簡單比喻：</strong></p>
<ul>
<li><strong>CPU = 8個博士</strong>（很聰明，但人少）</li>
<li><strong>GPU = 10000個小學生</strong>（簡單，但人超多）</li>
<li><strong>AI訓練 = 大量簡單重複運算</strong>（適合10000個小學生一起做）</li>
</ul>
<p>這就是為什麼訓練 AI 一定要用 GPU 的原因！</p>
<hr />
<h2 id="實戰程式碼範例"><a class="header" href="#實戰程式碼範例">實戰程式碼範例</a></h2>
<h3 id="完整訓練流程colab-版"><a class="header" href="#完整訓練流程colab-版">完整訓練流程（Colab 版）</a></h3>
<pre><code class="language-python"># 1. 環境設置
!pip install transformers datasets accelerate peft bitsandbytes

# 2. 載入模型和配置 LoRA
from transformers import AutoModelForCausalLM, AutoTokenizer
from peft import LoraConfig, get_peft_model
import torch

# 選擇基礎模型
model_name = "microsoft/phi-2"
model = AutoModelForCausalLM.from_pretrained(
    model_name,
    torch_dtype=torch.float16,
    device_map="cuda"
)
tokenizer = AutoTokenizer.from_pretrained(model_name)

# 配置 LoRA
peft_config = LoraConfig(
    r=16,
    lora_alpha=32,
    target_modules=["Wqkv", "out_proj", "fc1", "fc2"],
    lora_dropout=0.1,
)

model = get_peft_model(model, peft_config)
print(f"可訓練參數: {model.num_parameters(only_trainable=True):,}")

# 3. 準備數據
from datasets import load_dataset

# 財報分析數據格式
def prepare_dataset(examples):
    inputs = [f"分析任務：{inst}\n財報內容：{inp}\n" 
              for inst, inp in zip(examples["instruction"], examples["input"])]
    model_inputs = tokenizer(inputs, max_length=2048, truncation=True)
    labels = tokenizer(examples["output"], max_length=2048, truncation=True)
    model_inputs["labels"] = labels["input_ids"]
    return model_inputs

dataset = load_dataset("your_dataset")
dataset = dataset.map(prepare_dataset, batched=True)

# 4. 訓練
from transformers import TrainingArguments, Trainer

training_args = TrainingArguments(
    output_dir="./results",
    num_train_epochs=3,
    per_device_train_batch_size=4,
    gradient_accumulation_steps=4,
    warmup_steps=100,
    logging_steps=10,
    save_strategy="epoch",
    fp16=True,
)

trainer = Trainer(
    model=model,
    args=training_args,
    train_dataset=dataset,
    tokenizer=tokenizer,
)

trainer.train()

# 5. 保存和測試
model.save_pretrained("./my-finance-lora")

# 測試
prompt = "請分析這家公司2023年第四季的獲利能力..."
inputs = tokenizer(prompt, return_tensors="pt").to("cuda")
outputs = model.generate(**inputs, max_length=500)
response = tokenizer.decode(outputs[0])
print(response)
</code></pre>
<h3 id="本地部署載入訓練好的模型"><a class="header" href="#本地部署載入訓練好的模型">本地部署（載入訓練好的模型）</a></h3>
<pre><code class="language-python">from transformers import AutoModelForCausalLM, AutoTokenizer
from peft import PeftModel

# 載入基礎模型
base_model = AutoModelForCausalLM.from_pretrained(
    "microsoft/phi-2",
    device_map="cpu",  # 本地 CPU 使用
    torch_dtype=torch.float32
)

# 載入 LoRA 權重
model = PeftModel.from_pretrained(
    base_model,
    "./my-finance-lora"
)

# 使用模型
def analyze_financial_report(report_text):
    prompt = f"分析以下財報：\n{report_text}\n分析結果："
    inputs = tokenizer(prompt, return_tensors="pt")
    outputs = model.generate(**inputs, max_length=500)
    return tokenizer.decode(outputs[0])
</code></pre>
<hr />
<h2 id="學習路線圖"><a class="header" href="#學習路線圖">學習路線圖</a></h2>
<h3 id="week-1-2-基礎學習"><a class="header" href="#week-1-2-基礎學習">Week 1-2: 基礎學習</a></h3>
<ul>
<li>了解 Transformer 架構</li>
<li>熟悉 Hugging Face 生態系統</li>
<li>在 Colab 跑通第一個模型</li>
</ul>
<h3 id="week-3-4-數據準備"><a class="header" href="#week-3-4-數據準備">Week 3-4: 數據準備</a></h3>
<ul>
<li>收集領域數據</li>
<li>學習數據清理和格式化</li>
<li>建立訓練數據集</li>
</ul>
<h3 id="week-5-6-模型訓練"><a class="header" href="#week-5-6-模型訓練">Week 5-6: 模型訓練</a></h3>
<ul>
<li>理解 LoRA 原理</li>
<li>調整超參數</li>
<li>訓練第一個客製化模型</li>
</ul>
<h3 id="week-7-8-優化部署"><a class="header" href="#week-7-8-優化部署">Week 7-8: 優化部署</a></h3>
<ul>
<li>模型量化和優化</li>
<li>部署到生產環境</li>
<li>性能測試和改進</li>
</ul>
<hr />
<h2 id="重要提醒"><a class="header" href="#重要提醒">重要提醒</a></h2>
<ol>
<li><strong>先從小模型開始</strong>：Phi-2、TinyLlama 適合初學者</li>
<li><strong>善用免費資源</strong>：Google Colab、Kaggle Notebooks</li>
<li><strong>LoRA 是關鍵</strong>：大幅降低訓練成本</li>
<li><strong>數據品質 &gt; 數量</strong>：高品質數據比大量數據重要</li>
<li><strong>迭代改進</strong>：先跑通流程，再逐步優化</li>
</ol>
<hr />
<h2 id="資源連結"><a class="header" href="#資源連結">資源連結</a></h2>
<h3 id="模型下載"><a class="header" href="#模型下載">模型下載</a></h3>
<ul>
<li><a href="https://huggingface.co/models">Hugging Face Models</a></li>
<li><a href="https://modelscope.cn/">ModelScope (中文模型)</a></li>
</ul>
<h3 id="數據集"><a class="header" href="#數據集">數據集</a></h3>
<ul>
<li><a href="https://huggingface.co/datasets">Hugging Face Datasets</a></li>
<li><a href="https://www.kaggle.com/datasets">Kaggle Datasets</a></li>
</ul>
<h3 id="學習資源"><a class="header" href="#學習資源">學習資源</a></h3>
<ul>
<li><a href="https://huggingface.co/course">Hugging Face Course</a></li>
<li><a href="https://www.fast.ai/">Fast.ai Course</a></li>
<li><a href="https://www.youtube.com/@AndrejKarpathy">Andrej Karpathy's Videos</a></li>
</ul>
<h3 id="社群"><a class="header" href="#社群">社群</a></h3>
<ul>
<li><a href="https://www.reddit.com/r/LocalLLaMA/">r/LocalLLaMA</a></li>
<li><a href="https://discuss.huggingface.co/">Hugging Face Forums</a></li>
</ul>
<hr />
<h2 id="總結"><a class="header" href="#總結">總結</a></h2>
<p>訓練 AI 模型不再是大公司的專利。透過：</p>
<ul>
<li>開源模型（Llama、Qwen、Phi）</li>
<li>LoRA 微調技術</li>
<li>免費 GPU 資源（Colab）</li>
<li>良好的數據策略</li>
</ul>
<p>任何人都可以訓練出專屬的 AI 模型。關鍵是<strong>從小開始、逐步成長、持續學習</strong>。</p>
<p>祝你的 AI 訓練之旅順利！🚀</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../ml/ml.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../ml/ai_ecosystem_guide.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../ml/ml.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../ml/ai_ecosystem_guide.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="../ace.js"></script>
        <script src="../mode-rust.js"></script>
        <script src="../editor.js"></script>
        <script src="../theme-dawn.js"></script>
        <script src="../theme-tomorrow_night.js"></script>

        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../mermaid.min.js"></script>
        <script src="../mermaid-init.js"></script>



    </div>
    </body>
</html>
